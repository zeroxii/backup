2012-08-27

public String procedure(String merchantId){
	String result 			= "";
	DBFactory db 			= null;
	Connection conn			= null;
	CallableStatement stmt	= null;
	String url ="jdbc:oracle:thin:@localhost:1521:orcl";
	String id = "scott";
	String pass = "tiger";
	try{		
		conn = DriverManager.getConnection(url, id, pass);

		stmt= conn.prepareCall("{call DP_CENTER_CHECK_V1(?,?,?)}");    
		stmt.setString(1, merchantId);
		stmt.setString(2, CommonUtil.getCurrentDate("yyyyMMdd"));
		stmt.registerOutParameter(3,java.sql.Types.VARCHAR);
		stmt.execute();
		result = CommonUtil.nToB(stmt.getString(2));	
	}catch(Exception e){
		Log.debug("log.day","Create Sequence Error ="+e.getMessage(),this);
	}finally{
		db.close(stmt);
		db.close(conn);
	}
	
	return result;
}



 프로시저 생성
 
 create or replace procedure test_proc( name in varchar2, age in number, job out varchar2 , sal out number) 
 is 

 begin
  if name = '황지훈' then
   job := '반장';
   sal := 5000;
   else
          job :='평민';
          sal := 2500;
          
   end if;
 end;
 /
 
NHPR_Admin
Login Page : /NHPR2201.do?sabun=151059254 /nhPR.Entry.LoginCheckAdmin
NHPR_Web
Login Page : /NHPR1101.do?sabun=151059254 /nhPR.ITLand.LoginCheckITLand
BOOK Login : /NHPR1102.do?sabun=151059254 /nhPR.ITBookMagazine.LoginCheckITMagazineBook
select * from t_member where it_land_manager is not null;-- 151059254
 
/NHPR3001.do?user_id=151059254
/NHPR3002.do?user_id=151059254
 rhksflwk	rhksfl@02	관리자
97102422	ckdtjr@02	이창석
98102547	dmfrn@02	서을구
04301728	qudtns@02	이병순


 if(<%=mobileCheck%> == 'true'){
		document.ItListForm.action = "NHPR3002.do";
	}	else{
		document.ItListForm.action = "NHPR3022.do";
	}
  
  java 선언 : 프로시저 사용하기 

 package day6_21;

import java.sql.CallableStatement;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Types;


public class UseCallableStatement {
 
 
 public UseCallableStatement()throws SQLException{
  try {
   //1.드라이버로딩
   Class.forName("oracle.jdbc.OracleDriver");
  } catch (ClassNotFoundException e) {
   e.printStackTrace();
  }
  String url ="jdbc:oracle:thin:@localhost:1521:orcl";
  String id = "scott";
  String pass = "tiger";
  
  Connection con = null;
  CallableStatement cstmt = null;
  
  try{
   //2.연결얻기
   con=DriverManager.getConnection(url, id, pass);
   
   //3.쿼리문생성객체얻기
   cstmt=con.prepareCall("{call test_proc( ? , ? , ? , ? ) }");
   //                                              ( name, age, job , sal )
   //바인드변수에 값넣기
   // in parameter 에 값넣기
   cstmt.setString(1,"조영일" ); //다른이름으로 변경
   cstmt.setInt(2, 30);
   //out parameter 에 외부변수 등록하기
   cstmt.registerOutParameter(3, Types.VARCHAR);
   cstmt.registerOutParameter(4, Types.NUMERIC);
   
   //4.쿼리수행후결과얻기
   boolean flag = cstmt.execute();
   //out parameter 에 저장된 프로시저의 수행결과 출력
   System.out.println(flag);
   System.out.println(cstmt.getString(3)+"/" +cstmt.getInt(4));
   
  }finally{
   //5.연결끊기
   if(cstmt != null){
    cstmt.close();
   }
   if(con != null){
    con.close();
   }
  }//finally
  
 }//UseCallableStatement

 public static void main(String[] args) {

  
  try {
   new UseCallableStatement();
  } catch (SQLException e) {
   e.printStackTrace();
  } // end catch
  
  
 }//main

}//class

<-- menu 등록시 -->
insert into t_menu(menu_id, parent_menu_id, menu_level, menu_name, menu_url, menu_code ) 
values (15, 1,2,'IP Excep Block','IPExcepBlock.action',68719476736);

insert into t_auth(user_id, menu_id, auth_type, menu_code, write_type ) 
values('admin',15,1,68719476736,1);
 8589934592
 4294967296

2012-08-28

32 =auth ; 536870911
	   536870911

select 
	idx
	trunk_name
	remote_sip_address
	remote_sip_port
	remote_domain
	local_sip_address
	sip_protocol
	call_transfer_type
	id
	passwd
	realm
	enable_trunk_register
	e164
	enable_trunk
	enable_register
	register_time
	expire_time
	active_time
	max_call
	process_idx
	description
from t_trunk
order by register_time desc
LIMIT #numPerPage# OFFSET #start#


insert into t_menu(menu_id, parent_menu_id, menu_level, menu_name, menu_url, menu_code ) 
values (15,1,2,'Holiday & Work Setting','IvrHWTime.action',17179869184);

insert into t_auth(user_id, menu_id, auth_type, menu_code, write_type ) 
values('admin',15,1,17179869184,1);

pjw 1111



2012-08-31

<%                         
int number=Integer.parseInt(String.valueOf(request.getAttribute("number")));
%>

database로부터 받은 number값받기
<s:property value="number">와같다 ㅋㅋㅋㅋㅋㅋ 

insert into t_auth values('admin','201','1',34359738368,'1');

<s:if test="%{enable_record==0}"> 
						Off
					</s:if>
					<s:else>
						On
					</s:else>



2012-09-05


\usr\local\nfs_mount_list\mount\record_mount\Server1\20120904\6498-250-360-20120904021219-20120904021227-0.spx
/usr/local/skycom/var/record/SpxFiles/Server1/20120904\6498-250-360-20120904021219-20120904021227-0.spx
6498-250-360-20120904021219-20120904021227-0.spx


function popupStreamminglistenRecord(obj){
	if(obj != "")
	{
		window.open('PlayRecord.action?filename='+obj,'fileplayPopup',
		'left=200,top=100,width=300, height=130, scrollbars=no'); 
	}
}

RecordAction.goConvert(filedirectory,filename,{
		callback:function(str) {
			parray = str.split(":");
			if(parray[0]=='success'){
				filename = parray[1];
				popupStreamminglistenRecord(filename);
			}
		}
	});

path.tomcat_log=/home/weblog/tomcat/,/home/weblog/tomcat2/
path.mq_log=/usr/local/emsmq/emsif/logs

학암포 신진도


mysql_driver=com.mysql.jdbc.Driver

username=root
password=skycom67960

emsplus_db=jdbc:mysql://127.0.0.1:3306/EMSPLUS?useUnicode=true
signal_db=jdbc:mysql://127.0.0.1:3306/SKYPBX?useUnicode=true
media1_db=jdbc:mysql://127.0.0.1:3306/SKYMEDIA?useUnicode=true
record_db=jdbc:mysql://127.0.0.1:3306/SKYRECORD?useUnicode=true
alarm_db=jdbc:mysql://127.0.0.1:3306/SKYIVR?useUnicode=true
crbt_db=jdbc:mysql://127.0.0.1:3306/SKYIVR?useUnicode=true
ivrext_db=jdbc:mysql://127.0.0.1:3306/SKYIVR?useUnicode=true
emsplus_db=jdbc:mysql://127.0.0.1:3306/EMSPLUS?useUnicode=true
signal_db=jdbc:mysql://127.0.0.1:3306/SKYPBX?useUnicode=true
media1_db=jdbc:mysql://127.0.0.1:3306/SKYMEDIA?useUnicode=true
record_db=jdbc:mysql://127.0.0.1:3306/SKYRECORD?useUnicode=true
alarm_db=jdbc:mysql://127.0.0.1:3306/SKYIVR?useUnicode=true
crbt_db=jdbc:mysql://127.0.0.1:3306/SKYIVR?useUnicode=true
ivrext_db=jdbc:mysql://127.0.0.1:3306/SKYIVR?useUnicode=true

ajax form

http://blog.naver.com/wlsry82?Redirect=Log&logNo=80166426476


벨리드쿼리
핑쿼리
http://blog.pages.kr/archive/200810?page=9

http://www.cubrid.com/zbxe/?document_srl=44432&category=151

http://blog.naver.com/wjdtjsdk3621?Redirect=Log&logNo=130074366866
dbcp validation query

http://linuxism.tistory.com/579
http://rocksea.tistory.com/71



mysql_driver=com.mysql.jdbc.Driver

username=root
password=skycom67960

-- 서버 헝가리 42번
emsplus_db=jdbc:mysql://127.0.0.1:3306/EMSPLUS?useUnicode=true
signal_db=jdbc:mysql://127.0.0.1:3306/SKYPBX?useUnicode=true
media1_db=jdbc:mysql://127.0.0.1:3306/SKYMEDIA?useUnicode=true
record_db=jdbc:mysql://127.0.0.1:3306/SKYRECORD?useUnicode=true
alarm_db=jdbc:mysql://127.0.0.1:3306/SKYIVR?useUnicode=true
crbt_db=jdbc:mysql://127.0.0.1:3306/SKYIVR?useUnicode=true
ivrext_db=jdbc:mysql://127.0.0.1:3306/SKYIVR?useUnicode=true

-- 내컴 
mysql_driver=com.mysql.jdbc.Driver
oracle_driver=oracle.jdbc.driver.OracleDriver

signal_db=jdbc:mysql://192.168.0.210:3306/SKYPBX?useUnicode=true
emsplus_db=jdbc:mysql://192.168.0.210:3306/EMSPLUS?useUnicode=true
if1_db=jdbc:mysql://192.168.0.210:3306/EMSPLUS?useUnicode=true
alarm_db=jdbc:mysql://192.168.0.210:3306/SKYCOMMON?useUnicode=true
ivrext_db=jdbc:mysql://192.168.0.210:3306/SKYIVR?useUnicode=true
media1_db=jdbc:mysql://192.168.0.210:3306/SKYMEDIA?useUnicode=true
media2_db=jdbc:mysql://192.168.0.210:3306/SKYMEDIA?useUnicode=true
orcl_db=jdbc:oracle:thin:@175.119.226.209:1521:orcl
record_db=jdbc:mysql://192.168.0.210:3306/SKYRECORD?useUnicode=true

username=root
password=skycom67960

ora_username=jsc
ora_password=jsc_p@ssw0rd



yyyy-MM-dd HH:mm:ss

찾아보기 영문
http://aroskr.tistory.com/2





jdbc:mysql://192.168.0.210:3306/SKYPBX?autoReconnect=true




 <applet code="SkycomPlayerApplet.class" archive="skycomPlayer.jar" codebase="./rec" width="1225px" height="111px" MAYSCRIPT>
	<param name="counselerName" value="<s roperty value="counselerName"/>"> 
	<param name="custTel" value="<s roperty value="custTel"/>"> 
	<param name="totalTime" value="<s roperty value="totalTime"/>"> 
	<param name="waveFilePath" value="<s roperty value="waveFilePath"/>"


<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" >
<tr>
     <td align="center">
		<applet NAME="skycomPlayer" code="skycomPlayer.SkycomPlayerApplet.class" archive="skycomPlayer.jar" codebase="./jsp/ivrment" width="100%" height="111px" MAYSCRIPT>
			<param name="counselerName" value="TEST1"> 
	<param name="custTel" value="TEST2"> 
	<param name="totalTime" value="00:05:00"> 
	<param name="waveFilePath" value="http://192.168.0.213:8000/SkyProxy/jsp/ivrment/audioFile.jsp?file_name=hu_ivr_intro"/>"
		</applet>
		</td>
	</tr>
</table>
String directory = getServletContext().getRealPath("upload")+File.separator+dmBean.getMerchantId();
public boolean saveFile(String directory,MultipartFile newFile,String newFileName){
		
		boolean isSave = false;
		
		File filePath = new File(directory);
		if (!filePath.exists()) { 
			filePath.mkdirs(); 
		}
		
		String fileName = directory + File.separator + newFileName;
		File createFile = new File(fileName);
		try{
			if (createFile.exists()) {
			    try {
			       isSave = createFile.createNewFile();
			    }catch (IOException ex){
			    }
			}
			newFile.transferTo(createFile); //move to createFile
			isSave = true;
		}catch(Exception e){
			Log.debug("log.day",CommonUtil.getExceptionMessage(e),this);
		}
		
		return isSave;
	
	}





<?xml version="1.0" encoding="UTF-8"?>
<Context path="/ivr" docBase="/usr/local/skycom/var/ivr/ment/common/" debug="0" reloadable="true" />

<?xml version="1.0" encoding="UTF-8"?>
<Context path="/ivr" docBase="/usr/local/skycom/var/ivr/" debug="0" reloadable="true" />


<?xml version="1.0" encoding="UTF-8"?>
<Context path="/ment" docBase="/usr/local/skycom/var/ivr/ment/common" debug="0" reloadable="true" />


<td align="center"><s:property value='func.timecheckUTC3(update_time)'/></td>

class

/usr/local/tomcat/webapps/SkyProxy/WEB-INF/classes/skycom/pbx

xml
/usr/local/tomcat/webapps/SkyProxy/WEB-INF/classes/

jsp

/usr/local/tomcat/webapps/SkyProxy/jsp


118.219.54.197

root/sprtjtmepah!@#$
넥서스데모!@#$

mysql  root/skycom67960

function down2(url, name){
  		var fileName = url.substring(7);
  		//alert(fileName);
  		document.downForm.filename.value= fileName;
  		document.downForm.names.value= name;
  		document.downForm.target = "downframe";
  		document.downForm.submit();
  	}	
 <form action="/merchant/fileDown.jsp" name="downForm" method="post">
	      	<input type="hidden" name="filename">
	      	<input type="hidden" name="names">
	 </form>
     <iframe name="downframe" style="display:none"></iframe>

2012-09-12

<s:textfield value = "%{session.userId}"/>



onclick="timeUpdate('outTime${status.count}','${list.idx }',${list.xmlIdx });set_submenu('checkTime');"
function openPopup(name, left, top)
	{
		var lay = obj(name);		
		lay.style.left = left;
		lay.style.top = top;
		lay.style.display = "inline";
	}
	function closePopup(name)
	{
		var lay = obj(name);
		lay.style.display = "none";
	}
	function obj(id) 
	{
	    if (navigator.appName.indexOf("Microsoft") != -1) return window[id];
	    else return document.getElementById(id);
	}
	function timeUpdate(id,centerIdx,xmlIdx) {

		var frm = document.checkTimeForm;
		openPopup("checkTime", 0,0);
		frm.divCenterIdx.value=centerIdx;
		frm.divXmlIdx.value=xmlIdx;
		frm.divInUpFlag.value=id;
		
	    
	}




public String goDown() {
		
		try {
			
			Func func = new Func();
			String basePath = getText("path.upload_file")+getText("path.play_file");
			
			String path = basePath+filename;
			System.out.println("path:"+path);
			
	        File file = new File(path);

	        if (file.exists()){
	            byte readByte[] = new byte[4096];
	            HttpServletResponse response = ServletActionContext.getResponse();
	            response.setContentType("application/octet-stream");
				response.setHeader(
						"Content-disposition",
						"attachment;filename=" + filename);
			    System.out.println("fileName:"+filename);
	            BufferedInputStream  fin  = new BufferedInputStream(new FileInputStream(file));
	            //javax.servlet.ServletOutputStream outs =	response.getOutputStream();
	            OutputStream outs = response.getOutputStream();
	            
	   			int read;
	    	while ((read = fin.read(readByte, 0, 4096)) != -1)
	    				outs.write(readByte, 0, read);
	    		outs.flush();
	    		outs.close();
	            fin.close();
	            returnMessage = "success";
	        }else{
	        	returnMessage = "error";
	        	System.out.println("file is not exist: "+filename);
	        }
	    } catch(Exception e) {
	    	returnMessage = "error";
	    }
		
		return SUCCESS;
	}




map1.java
105 line



   SELECT m.menu_id AS menuid, m.menu_name AS menuname,
         a.auth_type AS menuauth, m.menu_url AS menuurl
         ,a.menu_code
    FROM t_menu m, t_auth a
   WHERE m.menu_id = a.menu_id
     AND a.user_id = 'admin'
     AND m.menu_level = '1'
     AND a.auth_type > '0'
   ORDER BY m.menu_id;
       
       SELECT m.menu_id AS menuid, m.menu_name AS menuname,
         a.auth_type AS menuauth, CONCAT(m.menu_url,'?menuId=',m.menu_id) AS menuurl
         , m.menu_level
    FROM t_menu m, t_auth a
   WHERE m.menu_id = a.menu_id
     AND a.user_id = 'admin'
     AND m.menu_level = '2'
     AND m.parent_menu_id = '2'
     AND a.auth_type > '0'
   ORDER BY m.menu_id

   t_menu statu = N
   t_auth auth_type = 0,write_type =0 
   and m.status = 'Y'

   朴正祐






2012-09-14

struts2 환경 셋팅

struts down : http://struts.apache.org/download.cgi#struts216
필요 lib : 

antlr-2.7.2.jar
commons-beanutils-1.7.0.jar
commons-chain-1.2.jar
commons-logging-1.0.4.jar
commons-logging-api-1.1.jar
commons-validator-1.3.1.jar
freemarker-2.3.13.jar
ognl-2.6.11.jar
oro-2.0.8.jar
struts2-core-2.1.6.jar
struts-core-1.3.10.jar
xwork-2.1.2.jar

web.xml struts2 내용 추가

<filter>
	<filter-name>struts2</filter-name>
	<filter-class>org.apache.struts2.dispatcher.FilterDispatcher</filter-class>		
</filter>
<filter-mapping>
	<filter-name>struts2</filter-name>
	<url-pattern>/*</url-pattern>
</filter-mapping>
<error-page>
	<error-code>404</error-code>
	<location>/jsp/error/pagenotfound.jsp</location>
</error-page>
<error-page>
	<error-code>500</error-code>
	<location>/jsp/error/pagenotfound.jsp</location>
</error-page>
<error-page>
	<exception-type>java.lang.Exception</exception-type>
	<location>/jsp/error/errorpage.jsp</location>
</error-page>
<!-- Port 
<context-param>
	<param-name>port</param-name>
	<param-value>8080</param-value>
</context-param>
-->
<session-config>
	<session-timeout>30</session-timeout>
</session-config>

src/struts.xml 생성

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
    "http://struts.apache.org/dtds/struts-2.0.dtd">
    
<struts>

<!-- <include file="trunkStatus.xml" /> -->

<package name="default" extends="struts-default">
   	<action name="SipLogMsg" class="skycom.pbx.logmsg.SipLogMsgAction">
		<result name="success">/jws/sip_trace_jnlp.jsp</result>
	</action>
</package>



</struts>  

dwr 설정 추가


WEB-INF/dwr.xml 추가


dwr 설정시 web.xml 설정부분
<listener>
		<listener-class>org.directwebremoting.servlet.DwrListener</listener-class>
	</listener>
	<servlet>
		<servlet-name>dwr-invoker</servlet-name>
		<display-name>DWR Servlet</display-name>
		<description>Direct Web Remoter Servlet</description>
		<servlet-class>org.directwebremoting.servlet.DwrServlet</servlet-class>

		<!-- This should NEVER be present in live -->
		<init-param>
			<param-name>debug</param-name>
			<param-value>false</param-value>
		</init-param>

		<!-- Remove this unless you want to use active reverse ajax -->
		<init-param>
			<param-name>activeReverseAjaxEnabled</param-name>
			<param-value>true</param-value>
		</init-param>

		<!-- By default DWR creates application scope objects when they are first 
			used. This creates them when the app-server is started -->
		<init-param>
			<param-name>initApplicationScopeCreatorsAtStartup</param-name>
			<param-value>true</param-value>
		</init-param>

		<!-- WARNING: allowing JSON-RPC connections bypasses much of the security 
			protection that DWR gives you. Take this out if security is important -->
		<init-param>
			<param-name>jsonRpcEnabled</param-name>
			<param-value>false</param-value>
		</init-param>

		<!-- WARNING: allowing JSONP connections bypasses much of the security 
			protection that DWR gives you. Take this out if security is important -->
		<init-param>
			<param-name>jsonpEnabled</param-name>
			<param-value>false</param-value>
		</init-param>

		<!-- data: URLs are good for small images, but are slower, and could OOM 
			for larger images. Leave this out (or keep 'false') for anything but small 
			images -->
		<init-param>
			<param-name>preferDataUrlSchema</param-name>
			<param-value>false</param-value>
		</init-param>

		<!-- For more information on these parameters, see: - http://getahead.org/dwr/server/servlet 
			- http://getahead.org/dwr/reverse-ajax/configuration -->
		<load-on-startup>1</load-on-startup>
	</servlet>

	<servlet-mapping>
		<servlet-name>dwr-invoker</servlet-name>
		<url-pattern>/dwr/*</url-pattern>
	</servlet-mapping>

dwr 사용할 페이지에 추가
<script type='text/javascript' src='./dwr/interface/EchoAction.js'> </script>
<script type='text/javascript' src='./dwr/engine.js'> </script>
<script type='text/javascript' src='./dwr/util.js'> </script>















$(document).ready(function() {
	subpageIvr(1);
});

function subpageIvr(pageNo) {	
	var url = "IVRConfigListAjax.action";
    $.post(url,{pageNo:pageNo},function(data){
        $('#ivr_list').html(data);
        $('#totalcnt').html("Total : "+jQuery('#total_dataCount').val());
		    if(jQuery('#errorMsg').val()!=""){
				   alert(jQuery('#errorMsg').val());
			}
    });
	$("#ivr_list").show();
}

if(confirm("<s:text name='message.doChk'/>")){			
			IvrHWTimeAction.goHtimeDelete(param,{
				callback:function(str){					
					alert(str);					
					if('<s:text name = "message.delete"/>'==str){
						rightpageload(1,country_code.value,holiday_year.value);
						goNew();
					}
				}
			});
		}






2012-09-17

Map map = tcpMgr.tcpExeConfigPing(dto);



if(map.get("RESULT")!=null&&map.get("RESULT").toString().equals("OK")){
	
	통신이상이없으면
		
}
if (mgr.update(dto)) {
	    			DuplexFunc dupx = new DuplexFunc();
	    			Map returnMap = dupx.duplexService();//<--이중화관련
	    			tcpMgr.tcpExeControl(mgr);




emergency_queue_e164
<input type="checkbox" id = "enable_virtual_queue" name = "apply_user_login">Enable Virtual Queue

<div style="display: ">
						<table cellpadding="0" cellspacing="0" class="">
							  <tr>
						         <td class="w4tb_T">Owner</td>
						         <td class="table_g">
						        	 <s:select
								        label="label.time_zone_hour2"
								        list="time_zone_hourList"
								        name="dto.owner"
								        listKey="key"
								        listValue="value"
								        id ="owner"
								        headerValue=""
								        cssClass="tb_input"
							         />	
								 </td>
					             <td class="w4tb_T">emergency queue</td>
						         <td class="table_g" >
					         		 <s:select
								        label="label.time_zone_minutes2"
								        list="time_zone_minutesList"
								        name="dto.emergency_queue_e164"
								        listKey="key"
								        listValue="value"
								        id ="emergency_queue_e164"
								        headerValue=""
								        cssClass="tb_input"
							         />	
							     </td >
					       </tr>
						</table>
					</div>




#table_group {
	float: left;
	width: 98%;
	margin: 0 0 0 8px;
}


function enable(){
		if(enable_check.){
			enable_virtual_queue
		}
		
	}


2012-09-18

xmlBf.append("<cell></cell>");
		        	xmlBf.append("<cell><![CDATA["+dto.getIdx_property()+"]]></cell>");
		        	xmlBf.append("<cell><![CDATA["+func.transXml(func.f_NullCheck(dto.getE164_property()))+"]]></cell>");
		        	xmlBf.append("<cell><![CDATA["+call_method_value+"]]></cell>");
		        	xmlBf.append("<cell><![CDATA["+dto.getCall_method()+"]]></cell>");
		        	xmlBf.append("<cell><![CDATA["+dto.getPolicy_property()+"]]></cell>");
		        	xmlBf.append("<cell><![CDATA["+dto.getApply_last_time()+"]]></cell>");
		        	xmlBf.append("<cell><![CDATA["+dto.getEnable_rbt()+"]]></cell>");
		        	xmlBf.append("<cell><![CDATA["+func.transXml(func.f_NullCheck(dto.getPolicy_propertyValue()))+"]]></cell>");
		        	xmlBf.append("<cell><![CDATA["+dto.getRealm_property()+"]]></cell>");
		        	xmlBf.append("<cell><![CDATA["+func.transXml(func.f_NullCheck(dto.getRealm_propertyValue()))+"]]></cell>");
		        	xmlBf.append("<cell><![CDATA["+dto.getEnable_wait()+"]]></cell>");
		        	xmlBf.append("<cell><![CDATA["+dto.getApply_user_login()+"]]></cell>");
		        	xmlBf.append("<cell><![CDATA["+dto.getTime_zone_hour1()+"]]></cell>");
		        	xmlBf.append("<cell><![CDATA["+dto.getTime_zone_minutes1()+"]]></cell>");
		        	xmlBf.append("<cell><![CDATA["+dto.getTime_zone_hour2()+"]]></cell>");
		        	xmlBf.append("<cell><![CDATA["+dto.getTime_zone_minutes2()+"]]></cell>");
		        	xmlBf.append("<cell><![CDATA["+dto.getDay_mon()+"]]></cell>");
		        	xmlBf.append("<cell><![CDATA["+dto.getDay_tue()+"]]></cell>");
		        	xmlBf.append("<cell><![CDATA["+dto.getDay_wed()+"]]></cell>");
		        	xmlBf.append("<cell><![CDATA["+dto.getDay_thu()+"]]></cell>");
		        	xmlBf.append("<cell><![CDATA["+dto.getDay_fri()+"]]></cell>");
		        	xmlBf.append("<cell><![CDATA["+dto.getDay_sat()+"]]></cell>");
		        	xmlBf.append("<cell><![CDATA["+dto.getDay_sun()+"]]></cell>");
		        	xmlBf.append("<cell><![CDATA["+dto.getEnable_virtual_queue()+"]]></cell>");
		        	xmlBf.append("<cell><![CDATA["+dto.getEmergency_queue_e164()+"]]></cell>");25
		        	xmlBf.append("<cell><![CDATA["+dto.getOwner()+"]]></cell>");26
		        	xmlBf.append("</row>");




function chkInputSel() {
		var arg = document.getElementById("searchColumn");
		var bt_save3 = new String();
		if (arg.value == "Remote_Address" || arg.value == "Port"
				|| arg.value == "Realm") {
			bt_save3 += " <input type = 'text'";
			bt_save3 += " id='searchValue' ";
			bt_save3 += " name='searchValue' ";
			bt_save3 += " class='w8tb_input2'";
			bt_save3 += " onkeypress='goSearchEnter(event);'/>";
			document.getElementById("bt_save3").innerHTML = bt_save3;
		} else if (arg.value == "Protocol") {
			bt_save3 = "";
			TrunkListAction
					.protocolListMake({
						callback : function(str) {
							document.getElementById("bt_save3").innerHTML = "<select name='searchValue' id = 'searchValue' class='w8tb_input2'>"
									+ str + "</select>";
						}
					});
		}
	}

public String makeGroup(List<OptionList> list){
		StringBuffer sb = new StringBuffer();
		for(int i=0; i<list.size(); i ++){
			sb.append("<option value = '");
			sb.append(list.get(i).getKey());
			sb.append("'>");
			sb.append(list.get(i).getValue());
			sb.append("</option>");
		}
		return sb.toString();
	}




http://211.38.95.168/

skycom
스카이컴3399


D:\usr\local\GDN_List.xls



먼저 파일의 내용을 한줄씩 읽어와 split()함수를 통해 배열로 만든 후 ArrayList에 저장합니다.

(ArrayList 를 쓴 이유는 ArrayList 에서 배열 로 바로 추출할수 있기 때문입니다.)

그렇게 다 저장한 후

2차원 배열을 생성하여 ArrayList 클래스의 toArray(T[] t) 메소드를 이용하여 2차워 배열에 저장합니다.

그러면 원하시전 2차원 배열 을 가질수 있게 됩니다.

 

소스는 다음과 같이 하시면 됩니다.

 public void fileToArray() {
  FileReader fr = null;
     BufferedReader br = null;
     ArrayList<String[]> arrList = new ArrayList<String[]>();
     String twoDimensionsArr[][] ;
  try {
   
   //파일로드 부분으로 "파일명" 부분을 해당 파일명으로 변경
   //해야 하며 파일은 현재의 JAVA 소스와 같은 경로에 위치해야 함.
   File inFile = new File(this.getClass().getResource("파일명").getFile());
   fr = new FileReader(inFile);
   br = new BufferedReader(fr);
   
   //한줄씩 읽어서 split 메소드를 통해 배열로 변환후 ArrayList 에 add
   //하는 부분이며 파일의 한줄에 대한 각 항목의 구분은 @ 로 하였으며 다른 문자일경우 변경 필요.
   while(br.ready()) {
    arrList.add(br.readLine().split("@",4));
   }
   
   //2차원 배열을 선언하는 부분이며 길이를 ArrayList 의 크기를 사용
   twoDimensionsArr = new String[arrList.size()][];
   
   //ArrayList를 2차원 배열에 할당 하는 부분
   arrList.toArray(twoDimensionsArr);
   
   
  } catch(Exception e) {
   e.printStackTrace();
   
  } finally {
   try{
    if(br != null) {
     br.close();
    }
    if(fr != null) {
     fr.close();
    }
   } catch(Exception e) {
     System.out.println(e);
   } finally {
   }
   
  }
 }

 

해당 함수를 가져다 테스트를 해보심 될듯합니다

도움이 되셨길 바래요~


http://kin.naver.com/qna/detail.nhn?d1id=1&dirId=1040201&docId=68300111&qb=amF2YSB0eHTtjIzsnbwg66as7Iqk7Yq466Gc&enc=utf8&section=kin&rank=1&search_sort=0&spq=0&pid=RaDTGF5Y7vCsscPhdgKssc--146350&sid=UFlWYS83WVAAAAsTGDI



grid2번 save 누를시 insert 쿼리

 INSERT     INTO t_group_member (            idx      ,t_group_property_idx      ,e164      ,priority      ,policy      ,realm       )    
 VALUES ( ?      ,?      ,?      ,?      ,?      ,?      )   


  DELETE FROM t_group_member   
  WHERE e164 IN (    
	SELECT c.e164 
		FROM (      
			SELECT e164             
				FROM t_group_member a           
				WHERE t_group_property_idx = ?              
				AND NOT EXISTS(             
					SELECT '*'               
						FROM t_group_member b             
						WHERE t_group_property_idx = ?              
						AND a.e164 = b.e164               
						AND b.e164 IN              (        ?        )       
						)      
			)c   
		)   




 DELETE FROM t_group_member   WHERE e164 IN (    SELECT c.e164 FROM (           SELECT e164             FROM t_group_member a            WHERE t_group_property_idx = ?              AND NOT EXISTS(             SELECT '*'               FROM t_group_member b              WHERE t_group_property_idx = ?                AND a.e164 = b.e164                 AND b.e164 IN              (        ?        )       )      )c     )   
[15:59:12] DEBUG [http-8080-1] -{pstm-100470} Executing Statement:   DELETE FROM t_group_member   WHERE e164 IN (    SELECT c.e164 FROM (           SELECT e164             FROM t_group_member a            WHERE t_group_property_idx = ?              AND NOT EXISTS(             SELECT '*'               FROM t_group_member b              WHERE t_group_property_idx = ?                AND a.e164 = b.e164                 AND b.e164 IN              (        ?        )       )      )c     )   
[15:59:12] DEBUG [http-8080-1] -{pstm-100470} Parameters: [0, 0, ]
[15:59:12] DEBUG [http-8080-1] -{pstm-100470} Types: [java.lang.Integer, java.lang.Integer, java.lang.String]





 root@222.231.59.95
 의정부!@#$


 D:\Dev\workspace\Proxy_hungary\WebContent\usr\local\nfs_mount_list\mount\record_mount\Server1\20120920

 2012-09-24

 T_EXCEP_BLOCK_LIST --> T_EXCEPT_BLOCK_LIST로 변경해주세요.. 테이블명이 틀려서 나중에 모를수도 있으니까요





						      [1666093, 07074177409, 0317112154, 20120925092158, 20120925092258, 38028198-07074177409-0317112154-20120925092158.spx, Server1/20120925/38028198-07074177409-0317112154-20120925092158.spx, 00:01:00, 1, null]
[14:36:14] DEBUG [http-8080-2] -{rset-100379} Result: [1666106, 07074177296, 01055581172, 20120925092657, 20120925092741, 38028852-07074177296-01055581172-20120925092657.spx, Server1/20120925/38028852-07074177296-01055581172-20120925092657.spx, 00:00:44, 0, null]
[14:36:14] DEBUG [http-8080-2] -{rset-100379} Result: [1666109, 07074177470, 0319870126, 20120925092433, 20120925092854, 38028553-07074177470-0319870126-20120925092433.spx, Server1/20120925/38028553-07074177470-0319870126-20120925092433.spx, 00:04:21, 4, null]
[14:36:14] DEBUG [http-8080-2] -{rset-100379} Result: [1666118, 07074177264, 024715996, 20120925092920, 20120925093142, 38029161-07074177264-024715996-20120925092920.spx, Server1/20120925/38029161-07074177264-024715996-20120925092920.spx, 00:02:22, 2, null]
[14:36:14] DEBUG [http-8080-2] -{rset-100379} Result: [1666158, 07074177264, 0234267543, 20120925093211, 20120925093437, 38029558-07074177264-0234267543-20120925093211.spx, Server1/20120925/38029558-07074177264-0234267543-20120925093211.spx, 00:02:26, 2, null]
[14:36:14] DEBUG [http-8080-2] -{rset-100379} Result: [1666190, 07074177295, 0325831221, 20120925093517, 20120925093605, 38030168-07074177295-0325831221-20120925093517.spx, Server1/20120925/38030168-07074177295-0325831221-20120925093517.spx, 00:00:48, 0, null]
[14:36:14] DEBUG [http-8080-2] -{rset-100379} Result: [1666192, 07074177609, 07040154247, 20120925093154, 20120925093538, 38029522-07074177609-07040154247-20120925093154.spx, Server1/20120925/38029522-07074177609-07040154247-20120925093154.spx, 00:03:44, 3, null]
[14:36:14] DEBUG [http-8080-2] -{rset-100379} Result: [1666211, 07074177264, 024718842, 20120925093512, 20120925093709, 38030145-07074177264-024718842-20120925093512.spx, Server1/20120925/38030145-07074177264-024718842-20120925093512.spx, 00:01:57, 1, null]
[14:36:14] DEBUG [http-8080-2] -{rset-100379} Result: [1666216, 07074177266, 029561004, 20120925093710, 20120925093732, 38030585-07074177266-029561004-20120925093710.spx, Server1/20120925/38030585-07074177266-029561004-20120925093710.spx, 00:00:22, 0, null]
[14:36:14] DEBUG [http-8080-2] -{rset-100379} Result: [1666231, 07074177609, 028432964, 20120925093715, 20120925093805, 38030587-07074177609-028432964-20120925093715.spx, Server1/20120925/38030587-07074177609-028432964-20120925093715.spx, 00:00:50, 0, null]
[14:36:14] DEBUG [http-8080-2] -{rset-100379} Result: [1666239, 07074177408, 0325631963, 20120925093655, 20120925093819, 38030513-07074177408-0325631963-20120925093655.spx, Server1/20120925/38030513-07074177408-0325631963-20120925093655.spx, 00:01:24, 1, null]
[14:36:14] DEBUG [http-8080-2] -{rset-100379} Result: [1666265, 07074177295, 0325631965, 20120925093839, 20120925093934, 38030887-07074177295-0325631965-20120925093839.spx, Server1/20120925/38030887-07074177295-0325631965-20120925093839.spx, 00:00:55, 0, null]
[14:36:14] DEBUG [http-8080-2] -{rset-100379} Result: [1666266, 07074177408, 0325739047, 20120925093942, 20120925093956, 38031103-07074177408-0325739047-20120925093942.spx, Server1/20120925/38031103-07074177408-0325739047-20120925093942.spx, 00:00:14, 0, null]
[14:36:14] DEBUG [http-8080-2] -{rset-100379} Result: [1666271, 07074177266, 029964980, 20120925093934, 20120925093947, 38031071-07074177266-029964980-20120925093934.spx, Server1/20120925/38031071-07074177266-029964980-20120925093934.spx, 00:00:13, 0, null]
[14:36:14] DEBUG [http-8080-2] -{rset-100379} Result: [1666274, 07074177264, 0234267543, 20120925093949, 20120925094004, 38031116-07074177264-0234267543-20120925093949.spx, Server1/20120925/38031116-07074177264-0234267543-20120925093949.spx, 00:00:15, 0, null]
[14:36:14] DEBUG [http-8080-2] -{rset-100379} Result: [1666283, 07074177266, 029965232, 20120925094006, 20120925094024, 38031192-07074177266-029965232-20120925094006.spx, Server1/20120925/38031192-07074177266-029965232-20120925094006.spx, 00:00:18, 0, null]
[14:36:14] DEBUG [http-8080-2] -{rset-100379} Result: [1666286, 07074177408, 0325791418, 20120925094013, 20120925094034, 38031218-07074177408-0325791418-20120925094013.spx, Server1/20120925/38031218-07074177408-0325791418-20120925094013.spx, 00:00:21, 0, null]
[14:36:14] DEBUG [http-8080-2] -{rset-100379} Result: [1666319, 07074177609, 0319642002, 20120925094034, 20120925094125, 38031225-07074177609-0319642002-20120925094034.spx, Server1/20120925/38031225-07074177609-0319642002-20120925094034.spx, 00:00:51, 0, null]


<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans" xmlns:aop="http://www.springframework.org/schema/aop" xmlns:tx="http://www.springframework.org/schema/tx" xmlns:p="http://www.springframework.org/schema/p" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation=" http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd">
<!-- Local Apache Commons DBCP DataSource -->
<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
    <property name="driverClassName" value="oracle.jdbc.driver.OracleDriver"/>
    <!--?댄뵆<property name="url" value="jdbc:oracle:thin:@211.237.76.82:1521:ora10g"/> -->
    <!--?쏆툩<property name="url" value="jdbc:oracle:thin:@211.38.95.169:11004:ora10g"/>  -->
<!--    ?뚯궗?뚯뒪??-->
    <property name="url" value="jdbc:oracle:thin:@192.168.0.3:1521:orcl"/>
<!--    ?뚯궗?뚯뒪??-->
     <property name="username" value="skycom"/>
    <!--<property name="username" value="lets"/>-->
    <property name="password" value="system"/>

    <property name="initialSize" value="5"/>
    <property name="maxActive" value="20"/>
    <property name="maxIdle" value="5"/>
    <property name="minIdle" value="5"/>
    <property name="maxWait" value="30000"/>
    <property name="poolPreparedStatements" value="true"/>
    <property name="logAbandoned" value="true"/>
    <property name="removeAbandoned" value="true"/>
    <property name="removeAbandonedTimeout" value="60"/>
    <property name="validationQuery" value="select 0 from dual" />
    <property name="testOnBorrow" value="true" />
    <property name="testOnReturn" value="true" />
    <!-- <property name="loginTimeout" value="30"/> -->
  </bean>

<!-- Transaction Manager for a single JDBC DataSource -->
  <bean id="transactionManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
    <property name="dataSource" ref="dataSource"/>
  </bean>

  <!--
  <tx:annotation-driven transaction-manager="transactionManager"/>
   -->
  <!-- the transactional advice (i.e. what 'happens'; see the <aop:advisor/> bean below) -->
  <tx:advice id="txAdvice" transaction-manager="transactionManager">
      <!-- the transactional semantics... -->
    <tx:attributes>
        <!-- all methods starting with 'get' are read-only -->
        <tx:method name="add*" propagation="REQUIRED" rollback-for="SQLException,IOException,HttpException,Exception"/>
        <tx:method name="update*" propagation="REQUIRED" rollback-for="SQLException,IOException,HttpException,Exception"/>
        <tx:method name="delete*" propagation="REQUIRED" rollback-for="SQLException,IOException,HttpException,Exception"/>
      <!-- other methods use the default transaction settings (see below) -->
        <tx:method name="*" read-only="true"/>
      </tx:attributes>
  </tx:advice>

  <!-- ensure that the above transactional advice runs for any execution
  of an operation defined by the FooService interface -->
  <aop:config>
    <aop:pointcut id="transctionOperation" expression="execution(* skycom.common.dao.*.*(..))"/>
    <aop:advisor advice-ref="txAdvice" pointcut-ref="transctionOperation"/>
  </aop:config>


  <bean id="sqlMapClient"
           class="org.springframework.orm.ibatis.SqlMapClientFactoryBean"
           p:dataSource-ref="dataSource"
           p:configLocation="/WEB-INF/classes/skycom/common/dbcp/sqlMapConfig.xml"/>

  <bean id="sqlMapClientTemplate"
           class="org.springframework.orm.ibatis.SqlMapClientTemplate"
           p:sqlMapClient-ref="sqlMapClient" />

  <bean id="dao" class="skycom.common.dao.CommonDAOImpl"
             p:sqlMapClientTemplate-ref="sqlMapClientTemplate"/>

  <!-- Local Mysql DBCP DataSource -->
    <bean id="RecDataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
        <property name="driverClassName" value="com.mysql.jdbc.Driver"/>
        <!-- 192.168.0.79 -->
      <!--   <property name="url" value="jdbc:mysql://192.168.0.217:3306/SKYRECORD?useUnicode=true"/>   -->
      <!-- ?댄뵆  <property name="url" value="jdbc:mysql://192.168.0.79:3306/SKYRECORD?useUnicode=true"/>-->
      <!-- ?쏆툩<property name="url" value="jdbc:mysql://192.168.0.215:3306/SKYRECORD?useUnicode=true"/>  -->
      <!-- ?쏆툩<property name="url" value="jdbc:mysql://211.38.95.173:3306/SKYRECORD?useUnicode=true"/> -->
      <!--  <property name="url" value="jdbc:mysql://210.121.190.163:3306/SKYRECORD?useUnicode=true"/> -->
<!--       ?뚯궗?뚯뒪??-->
        <property name="url" value="jdbc:mysql://192.168.0.210:3306/SKYRECORD?useUnicode=true"/>
<!--       ?뚯궗?뚯뒪??-->
        <property name="username" value="root"/>
        <property name="password" value="skycom67960"/>

        <property name="initialSize" value="5"/>
        <property name="maxActive" value="10"/>
        <property name="maxIdle" value="5"/>
        <property name="minIdle" value="5"/>
        <property name="maxWait" value="30000"/>
        <property name="poolPreparedStatements" value="true"/>
        <property name="logAbandoned" value="true"/>
        <property name="removeAbandoned" value="true"/>
        <property name="removeAbandonedTimeout" value="60"/>
        <property name="validationQuery" value="select 0  " />
        <property name="testOnBorrow" value="true" />
        <property name="testOnReturn" value="true" />

        <!-- <property name="loginTimeout" value="30"/> -->
    </bean>


    <bean id="RecDataSourceSqlMapClient"
           class="org.springframework.orm.ibatis.SqlMapClientFactoryBean"
           p:dataSource-ref="RecDataSource"
           p:configLocation="/WEB-INF/classes/skycom/common/dbcp/sqlMapConfig.xml"/>

    <bean id="RecDataSourceSqlMapClientTemplate"
           class="org.springframework.orm.ibatis.SqlMapClientTemplate"
           p:sqlMapClient-ref="RecDataSourceSqlMapClient" />

    <bean id="Recdao" class="skycom.common.dao.RecDAOImpl"
           p:sqlMapClientTemplate-ref="RecDataSourceSqlMapClientTemplate"/>





</beans>
          



 select         
	nvl(agent_code,'')as agent_code,             
		nvl(cust_no,'')as cust_no,            
		nvl(cust_name,'')as cust_name,          
		nvl(rec_loginid,'')as cust_id,          
		'1' as cust_level,            
		'' as upper_cust      
		from t_custom      
		where rec_loginid = ?        
		and rec_loginpwd = ?  
		union all     
	select         
		nvl(agent_code,'')as agent_code,          
		nvl(cust_no,'')as cust_no,            
		nvl(cust_name,'')as cust_name,          
		nvl(cust_id,'')as cust_id,          
		nvl(cust_level,'')as cust_level,      
		nvl(upper_cust,'')as upper_cust      
		from t_rec_user     
		where cust_id = ?     
		and cust_pwd = ?    
		union all  
	select 
		b.agent_code,           
		a.cust_no,          
		counselor_name,             
		counselor_id,          
		'3',          
		a.cust_no     
		from t_rec_user_e164 a, t_custom b     
		where a.cust_no = b.cust_no       
		and a.counselor_id = ?      
		and a.counselor_pwd = ?     


 1	7598473603603113110000000000192.168.255.11220120925204323.mp3	-1


 [(/usr/local/nfs_mount_list/mount/record_mount/Server1/20120925/7598473603603113110000000000192.168.255.11220120925204323.mp3, 
 /usr/local/nfs_mount_list/mount/record_mount/Server1/20120925/7598483603603113110000000000192.168.255.11220120925204440.mp3, 
 /usr/local/nfs_mount_list/mount/record_mount/Server1/20120925/759849-360-360-311-311-00000-00000-192.168.255.112-20120925205211.mp3)] 

 [(/rec/Server1/20120925/7598473603603113110000000000192.168.255.11220120925204323.mp3, /rec/Server1/20120925/7598483603603113110000000000192.168.255.11220120925204440.mp3, /rec/Server1/20120925/759849-360-360-311-311-00000-00000-192.168.255.112-20120925205211.mp3)] 
http://192.168.0.210:8000/rec/Server1/20120925/7598473603603113110000000000192.168.255.11220120925204323.mp3

http://192.168.0.210:8000/rec/Server1/20120925/7598483603603113110000000000192.168.255.11220120925204440.mp3


 2		0

 1.234.12.44/45
 root/skycom^& 
 패스워드는 skycom67960 <--- 숫자는 쉬프트 누르고
 똑 같이 올리고 톰켓 재시작하신후에 알려주세요
박정우님의 말:
 넵


 [(http://192.168.0.210:8000/rec/Server1/20120925/7598473603603113110000000000192.168.255.11220120925204323.mp3,/rec/Server1/20120925/7598483603603113110000000000192.168.255.11220120925204440.mp3,/rec/Server1/20120925/759849-360-360-311-311-00000-00000-192.168.255.112-20120925205211.mp3)] 



 public String mutiFileDown() throws MyException {

		try {
			//message = "false";
			message = "flase=";
			String contextPathMp3 = "";
			String contextPathWav = "";			
			System.out.println();
			Map<String, Object> session = ActionContext.getContext().getSession();
			Map<String, Object> hMap = new HashMap<String, Object>();
			HttpServletResponse response = ServletActionContext.getResponse();
			
			String session_agent_code = (String)session.get("agent_code");
			if(func.f_NullCheck(session_agent_code).equals("")){
				return "session_out";
			}
			
			System.out.println(idx);
			//String filedownPath = getText("multifilePath");
			String filedownPath = getText("convert_file");			
			/*srcFile = getText("upload_file")+filedirectory;
			
			File src_file = new File(srcFile);*/
			String filecheck ="";
			List<Object> filenames = new ArrayList<Object>();
	        List<Object> filepathes = new ArrayList<Object>();	        
	        String idxArray[] = idx.split(",");
			for(int i=0 ;i < idxArray.length;i++){
				//RecodeDTO rd = new RecodeDTO();
				hMap.put("idx",idxArray[i]);
				RecodeDTO rd= (RecodeDTO)Recdao.getReadData("rec.selectDown",hMap);
				//filecheck = filedownPath +rd.getReal_path();
				//System.out.println("filecheck==>"+filecheck);
				//File check = new File(filecheck);
				//if(check.exists()){
					//filenames.add(rd.getOrigianl_filename());
					//filepathes.add(filedownPath );
				//}
				String srcFile = "";
				String destFile = "";
				//파일경로
				String real_path = rd.getReal_path();
				//파일이름
				String originFileName = rd.getOrigianl_filename();
				//wav파일로변환
				String wavFile = originFileName.replace(".spx", ".wav");
				//실제파일경로
				srcFile = getText("upload_file")+real_path;
				// 다운시 서버 context_path 
				contextPathMp3 = getText("context_path_mp3")+"/"+real_path;
				contextPathWav = getText("context_path_wav")+"/"+wavFile;
				//wav파일변환경로
				destFile = getText("convert_file")+wavFile;
				//basePath = destFile;
				System.out.println("srcFile==>"+srcFile);
				System.out.println("destFile==>"+destFile);
				
				System.out.println("============================파일변환");
				File src_file = new File(srcFile);
				File dest_file = new File(destFile);
				File context_path_mp3 = new File(contextPathMp3);
				File context_path_wav = new File(contextPathWav);				
				if(wavFile.indexOf(".mp3") > -1){
					try {
						if (!src_file.exists()){											
							System.out.println("[mp3 file not found.]");
						}else{
							System.out.println("[mp3 file  already exist]");
							message = "true=";
							filenames.add(wavFile);
							filepathes.add(tempUrl+context_path_mp3);
						}
					} catch (Exception e) {
						e.printStackTrace();
					}	
				}else{
					try {
						if (!dest_file.exists()){											
							new JSpeexDec().decode(src_file, dest_file);
							System.out.println("[spx convert!]");
						}else{
							System.out.println("[wave file  already exist]");
						}
					} catch (Exception e) {
						e.printStackTrace();
					}
					message = "true=";
					filenames.add(wavFile);
					filepathes.add(tempUrl+context_path_wav);
				}
									
			}
			//System.out.println("filenames===>"+filenames);
			//System.out.println("filepathes===>"+filepathes);
			/*
	        //파일압축
			//날짜변환포맷
			SimpleDateFormat formatter = new SimpleDateFormat("yyyyMMddkkmmss");
			//예)20110717185401   년도부터 초까지 구하기
			strdate = formatter.format(new Date());
			String downfile = strdate;
			//System.out.println("filedownPath==>"+filedownPath);
	        createZipFile(filenames, filepathes, filedownPath+downfile + ".zip");
			
			message = "true:"+downfile;
			*/
			if(filepathes.size() > 0){
				for(int i=0;i < filepathes.size();i++){
					message += filepathes.get(i);
					if(i != (filepathes.size()-1)){
						message += ",";
					}
				}
			}
			System.out.println("message===="+message);
			
		} catch (Exception ex) {
			System.out.println(ex.getMessage());
		}

		return SUCCESS;
	}



	//upload_file   ===>  /usr/local/nfs_mount_list/mount/record_mount/
	//convert_file  ===>  //usr/local/nfs_mount_list/mount/record_wav/



http://blog.naver.com/fxfighter?Redirect=Log&logNo=110025773581 xml만들기
http://rahxephon.tistory.com/1348 xml elementfilters



POST GetIvrCheck.action HTTP/1.1
Host: 210.121.190.96:8000
Content-Type: application/x-www-form-urlencoded
Content-Length: 94

http://192.168.0.210:8000/SkyProxy/GetIvrCheck.action?type=02&work_type=01&from_server=4&e164=302&dial_no=&hashdata=88d9c54dbc5f70664d1347a78b6a7976




 POST /SkyProxy/GetIvrCheck.action HTTP/1.1\r\n
 Host: 192.168.0.210:8000\r\n
 Content-Type: application/x-www-form-urlencoded\r\nContent-Length: 100\r\n\r\n
 type=01&
 work_type=02&
 forward_type=0&
 from_server=4&
 e164=302&
 hashdata=88d9c54dbc5f70664d1347a78b6a7976

 mysql_driver=com.mysql.jdbc.Driver
oracle_driver=oracle.jdbc.driver.OracleDriver

signal_db=jdbc:mysql://127.0.0.1:3306/SKYPBX?useUnicode=true
emsplus_db=jdbc:mysql://127.0.0.1:3306/EMSPLUS?useUnicode=true
if1_db=jdbc:mysql://192.168.0.214:3306/EMSPLUS?useUnicode=true
alarm_db=jdbc:mysql://127.0.0.1:3306/SKYCOMMON?useUnicode=true
ivrext_db=jdbc:mysql://192.168.0.216:3306/SKYIVREXT?useUnicode=true
media1_db=jdbc:mysql://127.0.0.1:3306/SKYMEDIA?useUnicode=true
media2_db=jdbc:mysql://127.0.0.1:3306/SKYMEDIA?useUnicode=true
orcl_db=jdbc:oracle:thin:@192.168.0.3:1521:orcl
record_db=jdbc:mysql://127.0.0.1:3306/SKYRECORD?useUnicode=true

username=root
password=skycom67960

ora_username=skycom
ora_password=system

5. 공유 목록 확인하기 

# exportfs -v

find / -name name

[root@ivr ment]# vi /etc/exports 

/usr/local/skycom/bin/step_ment 192.168.0.0/255.255.255.0(rw,no_root_squash)
/usr/local/skycom/bin/ment 192.168.0.0/255.255.255.0(rw,no_root_squash)

mount -t nfs 211.38.95.173:/usr/local/skycom/var/record/SpxFiles /usr/local/nfs_mount_list/mount/record_mount

mount -t nfs 192.168.0.167:/usr/local/skycom/var/ivr/ment/common /usr/local/nfs_mount_list/mount/rbt_mount
mount -t nfs 192.168.0.167:/usr/local/skycom/bin/step_ment /usr/local/nfs_mount_list/mount/ivr_ext_mount
mount -t nfs 192.168.0.167:/usr/local/skycom/bin/ment /usr/local/nfs_mount_list/mount/ivr_ment_mount

mount -t nfs 222.122.215.67:/usr/local/skycom/bin/ment /usr/local/nfs_mount_list/mount/rbt_mount
mount -t nfs 222.122.215.67:/usr/local/skycom/bin/step_ment /usr/local/nfs_mount_list/mount/ivr_ext_mount
mount -t nfs 222.122.215.67:/usr/local/skycom/bin/ment /usr/local/nfs_mount_list/mount/ivr_ment_mount


mount -t nfs 172.18.44.117:/usr/local/skycom/var/ivr/ment/ext /usr/local/skycom/var/ivr/ment/ext
mount -t nfs 192.168.0.167:/usr/local/skycom/var/ivr/ment/common /usr/local/nfs_mount_list/mount/rbt_mount

create or replace PROCEDURE        sp_pbx_ivr(
   vi_type         IN       VARCHAR2,  -- 작업유형(01: 착신전환, 02:잔액확인 )
   vi_work_type    IN       VARCHAR2,  -- 작업 구분(작업유형에 따른 변경)
   vi_f_type       IN       VARCHAR2,
   vi_e164         IN       VARCHAR2,  -- 가입자번호.
   vi_fno          IN       VARCHAR2,  -- 착신전환번호.
   vi_dial         IN       VARCHAR2,  -- 상대방 번호
   out_msg         OUT      VARCHAR2,  -- 000 : 변경성공 999 : 변경실패
   vo_return       OUT      VARCHAR2   -- 작업유형에 따른 내용 추가
   )
AS
/******************************************************************************
   NAME:       SP_PBX_User
   PURPOSE:

   REVISIONS:
   Ver        Date        Author           Description
   ---------  ----------  ---------------  ------------------------------------
   1.0        2010-12-13  1.               KFTEL IVR 연동 관련 PROCEDURE 추가 작업

   NOTES:
      작업내역
    * TYPE : 01 착신전환 설정
         WORK_TYPE : 00 일반착신전환설정
                     01 착신전환강제설정
                     02 착신전환 해제

             02 잔액및 통화가능시간
                     00 잔액확인
                     01 잔액및통화가능시간(상대방번호 필수)
    * VO_RETURN(항목 구문은 ':' 로 구분)
         1. 착신전환신청시 미사용
         2. 잔액및 통화가능시간 사용시
            00 잔액만 RETURN
            01 잔액,통화가능시간(초) 순으로 RETURN
    * OUT MESSAGE
      000: 성공           001: 미등록 H323 ID  002: 고객검색 오류   003: 착신전환 번호오류
      004: 상대방번호오류 005: 잔액없음        006: 과금요율 없음
      999: 기타실패
******************************************************************************/
   vs_rowid      VARCHAR2 (200);
   vn_current    NUMBER (12, 2);
   vs_sysdate    VARCHAR2(14) := TO_CHAR(sysdate, 'yyyymmddhh24miss');
   vn_duration   NUMBER (10);

   vs_cust_no        VARCHAR2 (10);
   vs_service_no     VARCHAR2 (10);
   vs_mng_no         VARCHAR2 (10);
   vs_agent          VARCHAR2 (10);
   vs_comm           VARCHAR2 (10);
   vs_rate_class     t_commodity.rate_class%TYPE;
   vs_auth_type      t_terminal_e164.auth_type%TYPE;
   vs_call_type      r_rate_analy.call_type%TYPE;
   vs_area_code      VARCHAR2 (10);
   vs_area_name      r_prefix_db.service_name%TYPE;
   vs_band           r_ddd_band.band_code%TYPE;
   vs_ccharge        NUMBER (12, 2);
   vs_ktcharge       VARCHAR2 (10);
   vs_icmyid         VARCHAR2 (10);
   vs_ocmyid         VARCHAR2 (10);
   vs_cmyareacode    VARCHAR2 (10);
   vs_incmy_area     VARCHAR2 (10);
   vn_dosu           NUMBER (10);
   vn_dosu_sec       NUMBER (10);
   vs_comm_type      VARCHAR2(1);
   vs_icharge        NUMBER (12, 5);
   vs_ocharge        NUMBER (12, 5);

BEGIN
   out_msg   := '000';
   vo_return := '';
   vn_duration := 9999;
   -- 고객 검색
   BEGIN
      SELECT NVL(current_amount,0), row_id,  comm_type
        INTO vn_current,     vs_rowid,vs_comm_type
        FROM (SELECT /*+ index_desc(A t_terminal_idx) */
                     a.cust_no, a.service_no,
                      (  SELECT TO_NUMBER (NVL (col_value, '0')) 
                 FROM t_terminal_subtot S
                WHERE col_nm = 'BALANCE'
                  AND ((A.DEDUCT_TYPE = 1 AND  LINK_GU = '01')
                   OR (A.DEDUCT_TYPE <> 1 AND  LINK_GU = '02'))
                  AND  ((A.DEDUCT_TYPE = 1 AND  MNG_NO = A.SERVICE_NO)
                   OR (A.DEDUCT_TYPE <> 1 AND  MNG_NO = B.MNG_NO)) ) AS current_amount,
                    b.mng_no AS ROW_ID, d.comm_type
                FROM t_terminal a, t_terminal_e164 b,   t_commodity d
               WHERE a.service_no = b.service_no
                 AND b.comm_code  = d.comm_code
                 AND b.e164_no = vi_e164
                 AND ROWNUM = 1) a;
   EXCEPTION
      WHEN NO_DATA_FOUND THEN
         out_msg := '002';
         RETURN;
      WHEN OTHERS THEN
         out_msg := '002';
         RETURN;
   END;

   -- 착신전환 번호 확인
   IF vi_type = '01' AND vi_work_type <> '02' AND TRIM(vi_fno) IS NULL THEN
         out_msg := '003';
         RETURN;
   END IF;


   -- 01 착신전환 신청/해제
   -- 02 잔액 확인
   IF vi_type = '01' THEN
      BEGIN
--         UPDATE t_terminal_proxy
--            SET FORWARD_TYPE = vi_f_type,
--                FORWARD_NO = trim(replace(replace(vi_fno, '*87'), '*86'))
--          WHERE ROWID = vs_rowid;

            UPDATE T_TERMINAL_SUBTOT
            SET COL_VALUE = vi_f_type
            WHERE MNG_NO = vs_rowid
            AND COL_NM = 'FORWARD_TYPE'
            AND LINK_GU = '02';
      EXCEPTION
         WHEN OTHERS THEN
            out_msg := '999';
            ROLLBACK;
            RETURN;
      END;

      IF SQL%ROWCOUNT < 1 THEN
         out_msg := '999';
         ROLLBACK;
         RETURN;
      END IF;


      BEGIN
--         UPDATE t_terminal_proxy
--            SET FORWARD_TYPE = vi_f_type,
--                FORWARD_NO = trim(replace(replace(vi_fno, '*87'), '*86'))
--          WHERE ROWID = vs_rowid;

            UPDATE T_TERMINAL_SUBTOT
            SET COL_VALUE = trim(replace(replace(vi_fno, '*87'), '*86'))
            WHERE MNG_NO = vs_rowid
            AND COL_NM = 'FORWARD_NO'
            AND LINK_GU = '02';
      EXCEPTION
         WHEN OTHERS THEN
            out_msg := '999';
            ROLLBACK;
            RETURN;
      END;

      IF SQL%ROWCOUNT < 1 THEN
            BEGIN
                 INSERT INTO T_TERMINAL_SUBTOT
                 (MNG_NO, COL_NM, LINK_GU, SERVICE_NO, TERMINAL_TYPE, 
                  COL_VALUE, COL_VALUE_BEF, INS_DT, INS_ID, UPD_DT, UPD_ID)
                 SELECT MNG_NO, 'FORWARD_NO', LINK_GU, SERVICE_NO, TERMINAL_TYPE,
                   trim(replace(replace(vi_fno, '*87'), '*86')) , '', 
                   TO_CHAR(SYSDATE , 'YYYYMMDDHH24MISS'), 'IVR', TO_CHAR(SYSDATE , 'YYYYMMDDHH24MISS'), 'IVR'
                   FROM T_TERMINAL_SUBTOT
                    WHERE MNG_NO = vs_rowid
                    AND COL_NM = 'FORWARD_TYPE'
                    AND LINK_GU = '02';
            EXCEPTION
             WHEN OTHERS THEN
                out_msg := '999';
                ROLLBACK;
                RETURN;
            End;  
      END IF;
      --SP_HISTORY_REG ( 'P', vs_rowid, TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'), out_msg );

   ELSIF vi_type = '02' THEN
      IF vi_work_type = '00' THEN
         vo_return := TO_CHAR(vn_current);

      ELSIF vi_work_type = '01' THEN

         -- 잔액없음 오류 추가
         IF vn_current = 0 AND vs_comm_type <> '3' THEN
            out_msg := '005';
            vo_return := '0:0';
            RETURN;
         END IF;

         IF vi_dial IS NULL THEN
            out_msg := '004';
         END IF;

         chargeproc (vi_e164,       vi_dial,      '',   vs_sysdate,    60,               '',            '',
                     vs_cust_no,    vs_service_no, vs_mng_no,     vs_agent,         vs_comm,       vs_rate_class,
                     vs_auth_type,  vs_call_type,  vs_area_code,  vs_area_name,     vs_band,       vs_ccharge,
                     vs_ktcharge,   vs_icmyid,     vs_ocmyid,     vs_cmyareacode,   vs_incmy_area, vn_dosu,
                     vn_dosu_sec,   vs_icharge,    vs_ocharge,    out_msg);

         -- 통화가능시간 계산처리
         IF vs_ccharge > 0 THEN
            vn_duration := TRUNC (vn_current / (vs_ccharge / vn_dosu)  ) * vn_dosu_sec;
         END IF;

         vo_return := TO_CHAR(vn_current) ||':'||TO_CHAR(vn_duration) ;
      END IF;
   END IF;

END sp_pbx_ivr; 



tail -f /home/weblog/tomcat/catalina.out.20121009 


java.lang.AbstractMethodError: org.apache.catalina.connector.CoyoteAdapter


jQuery.ajax({
	type : "POST",
	data : 'idx='+ arr_value,
	url : "mutidownload.action",
	success: function(responseText){  
	var file_name = jQuery.trim(responseText);
	$('#frm').attr('method', 'post');
	$('#frm').attr('target', 'downLoad');
	$('#frm').attr('action', 'download.action');
	$('#frm').submit(); 	
}});

$(document).ready(function() {
	$('#changePwd').bind("click",function() {
		 $.post(url,{server_idx:serverIdx},function(data){
			 $("#htime_table").html(data);				 
		     });	    
		$("#htime_table").show();
	}
}
//function 메소드 level click 클릭시 반응

$(function(){ 
	$("#level").click(function(){
		alert();
	});
}


/usr/local/tomcat/webapps/SkyProxy/WEB-INF/classes/skycom/pbx/db

211.237.76.81

signal_db=jdbc:mysql://192.168.0.90:3306/SKYPBX?useUnicode=true
emsplus_db=jdbc:mysql://127.0.0.1:3306/EMSPLUS?useUnicode=true
if1_db=jdbc:mysql://192.168.0.78:3306/SKYINTERFACE?useUnicode=true
if2_db=jdbc:mysql://192.168.0.79:3306/SKYINTERFACE?useUnicode=true
alarm_db=jdbc:mysql://192.168.0.86:3306/SKYALARM?useUnicode=true
ivrext_db=jdbc:mysql://192.168.0.86:3306/SKYIVR?useUnicode=true
logserver_db=jdbc:mysql://192.168.0.34:3306/SKYLOGSERVER?useUnicode=true
media1_db=jdbc:mysql://192.168.0.76:3306/SKYMEDIA?useUnicode=true
media2_db=jdbc:mysql://192.168.0.77:3306/SKYMEDIA?useUnicode=true
msg_db=jdbc:mysql://210.121.190.120:3306/jabberd2
orcl_db=jdbc:oracle:thin:@192.168.0.82:11004:ora10g
provision1_db=jdbc:mysql://192.168.0.34:3306/PROVISION?useUnicode=true
provision2_db=jdbc:mysql://192.168.0.34:3306/PROVISION?useUnicode=true
record_db=jdbc:mysql://192.168.0.79:3306/SKYRECORD?useUnicode=true
sms_db=jdbc:mysql://192.168.0.34:3306/SKYSMS?useUnicode=true
userplus_db=jdbc:mysql://192.168.0.34:3306/USERPLUS?useUnicode=true
vms_db=jdbc:mysql://192.168.0.34:3306/SKYVMS?useUnicode=true



http://envyteam.tistory.com/60 aapache tomcat 연동


http://www.mimul.com/pebble/default/2012/09/14/1347604822256.html 이중화

http://222.231.59.95:8000/SkyProxy
dmlwjdqn!@#$' ssh -oStrictHostKeyChecking=no root@222.231.59.95



/usr/local/tomcat/webapps/SkyProxy/jsp/c_group


/usr/local/tomcat/webapps/SkyProxy/WEB-INF/classes/skycom/pbx/c_group
/usr/local/tomcat/webapps/SkyProxy/WEB-INF/classes/skycom/pbx/groupadmin
/usr/local/tomcat/webapps/SkyProxy/WEB-INF/classes/skycom/pbx/groupmember
/usr/local/tomcat/webapps/SkyProxy/WEB-INF/classes/skycom/pbx/groupProperty



public String execute(){
		Func func = new Func();
		String str = func.authChek(menu_code);
		if(!str.equals(""))return str;
		
		try{
			realmList = groupAdminMgr.getGroupAdminRealmList(0);
			func.SelectListSort(realmList, t);
			policygroupList = groupAdminMgr.getGroupAdminList(3);
			func.SelectListSort(policygroupList, t);
		} catch (SQLException e) {
			e.printStackTrace();
		}
		
		return SUCCESS;
	}


아이폰 어플 배포 in-house 설정

1. Xcode Menu -> Build -> Build and Archive 를 클릭하면 빌드 후 Organizer 를 실행

2. Orgnizer 실행 -> Share Application click -> 계정입력
 
3. 배포 방법선택 
  1> Save to disk
  2> E-mail
  3> Distribute for Enterprise (0)

4. 서버등륵 설정창
	Application
	url : http://mobileworld.nonghyup.com/download/smartclick_ent.ipa
	title : smartclick
	subbtitle : smartclick
5. ipa 파일을 저장하는 폴더지정
   폴더 지정 후 저장을 하면 해당 폴더에 smartclick_ent.ipa, smartclick_ent.plist 파일 생성
   이 두파일을 웹서버로 복사 배포준비 끝
   다운 주소 : <a href="itms-services://?action=download-manifest&url=http://mobileworld.nonghyup.com/download/smartclick_ent.plist">
  

참고 url

http://blog.daum.net/bluefild/16 

http://blog.daum.net/bluefild/17

http://theeye.pe.kr/entry/how-to-use-build-and-archive-on-new-xcode

http://theeye.pe.kr/entry/how-to-distribute-using-adhoc-distribution-on-iphone-sdk

http://cafe.naver.com/mcbugi/143494 


http://blog.naver.com/deepb1ue?Redirect=Log&logNo=50118883923 window.showModalDialog
















subversion linux Please type 'yes' or 'no': 한글로 예 하면 해결
svnadmin create --fs-type fsfs /home/webrepos/skybill_rate
http://note.mireene.com/i/boardos/2922
svn 설치

1. yum install -y subversion
2. 저장소 디렉토리를 생성(택1)
	> svnadmin create --fs-type fsfs /var/repos (파일시스템방식)
	> svnadmin create --fs-type bdb /var/repos (버클리DB방식)

3. svn 설정을 변경 (주석제거)
	> vi /var/repos/conf/svnserve.conf
	> anon-access = read (익명사용자 읽기권한) 주석제거
	> auth-access = write (등록된 사용자 쓰기 권한) 주석제거
	> password-db = passwd (인증에 사용될 패스워드 설정) 주석제거
4. 사용자 id 와 pwd 추가
	> vi var/repos/conf/passwd
	> pjw = 1111
5. svn 서버 실행
	> svnserve -d -r /var/repos
6. 리눅스 부팅시 자동으로 실행하도록 설정
	> vi /etc/rc.d/rc.local
	> svnserve -d -r /var/repos 추가
7. svn 에디터 설정
	> vi ~/.bash_profile
	> export SVN_EDITOR= /usr/bin/vim
	> source .bash_profile
8. trunk 디렉토리 생성
	> svn mkdir svn://localhost/trunk , branches, tags
	> C, 에러시 vim ~/.subversion/servers #stre-passwords 주석제거
	> yes

9. 외부접속안될시 iptable 설정 
	>iptables -I INPUT -p tcp --dport 8080 -j ACCEPT
	>/etc/rc.d/init.d/iptables save
	>/etc/rc.d/init.d/iptables restart



1. JDK 설치 여부 확인  - java -version 에서 OpenJDK 인 경우 삭제 처리   
	- rpm -qa | grep jdk  
	- yum remove java-1.6...... 
2. JDK 설치   
	- cd /usr/local  
	- wget http://download.oracle.com/otn-pub/java/jdk/6u29-b11/jdk-6u29-linux-i586.bin  
	;http://download.oracle.com/otn-pub/java/jdk/6u37-b06/jdk-6u37-linux-i586.bin
	http://download.oracle.com/otn-pub/java/jdk/6u43-b01/jdk-6u43-linux-i586.bin
	- chmod 755 ./jdk-6u29-linux-i586.bin   
	- ./jdk-6u29-linux-i586.bin  - 바로 가기 링크    /usr/local 에서 ln -s /usr/local/jdk1.6.0_29/ java  
	- 1.4 버젼 gij 로 확인되면 링크 제거    rm -rf /usr/bin/java 
3. JDK 패스 설정  
	- vi /etc/profile                
		JAVA_HOME=/usr/local/jdk1.6.0_45       
		export JAVA_HOME          
		PATH=$PATH:$JAVA_HOME/bin:/usr/local/ant/bin           
		CLASSPATH=$CLASSPATH:$JAVA_HOME/lib          
		export PATH USER LOGNAME MAIL HOSTNAME HISTSIZE INPUTRC CLASSPATH  
	- source /etc/profile  
4. ant 설치   
	- /usr/local  
        -2 wget http://apache.tt.co.kr//ant/binaries/apache-ant-1.8.4-bin.tar.gz
	- tar xvfz apache-ant-1.8.2-bin.tar.gz 
	- mv apache-ant-1.8.2/ ant 
5. 시간 동기화  
	- rdate.sh 만들기   
	- /root/rdate.sh -> rdate -s time.bora.net  
	- chmod 755 /root/rdate.sh  - 클론탭 설정  
	- crontab -e    -> 01 00 * * * /root/rdate.sh

tomcat 설치

1. wget http://mirror.apache-kr.org/tomcat/tomcat-6/v6.0.35/bin/apache-tomcat-6.0.35.tar.gz
2. tar xvfz apache-tomcat-6.0.35.tar.gz
3. /usr/local/tomcat 이동
4. vi /etc/profile
5. 
#tomcat
CATALINA_HOME=/usr/local/tomcat
export JAVA_HOME CATALINA_HOME
PATH=$PATH:$JAVA_HOME/bin:/usr/local/ant/bin:$CATALINA_HOME/bin

추가
source /etc/profile

http://linuxism.tistory.com/470

apache 설치 솔라리스 : http://g2unu.blogspot.kr/2013/02/solaris10-apache2-tomcat6.html

1. wget http://apache.mirror.cdnetworks.com//httpd/httpd-2.2.23.tar.gz
2. /usr/local/apahe 압축풀어서 이동
3. yum -y install gcc*
4. ./configure --prefix=/usr/local/apache --enable-so --with-mpm=worker --enable-rewriter --enable-headers --enable-ssl
./configure --prefix=/usr/local/apache --enable-ssl --with-ssl=/usr/local/ssl --enable-mods-shared=ssl
;;;
다른거 (./configure --enable-so --enable-mods-shared=most)
make && make install
configure: error: ...No recognized SSL/TLS toolkit detected 에러시
yum install openssl-devel
LoadModule speling_module modules/mod_speling.so
LoadModule rewrite_module modules/mod_rewrite.so
LoadModule ssl_module modules/mod_ssl.so

modules 폴더
mod_jk.so
mod_rewrite.so
mod_speling.so

mod_ssl 설정 -http://blog.daum.net/crosscert/38 , http://theduck.tistory.com/35
http://blog.naver.com/fbisk?Redirect=Log&logNo=140048067954
openssl genrsa -des3 -out server.key 2048
openssl req -new -key server.key -out server.csr
openssl x509 -req -days 365 -in server.csr -signkey server.key -out server.crt
[root@localhost ~]# cp server.key /usr/local/apache/conf/
[root@localhost ~]# cp server.crt /usr/local/apache/conf/

아파치 apachee load loadbalancer
 - httpd.conf
  : Include conf/mod_jk.conf 추가
  : DocumentRoot "/usr/local/tomcat/webapps" 변경
 - mod_jk.conf
 :	LoadModule jk_module modules/mod_jk.so
	<IfModule jk_module> 
	 JkWorkersFile conf/workers.properties
	 JkLogFile logs/mod_jk.log
	 JkLogLevel info
	 JkMountFile conf/uri.properties
	</IfModule>
 - worker.conf
 <!-- Define an AJP 1.3 Connector on port 8009 -->
    <Connector port="9309" protocol="AJP/1.3" redirectPort="8443" />
    <Engine jvmRoute="standby1"  name="Catalina" defaultHost="localhost"> tomcat 에 설정

worker.list=loadbalancer

worker.standby1.port=9309    
worker.standby1.host=localhost
worker.standby1.type=ajp13
worker.standby1.lbfactor=1


worker.standby2.port=19309
worker.standby2.host=localhost
worker.standby2.type=ajp13
worker.standby2.lbfactor=1

worker.loadbalancer.type=lb
worker.loadbalancer.balanced_workers=standby1,standby2 
===========================================================================
mod_jk 설정 20130925
@@mod_jk 설치
1. ./configure --with-apxs=/usr/local/apache2/bin/apxs
2. make && make install





1. mod_jk 설치후

@@workers.properties 생성
 
 worker.list=loadbalancer

worker.standby1.port=8009
worker.standby1.host=localhost
worker.standby1.type=ajp13
worker.standby1.lbfactor=1


#worker.standby2.port=19309
#worker.standby2.host=localhost
#worker.standby2.type=ajp13
#worker.standby2.lbfactor=1

worker.loadbalancer.type=lb
worker.loadbalancer.balanced_workers=standby1 

@@uri.properties 생성
#/*.jsp =loadbalancer
#/*.action =loadbalancer
#/dwr/* =loadbalancer
#/*.wav =loadbalancer
/* = loadbalancer
@@mod_jk.conf  생성
LoadModule jk_module modules/mod_jk.so
<IfModule jk_module> 
JkWorkersFile conf/workers.properties
JkLogFile logs/mod_jk.log
JkLogLevel info
JkMountFile conf/uri.properties
</IfModule>

@@httpd.conf 수정

DocumentRoot "/usr/local/tomcat/webapps" 추가
Include conf/mod_jk.conf 추가
Listen [ip]:80 수정
ServerName localhost:80

<Directory />
    Options FollowSymLinks
    AllowOverride None
    Order deny,allow
    #Deny from all
    Allow from all
</Directory>





===========================================================================2013-09-25


iptables list 

vi /etc/sysconfig/iptables
-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 8080 -j ACCEPT
/etc/init.d/iptables restart

환경설정
# vi /etc/profile
다음을 추가한다.
# Apache 2.2.15
export APACHE_HOME=/usr/local/apache
export PATH=$PATH:$APACHE_HOME/bin 


/etc/profile을 저장한 후

mod_jk 설치
1. wget http://mirror.apache-kr.org//tomcat/tomcat-connectors/jk/tomcat-connectors-1.2.37-src.tar.gz
2. tar xvfz tomcat-connectors-1.2.37-src.tar.gz
3. ./configure --with-apxs=/usr/local/apache/bin/apxs
4. make
5. make install
http://seoeun25.tistory.com/397





# source /etc/profile 

 

Apache 실행
apachectl start 

 

iptables 에서 80 추가 

# service iptables stop 

# vi /etc/sysconfig/iptables 

… 

-A INPUT -m state --state NEW -m tcp -p tcp --dport 80 -j ACCEPT 

… 

# service iptables start 




151059254 관리자
89204739
05517051


헝가리

vi /etc/odbc.ini
isql ODBC_FOR_MEDIA

idx        | filedirectory                                                                                                                                                                                                                                             |
+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 19763      | Server1/20121009/22210_0038521538184_2051_2jHwqra99r.mp3  

| idx        | filedirectory                                                                                                                                                                                                                                             |
+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 19751      | Server1/20121009/22195_0038531325856_2052_8XjOm5WU8A.mp3  

/usr/local/skycom/var/record/SpxFiles/Server1/20121009

192.168.0.220
admin/admin123

postmaster


<s:if test="%{Monday == 1}">v</s:if>

skyrec

,src_g729a

select * from t_rbtpolicy
; 	
select src_directory from t_crbt_config
;




// 변환파일저장경로

select * from t_crbt_config;

/usr/local/skycom/var/ment/rootgroup // 변환파일저장경로

// wav 저장경로
select src_path from t_rbtpolicy  where set_div = '00' and policy_div = '01' and seq = '3'; wav 저장경로

테스트서버 경로입니다. /usr/local/tomcat/webapps/SkyRBT/soundsrc/rootgroup


안녕하세요 (주)스카이컴 박정우 입니다.

1. 업데이트 파일 경로입니다.

<java class>
톰캣경로\SkyRBT\build\classes\skycom\process\configure
	setConfigureA.class
	setConfigureV.class
	configure.xml
<jsp>
톰캣경로\SkyRBT\WebContent\process\configure\
	setConfigure.jsp

4개의 파일을 붙여넣기후 톰캣을 재부팅해주시면 됩니다.

2.음원파일업로드

 > 테스트 서버 db에 src_g729a varchar(50) 컬럼을 추가 하였습니다. 리얼서버에 확인후 추가해주시면 될것 같습니다.

3.음원파일업로드시 저장경로 리얼서버에 따로 확인해주시기 바랍니다.

 > wav 파일 저장경로
	: select src_path from t_rbtpolicy  where set_div = '00' and policy_div = '01' and seq = '3'; 
	 ex> /usr/local/tomcat/webapps/SkyRBT/soundsrc/rootgroup/rootgroup201210221157076.wav  
 > 변환파일3개 저장경로
	: select src_directory from t_crbt_config;
	 ex> /usr/local/skycom/var/ment/rootgroup/rootgroup2012102214042111.g711a, rootgroup2012102214042111.g711u, rootgroup2012102214042111.g729a




 <output>
	<var name="result" value="OK" />
	<var name="message" value="" />
</output>


큰사람

121.78.87.16
큰사람!@#$

html outerHTML = $("#upload").replaceWith('<input type="file" id="upload" name="upload" value="" accept="wav,mp3" id="uploadForm_upload" class="table_input_3" style="width:242"/>');
html innerHTML = $("#ring_select").html("<select name='ivrExtScenarioDTO.ringout' id = 'ringout' class='table_input_3'>"+str+"</select>");


-Could not find action or result
No result defined for action skycom.pbx.ivrcommon.IVRCommonAction and result input - action 
- file:/D:/Dev/workspace/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps/Proxy_hungary/WEB-INF/classes/ivrCommon.xml:26:95






<div style="float: left;width: 96%;margin: 0 0 5px 8px;">
	<div id = "search_1" style="width: 49%">
		<div id="bt_save2">					
			<label>group name:</label>		
			<input type="text" id="" name="" class="w8tb_input" onkeyup="enter_search(event)"></input>
		</div>
		<div id="bt_save2">					
			<label>queue:</label>		
			<input type="text" id="" name="" class="w8tb_input" onkeyup="enter_search(event)"></input>
		</div>		
		<div style="clear: both;"/>							
		<div id="bt_save2" style="padding-left: 40px">
			<label>moh:</label>		
			<input type="text" id="" name="" class="w8tb_input" onkeyup="enter_search(event)"></input>
		</div>
		<img style="float: left; cursor: pointer; margin-top: 4px; margin-left: 3px" src="images/bt_search.gif" width="71px" height="23px" border="0"  alt="<s:text name='label.search'/>" onclick="javascript:goSearchSound()">							
	</div>		
		
	<div id = "search_1" style="width: 50%;">
		<div id="bt_save2">					
			<label>e164:</label>		
			<input type="text" id="" name="" class="w8tb_input" onkeyup="enter_search(event)"></input>
		</div>
		<div id="bt_save2">					
			<label>group name:</label>		
			<input type="text" id="" name="" class="w8tb_input" onkeyup="enter_search(event)"></input>
		</div>				
		<img style="float: left; cursor: pointer; margin-top: 4px; margin-left: 3px" src="images/bt_search.gif" width="71px" height="23px" border="0"  alt="<s:text name='label.search'/>" onclick="javascript:goSearchGroup()">
	</div>
</div>
<div style="float: left;width: 96%;margin: 0 0 5px 8px;">
	<div style="width: 49%;float: left;margin: 2px 0 0 4px;">
		<div id="totalcnt" align="justify"  style="float: left">Total : 0</div>		
		<div style="float: right">			
			<img style="cursor: pointer" alt="" src="images/bt_new.gif" width="71px" height="23px" border="0"  alt="<s:text name='button.new'/>" onclick="javascript:goResetSound()">
   	 		<img style="cursor: pointer" alt="" src="images/bt_save.gif" width="71px" height="23px" border="0"  alt="<s:text name='button.save'/>" onclick="javascript:goSaveSound('frmFile1')">	   	 	
   	 		<img style="cursor: pointer" alt="" src="images/bt_delete.gif" width="71px" height="23px" border="0"  alt="<s:text name='button.delete'/>" onclick="javascript:goDeleteSound()">		
		</div>
	</div>
	
	<div style="width: 50%;float: left;margin: 2px 0 0 4px;">
		<div id="totalcnt" align="justify"  style="float: left">Total : 0</div>		
		<div style="float: right">			
			<img style="cursor: pointer" alt="" src="images/bt_new.gif" width="71px" height="23px" border="0"  alt="<s:text name='button.new'/>" onclick="javascript:goResetGroup()">
   	 		<img style="cursor: pointer" alt="" src="images/bt_save.gif" width="71px" height="23px" border="0"  alt="<s:text name='button.save'/>" onclick="javascript:goSaveGroup('frmFile1')">	   	 	
   	 		<img style="cursor: pointer" alt="" src="images/bt_delete.gif" width="71px" height="23px" border="0"  alt="<s:text name='button.delete'/>" onclick="javascript:goDeleteGroup()">		
		</div>
	</div>
</div>
<div style="float: left;width: 96%;margin: 0 0 5px 8px;">
	<div style="width: 49%;float: left;margin: 2px 0 0 4px;"">
		<div id="list" ></div>
	</div>
	<div style="width: 50%;float: left;margin: 2px 0 0 4px;"">
		<div id="list2" ></div>
	</div>
</div>
<div style="float: left;width: 96%;margin: 0 0 5px 8px;">
	<div style="width: 49%;float: left;margin: 2px 0 0 4px;">
		<table cellpadding="0" cellspacing="0" class="table_out">
		    <tr>
			   	<s:hidden id = "idx" name = "ivrCommonDTO.idx"/>   		
		    	<td class="table_tx" >Sound Name</td>
		        <td class="table_gx"><s:textfield cssClass="table_input_3" name = "ivrCommonDTO.sound_name" id = "sound_name"/></td>	    
	   		</tr>
	   		<tr>		   	
		        <td class="table_tx">Description</td>
				<td class="table_gx">
				<s:textfield cssClass="table_input_3" name = "ivrCommonDTO.description" id = "description"/>
		    </td>
	   		</tr>
		</table>
	</div>
	<div style="width: 50%;float: left;margin: 2px 0 0 4px;">
		<table cellpadding="0" cellspacing="0" class="table_out">
		    <tr>
			   	<s:hidden id = "idx" name = "ivrCommonDTO.idx"/>   		
		    	<td class="table_tx" >Sound Name</td>
		        <td class="table_gx"><s:textfield cssClass="table_input_3" name = "ivrCommonDTO.sound_name" id = "sound_name"/></td>	    
	   		</tr>
	   		<tr>		   	
		        <td class="table_tx">Description</td>
				<td class="table_gx">
				<s:textfield cssClass="table_input_3" name = "ivrCommonDTO.description" id = "description"/>
		    </td>
	   		</tr>
		</table>
	</div>
</div>















 SELECT  skyweb_address      ,skyweb_port    FROM t_server_info 

 寃쎄퀬: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'debug' to '0' did not find a matching propert

 SEVERE: Exception Processing ErrorPage[exceptionType=java.lang.Exception, location=/jsp/error/errorpage.jsp]
java.lang.IllegalStateException: Cannot reset buffer after response has been committed
  at org.apache.catalina.connector.Response.resetBuffer(Response.java:691)
  at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:409)
  at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:271)
  at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:142)
  at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
  at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
  at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
  at org.apache.jk.server.JkCoyoteHandler.invoke(JkCoyoteHandler.java:190)
  at org.apache.jk.common.HandlerRequest.invoke(HandlerRequest.java:291)
  at org.apache.jk.common.ChannelSocket.invoke(ChannelSocket.java:776)
  at org.apache.jk.common.ChannelSocket.processConnection(ChannelSocket.java:705)
  at org.apache.jk.common.ChannelSocket$SocketConnection.runIt(ChannelSocket.java:898)
  at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:690)
  at java.lang.Thread.run(Thread.java:679)

<%
out.clear();
out = pageContext.pushBody();
%>
 요 두줄을 OutputStream 하기전에 넣어주면 되겟다 out은 jsp 웹페이지 자신을 가리키는것!!!
 jsp 에서는 servlet 으로 변환될때 내부적으로 out 객체가 자동으로 생성되기 때문에 따로 out 객체를 만들면 충돌이 일어나서 저런 메시지가 뜨는것이라고 한다.
-해결 방법

1. DownloadUtil.downLoadFile(String filePathName) 에서 OutputStream 을 사용하지 않음(테스트 해보진 않았지만 왠지 될 거 같음.. ㅎㅎ)

 

2. 포워딩 되는 jsp 페이지를 공백 페이지로 작성하고, 코드 첫 부분에 아래와 같은 코드를 삽입.(response 에서 getOutputStream() 호출하기 전..)

<%

out.clear();

%>

 

3.  다른 방법으로는 역시 포워딩 되는 jsp 페이지의 내용에 아래와 같은 코드 삽입.(아래 소스는 http://dev.alseom.co.kr/88  에서 퍼옴)

<%

out.clear(); 

out=pageContext.pushBody(); 

OutputStream out = response.getOutputStream(); 

%>

 

추가


-res.reset() 사용 시 Exceptinon 설명

위의 소스 중 initResponse() 에 

//res.reset(); //있어선 안되는 코드, 반드시 주석처리

라고 되어 있는 부분을 주석 해제 하고 실행 하면 아래와 같은 Exception 발생

20xx. 2. xx 오후 2:07:54 org.apache.catalina.core.StandardHostValve custom

심각: Exception Processing ErrorPage[exceptionType=java.lang.Exception, location=/exception.jsp]

java.lang.IllegalStateException: Cannot reset buffer after response has been committed : 응답이 커밋 된 후 버퍼를 재설정 할 수 없습니다

at org.apache.catalina.connector.Response.resetBuffer(Response.java:691)

at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:409)

at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:271)

at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:142)

at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)

at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)

at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)

at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:849)

at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)

at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:454)

at java.lang.Thread.run(Thread.java:595)

 

에러 내용으로 보아, response 객체가 확정된 후, buffer 를 reset 할 수 없다고 하는데.. 

Cannot 이라고 하니 사용하지 말아야지..(웹 어딘가에 이런 소스가 있어서 헤맸음.) 


java.lang.IllegalStateException 
이 익셉션이 왜 일어나는지만 이해하면.. 쉽게 처리가 가능합니다. (물론 구조적으로 해결하기가 힘든 경우도 있지만..) 
저 익셉션은 forward나 redirect를 하기전에.. out.println() 또는 response.setHeader(..)와 같은 함수를 호출해서 발생합니다. 즉 브라우져에 보낼 데이터를 버퍼에 쓴 이후로는 redirect나 forward를 할수 없다는 말입니다. 
발생한 jsp에서 위와 같은 사항이 없는지 살펴보시길.. 





위와 같은 패턴의 에러는
Servlet이나 JSP에서 forward등을 할때, 이미 buffer가 flush된 경우입니다.
예를 들어

out.print("Hello");
response.forward(URL);
이런 경우에 발생합니다.
forward를 할때는 buffer로 write하는 내용이 없어야 합니다.
buffer에 어떤 내용을 write하는지 찾아보세요.



	public String getUpdate_time() {
		return func.timecheckUTC(update_time);
	}

	public void setUpdate_time(long update_time) {
		this.update_time = update_time;
	}
	ringoutList.add(new OptionList("ringout", "DEFAULT"));
		ringoutList.add(new OptionList("C", "The Current File"));




// 톰캣 이중화

<Server port="8005" shutdown="SHUTDOWN">
 <Connector port="8080" protocol="HTTP/1.1"
               connectionTimeout="20000"
               redirectPort="8443" acceptCount="100" address="127.0.0.1" />
 <Connector port="9309" protocol="AJP/1.3" redirectPort="8443" /> 아피치 연결 포트
 
 <Engine jvmRoute="standby1"  name="Catalina" defaultHost="localhost"> 아파치 로드밸런스 아이디

 <Host name="localhost"  appBase="webapps"
            unpackWARs="true" autoDeploy="true"
            xmlValidation="false" xmlNamespaceAware="false">
      <!--<Context path="/test" docBase="/usr/local/mount" debug="0" reloadable="true" />-->
	  <Context path="" docBase="SkyProxy" debug="0" reloadable="false" />

2번경로
 <Host name="localhost"  appBase="/usr/local/tomcat/webapps"
            unpackWARs="true" autoDeploy="true"
            xmlValidation="false" xmlNamespaceAware="false">
      <!--<Context path="/test" docBase="/usr/local/mount" debug="0" reloadable="true" />-->
	  <Context path="" docBase="SkyProxy" debug="0" reloadable="true" />


//톰켓 이중화

1. 톰캣 2대 설치
/usr/local/tomcat
/usr/local/tomcat2

/tomcat/server.xml 설정
22 : <Server port="8005" shutdown="SHUTDOWN">
68 :    <Connector port="8080" protocol="HTTP/1.1"
               connectionTimeout="20000"
               redirectPort="8443" acceptCount="100" address="127.0.0.1" />
88 :     <Connector port="9309" protocol="AJP/1.3" redirectPort="8443" />

100 :     <Engine jvmRoute="standby1"  name="Catalina" defaultHost="localhost">

121 :       <Host name="localhost"  appBase="webapps" unpackWARs="true" autoDeploy="true" xmlValidation="false" xmlNamespaceAware="false">
            <Context path="" docBase="SkyProxy" debug="0" reloadable="false" />
/tomcat2/server.xml 설정
22 : <Server port="18005" shutdown="SHUTDOWN">
68 : <Connector port="18080" protocol="HTTP/1.1" 
               connectionTimeout="20000" 
               redirectPort="8443" acceptCount="100" address="127.0.0.1" />
88 :     <Connector port="19309" protocol="AJP/1.3" redirectPort="8443" />
100:     <Engine jvmRoute="standby2"  name="Catalina" defaultHost="localhost">
121 :       <Host name="localhost"  appBase="/usr/local/tomcat/webapps" unpackWARs="true" autoDeploy="true" xmlValidation="false" xmlNamespaceAware="false">
            <Context path="" docBase="SkyProxy" debug="0" reloadable="false" />

/apache 설정 mod_jk 설치가 되어 있어야함

29 : ServerRoot "/usr/local/apache/"
47 : Listen 80
61:
#LoadModule speling_module modules/mod_speling.so
#LoadModule rewrite_module modules/mod_rewrite.so

113:DocumentRoot "/usr/local/tomcat/webapps"
417 : Include conf/mod_jk.conf

/usr/local/apache/conf/mod_jk.conf 설정

LoadModule jk_module modules/mod_jk.so
<IfModule jk_module> 
JkWorkersFile conf/workers.properties
JkLogFile logs/mod_jk.log
JkLogLevel info
JkMountFile conf/uri.properties
</IfModule>

/usr/local/apache/conf/uri.properties 설정
#/*.jsp =loadbalancer
#/*.action =loadbalancer
#/dwr/* =loadbalancer
#/*.wav =loadbalancer
/* = loadbalancer

/usr/local/apache/conf/workers.properties 설정

worker.list=loadbalancer

worker.standby1.port=9309
worker.standby1.host=localhost
worker.standby1.type=ajp13
worker.standby1.lbfactor=1


worker.standby2.port=19309
worker.standby2.host=localhost
worker.standby2.type=ajp13
worker.standby2.lbfactor=1

worker.loadbalancer.type=lb
worker.loadbalancer.balanced_workers=standby1,standby2          


nfs설정

mount명령어
mount -t nfs 192.168.0.86:/usr/local/skycom/bin/ment /usr/local/nfs_mount_list/mount/rbt_mount

rsync설정

rpm -qa|grep rsync

vi /etc/rsyncd.conf 설정

	log file = /var/log/rsyncd.log
	#transfer logging = yes
	syslog facility = local3
	log format = %t %a %m %f %b

	[record_sync]
	path = /usr/local/skycom/var/record/SpxFiles/Server1/
	comment = record
	uid = root
	gid = root
	use chroot = yes
	read only = no
	write only = no
	hosts allow = 1.1.1.2
	max connections = 3
	timeout = 600

	[audio_sync]
	path = /usr/local/skycom/var/AudioRtp/
	comment = audio
	uid = root
	gid = root
	use chroot = yes
	read only = no
	write only = no
	hosts allow = 1.1.1.2
	max connections = 3
	timeout = 600
[server]
rsync -avz 218.50.52.220::record_sync /home/lets/BANKTOPIA_APP/war/upload/dp
/etc/init.d/xinetd 등록되있으므로 재시작
로그확인
tail -f /var/log/secure
cd /fkies/rsync_script/log/..


[리눅스 와 윈도우 공유시 cifs mount]
mount -t cifs //211.206.122.59/PURMEE_SHARE(윈도우경로) /home/lets/PURMEE_SHARE -o user-o username=test -o password=1234 -o iocharset=cp949

[virtual host 설정]

http://kkoseul.tistory.com/145

[apache 웹서버 로그관리]
http://v.daum.net/link/32779627

[무료 ssl 인증서 ]
http://v.daum.net/link/33212498

[톰켓 로그 설정]
http://linuxism.tistory.com/519
[cronolog 설치]
1. wget http://cronolog.org/download/cronolog-1.6.2.tar.gz
2. tar xvfz cronolog-1.6.2.tar.gz
3. cd cronolog-1.6.2
4. ./configure --prefix=/usr/local/
5. make;make install
6. vi /usr/local/tomcat/bin/catalina.sh
#  org.apache.catalina.startup.Bootstrap "$@" start \  #된 내용찾아서 수정
#  >> "$CATALINA_BASE"/logs/catalina.out 2>&1 &
/usr/local/sbin/cronolog

org.apache.catalina.startup.Bootstrap "$@" start 2>&1 \
|/usr/local/sbin/cronolog /home/weblog/tomcat/futsal/%Y%m/catalina.out.%Y%m%d &
|/usr/local/sbin/cronolog /app/weblog/apache/%Y%m/catalina.out.%Y%m%d &
CustomLog "|/usr/local/sbin/cronolog /app/weblog/apache/%Y%m/access_log.%Y%m%d" common 
 CustomLog "|/usr/local/sbin/cronolog /home/weblog/apache/access_log.%Y_%m_%d" combined

CATALINA_OPTS="$CATALINA_OPTS $JPDA_OPTS" -server -XX:PermSize=256m -XX:MaxPermSize=768m -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+PrintHeapAtGC -XX:+UseParallelGC

[로그레벨관련]
http://yaku.tistory.com/135

[apache access_log 너무 클경우]
1. httpd.conf 에 CustomLog "logs/access_log" common 주석하고
CustomLog "|/usr/local/cronolog/sbin/cronolog /home/weblog/apache/access_log.%Y_%m_%d" combined 추가
[mod_jk]mod_jk.conf
JkLogFile "|/usr/local/cronolog/sbin/cronolog /home/weblog/apache/mod_jk/mod_jk.%Y_%m_%d"

JkLogFile "|/usr/local/cronolog/sbin/cronolog /home/weblog/apache/mod_jk/%y%m/mod_jk.%Y_%m_%d"
CustomLog "|/usr/local/cronolog/sbin/cronolog /home/weblog/apache/access/%y%m/mod_jk.%Y_%m_%d"



[이플 & 렛츠]
  org.apache.catalina.startup.Bootstrap "$@" start 2>&1 \
     | /usr/local/sbin/cronolog /home/weblog/tomcat/catalina.out.%Y%m%d &

CustomLog "|/usr/local/sbin/cronolog /home/weblog/apache/access_log.%Y_%m_%d" combined 

#!/bin/bash

EMSLOG=/usr/local/emsmq/emsif/logs
ls $EMSLOG/*`date --date '10 days ago' '+%Y-%m-%d'`* | xargs rm
~
export JAVA_OPTS="-Xms1024m -Xmx2048m"
scenarioTypeList.add(new OptionList("1", "Default"));
scenarioTypeList.add(new OptionList("0", "Scenario"));

tomcat 메모리설정
-XX:MaxPermSize=512m
-Xms128m
-Xmx128m

eclipse 

-vmargs
-Dosgi.requiredJavaVersion=1.7
-Xverify:none
-XX:+UseParallelGC
-XX:-UseConcMarkSweepGC
-XX:+AggiressiveOpts
-XX:PermSize=256M
-XX:MaxPermSize=256M
-XX:MaxNewSize=256M
-XX:NewSize=256M
-Xms512m
-Xmx512m

http://192.168.0.210:8000/GetUser.action?from_server=2&prg_status=ADD&uc_flag=1&e164=09030000003&id=09030000003&passwd=oqz75024&realm=&cid=07078832200&forward_type=0&forward_e164=&limit_call_time=3600&pickup_group=100000000001&policy_group=100000000001&multi_call=1&enable_record=0&enable_prepay=0&enable_caller_id_hidden=0&enable_caller_id_display=0&enable_vms=0&enable_extension=1&enable_local=1&enable_mobile=1&enable_long_distance=1&enable_international=0&permission=1&enable_rbt=0&enable_announce=0&enable_multi_register=0&enable_multi_call=0&class_of_user=0&ext=1001&enable_private_network=0&enable_media_relay=0&hashdata=-263f313cf9df31c99712edf4db47a07c


http://192.168.0.210:8000/GetUser.action
?from_server=2
&prg_status=ADD
&uc_flag=1&e164=09030000003
&id=09030000003
&passwd=oqz75024
&realm=
&cid=07078832200
&forward_type=0
&forward_e164=
&limit_call_time=3600
&pickup_group=100000000001
&policy_group=100000000001
&multi_call=1
&enable_record=0
&enable_prepay=0
&enable_caller_id_hidden=0
&enable_caller_id_display=0
&enable_vms=0
&enable_extension=1
&enable_local=1
&enable_mobile=1
&enable_long_distance=1
&enable_international=0
&permission=1
&enable_rbt=0
&enable_announce=0
&enable_multi_register=0
&enable_multi_call=0
&class_of_user=0
&ext=1001
&enable_private_network=0
&enable_media_relay=0
&hashdata=ef2c1e98b4f56715c190f3cd6a38a659=



start element    : PACKET
characters_MessageEvent : 
start element    : FUNCTION
-->RESPONSE
characters_MessageEvent : 
end element : FUNCTION
end element : PACKET
getMqlist.size()():1
--ping-->OK
[14:15:08]  INFO [http-8000-5] -from_server-->2
[14:15:08]  INFO [http-8000-5] -hashdata-->ef2c1e98b4f56715c190f3cd6a38a659=
[14:15:08]  INFO [http-8000-5] -e164-->09030000003
[14:15:08]  INFO [http-8000-5] -id-->09030000003
[14:15:08]  INFO [http-8000-5] -prg_status-->ADD
[14:15:08]  INFO [http-8000-5] -current_page-->USER
[14:15:08]  INFO [http-8000-5] -rec_stime-->null
[14:15:08]  INFO [http-8000-5] -rec_etime-->null
[14:15:08]  INFO [http-8000-5] -apply_now-->null
[14:15:08]  INFO [http-8000-5] -enable_media_relay-->0
[14:15:08]  INFO [http-8000-5] -===========================================================
[14:15:08]  INFO [http-8000-5] -[time:2012-11-06 14:15:08.330][address:192.168.255.147]
[14:15:08]  INFO [http-8000-5] -[mode:0]
[14:15:08]  INFO [http-8000-5] -[CRUDS:ADD]
[14:15:08]  INFO [http-8000-5] -===========================================================
[14:15:08]  INFO [http-8000-5] -token:2:09030000003:09030000003:ADD:skyproxy!@#$1234
[14:15:08]  INFO [http-8000-5] -263f313cf9df31c99712edf4db47a07c
[14:15:08]  INFO [http-8000-5] -=======returnMsg=========
[14:15:08]  INFO [http-8000-5] -login fail
[14:15:08]  INFO [http-8000-5] -=======returnMsg=========
[14:15:08]  INFO [http-8000-5] -===========================================================
[14:15:08]  INFO [http-8000-5] -[end_t:2012-11-06 14:15:08.330][address:192.168.255.147]
[14:15:08]  INFO [http-8000-5] -===========================================================


http://192.168.255.150/playSoundFileAjax.action?filedirectory=20121030174854277


/usr/local/skycom/var/record
/audio/20121110/773955-07077771000-18-0-700-700-0-20121110151131-20121110151148-OT4UlivEg0.wav
path.upload_file=/usr/local/skycom/var
path.convert_file=/record/SpxFiles
path.play_file=/record/wavFiles

  
-----
path.upload_file=/usr/local/nfs_mount_list
path.convert_file=/mount/record_mount
path.play_file=/mount/record_wav

<?xml version="1.0" encoding="UTF-8"?>
<Context path="/mount" docBase="/usr/local/nfs_mount_list/mount" debug="0" reloadable="true" />



<?xml version="1.0" encoding="UTF-8"?>
<Context path="/record" docBase="/usr/local/skycom/var/record" debug="0" reloadable="true" />
/usr/local/skycom/var/record/audio/20121110/773955-07077771000-18-0-700-700-0-20121110151131-20121110151148-OT4UlivEg0.wav



박정우(싸이 스타일~) 님의 말 :
야
서버에 동영상 파일이 /yd/yd.avi 
이경로에 올라가잇으면
www.tmap.co.kr/yd/yd.avi  이렇게 하면 

안전하게 링크 열기
다운이되잔아
그거 어떤식으로 막냐 니내는
url로 동영상 주소로 접근하면
모르면 좀 알아바바
김동근(~) 님의 말 :
서버 url이랑
박정우(싸이 스타일~) 님의 말 :
ㅇㅇ
김동근(~) 님의 말 :
서버의 물리적 위치랑은 전혀 상관 없는데
박정우(싸이 스타일~) 님의 말 :
url암호화 말구
니내 그러면 스트림으로 읽어서 쏴주냐
김동근(~) 님의 말 :
아하 너가말한거는
www.tmap.co.kr/yd/yd.avi  경로에 동영상이 있다는거지
박정우(싸이 스타일~) 님의 말 :
ㅇㅇ
김동근(~) 님의 말 :
근데 그걸 왜 막아?
박정우(싸이 스타일~) 님의 말 :
니내 호핀 url에서 접근해서 다운받으면안되잔아
호핀에 잇는동영상같은거
김동근(~) 님의 말 :
일단 그렇다쳐
박정우(싸이 스타일~) 님의 말 :
어떤식으로 막냐구 니내는
김동근(~) 님의 말 :
여러가지 있겠지만
가라 URL떤져주구
서버에서 검증한다음 스트림으로 내리겠지
박정우(싸이 스타일~) 님의 말 :
그거말구
다른거
니내가 쓰는건 어떤식이여
김동근(~) 님의 말 :
난 동영상 플레이어구
호핀 스트리밍 서버는 딴회사야
박정우(싸이 스타일~) 님의 말 :
다알아야지
개발자가
존나 빠졋내
앞단 뒷단 다 알아야지
김동근(~) 님의 말 :
그게 그놈들 솔루션인데 
일단
박정우(싸이 스타일~) 님의 말 :
ㅋㅋㅋ
김동근(~) 님의 말 :
플레이어는
TA라는 인증서버한테 요청하면
 
 지인을 사칭하거나 급박한 상황을 빙자한 금전 피해사례가 빈번하게 발생되고 있으니, 금전 요구시 전화로 반드시 대화 상대를 확인하십시오.신고하기 본인인증 요청
 
박정우(싸이 스타일~) 님의 말 :
ㅇㅇ
김동근(~) 님의 말 :
세션이 생겨서
박정우(싸이 스타일~) 님의 말 :
옹 게속말해바
김동근(~) 님의 말 :
그 세션으로 주기적으로 리포팅해
글구 스트리밍서버에 동영상 요청할때
세션 정보가 헤더에 같이 들어가고
박정우(싸이 스타일~) 님의 말 :
ㅇㅇ
김동근(~) 님의 말 :
그 헤더가 없음 스트리밍 서버에서 안내려줄꺼야
박정우(싸이 스타일~) 님의 말 :
음
김동근(~) 님의 말 :
대충 글애
박정우(싸이 스타일~) 님의 말 :
그냐


-XX:MaxPermSize=512m
-Xms128m
-Xmx128m

record

파일다운 /usr/local/nfs_mount_list/mount/record_mount/Server1/20120913
듣기 /usr/local/nfs_mount_list/mount/record_wav/yyyymmdd

spx파일 /usr/local/skycom/var/record/SpxFiles/Server1/20120913


<?xml version="1.0" encoding="UTF-8"?>
<Context path="/mount" docBase="/usr/local/nfs_mount_list/mount" debug="0" reloadable="true" />

new  path
/usr/local/skycom/var/record/audio/20121108/721018-241-11-0-242-242-0-20121108154705-20121108154716.wav


path.upload_file=/usr/local/nfs_mount_list
path.convert_file=/mount/record_mount
path.play_file=/mount/record_wav

다중톰켓 

http://www.commit.co.kr/65?category=0






futsal

ssh 210.121.190.12
tmzkdlzjatjqj)!@(스카이컴서버)!@)


<Host name="futsal.or.kr"  appBase="/home/tomcat/unit"   FutsalUnite
    unpackWARs="true" autoDeploy="true"
    xmlValidation="false" xmlNamespaceAware="false">
  <Context path="" docBase="FutsalUnite" debug="0" privileged="true" reloadable="true" />
<Alias>www.futsal.or.kr</Alias>
</Host>


<Host name="k-futsal.or.kr"  appBase="/home/tomcat/skycom"   FutsalLeague
    unpackWARs="true" autoDeploy="true"
    xmlValidation="false" xmlNamespaceAware="false">
<Context path="" docBase="FutsalLeague" debug="0" privileged="true" reloadable="true" />
  <Alias>www.k-futsal.or.kr</Alias>
</Host>


<Host name="koreasoccer.or.kr"  appBase="/home/tomcat/koreasoccer"
    unpackWARs="true" autoDeploy="true"
    xmlValidation="false" xmlNamespaceAware="false">
  <Alias>www.koreasoccer.or.kr</Alias>
</Host>


workers.tomcat_home="/home/tomcat/"
workers.java_home="/usr/java/jdk"
ps=/
worker.list=ajp13, ks
worker.ajp13.port=8009
worker.ajp13.host=210.121.190.12
worker.ajp13.type=ajp13
worker.ks.port=8019
worker.ks.host=210.121.190.12
worker.ks.type=ajp13



<Directory "/home/tomcat/skycom">
Options FollowSymLinks
    AllowOverride None
    Order deny,allow
    Deny from all
</Directory>


<Directory "/home/tomcat/unit">
Options FollowSymLinks
    AllowOverride None
    Order deny,allow
    Deny from all
</Directory>



<VirtualHost *:80>
    ServerAdmin mugdo@skycom.ne.kr
    DocumentRoot "/home/tomcat/skycom"
    ServerName www.k-futsal.or.kr
    ErrorLog "logs/k-futsal.or.kr-error.log"
    CustomLog "logs/k-futsal.or.kr-access.log" common
        <Directory "/home/tomcat/skycom">
            Order allow,deny
            Allow from all
            Options FollowSymLinks
            AllowOverride None
            Order deny,allow
            Allow from all
        </Directory>
        JkMount /* ajp13
</VirtualHost>

<VirtualHost *:80>
    ServerAdmin mugdo@skycom.ne.kr
    DocumentRoot "/home/tomcat/unit"
    ServerName www.futsal.or.kr
    ErrorLog "logs/futsal.or.kr-error.log"
    CustomLog "logs/futsal.or.kr-access.log" common
        <Directory "/home/tomcat/unit">
            Order allow,deny
            Allow from all
            Options FollowSymLinks
            AllowOverride None
            Order deny,allow
            Allow from all
        </Directory>
        JkMount /* ajp13
</VirtualHost>


심각: Servlet.service() for servlet default threw exception
java.lang.NumberFormatException: For input string: "ydjmmasx"

    at java.lang.NumberFormatException.forInputString(NumberFormatException.java:48)
    at java.lang.Integer.parseInt(Integer.java:449)
    at java.lang.Integer.parseInt(Integer.java:499)
    at skycom.news.NewsAction.view(NewsAction.java:152)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at com.opensymphony.xwork2.DefaultActionInvocation.invokeAction(DefaultActionInvocation.java:404)
    at com.opensymphony.xwork2.DefaultActionInvocation.invokeActionOnly(DefaultActionInvocation.java:267)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:229)
    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:184)
    at com.opensymphony.xwork2.interceptor.Metho







[root@airlink tomcat]# grep -n java.lang.NumberFormatException: *
catalina.out.20120607:50775:java.lang.NumberFormatException: For input string: "nimicfjnvnj"
catalina.out.20120607:100862:java.lang.NumberFormatException: For input string: "nimicfjnvnj"
catalina.out.20120608:10229:java.lang.NumberFormatException: For input string: "nimicfjnvnj"
catalina.out.20120608:39676:java.lang.NumberFormatException: For input string: "nimicfjnvnj"
catalina.out.20120608:95632:java.lang.NumberFormatException: For input string: "vtecfovtvynkxlmw"
catalina.out.20120609:11425:java.lang.NumberFormatException: For input string: "vtecfovtvynkxlmw"
catalina.out.20120609:29862:java.lang.NumberFormatException: For input string: "vtecfovtvynkxlmw"
catalina.out.20120609:60468:java.lang.NumberFormatException: For input string: "vtecfovtvynkxlmw"
catalina.out.20120610:1280:java.lang.NumberFormatException: For input string: "vtecfovtvynkxlmw"
catalina.out.20120610:42416:java.lang.NumberFormatException: For input string: "vblkinptgavp"
catalina.out.20120610:71588:java.lang.NumberFormatException: For input string: "vblkinptgavp"
catalina.out.20120611:8183:java.lang.NumberFormatException: For input string: "vblkinptgavp"
catalina.out.20120611:16644:java.lang.NumberFormatException: For input string: "vblkinptgavp"
catalina.out.20120611:150552:java.lang.NumberFormatException: For input string: "uxsxwpnbyizibbrd"
catalina.out.20120612:30286:java.lang.NumberFormatException: For input string: "uxsxwpnbyizibbrd"
catalina.out.20120612:48376:java.lang.NumberFormatException: For input string: "uxsxwpnbyizibbrd"
catalina.out.20120612:97948:java.lang.NumberFormatException: For input string: "uxsxwpnbyizibbrd"
catalina.out.20120613:93348:java.lang.NumberFormatException: For input string: "azrgjlqweqsp"
catalina.out.20120614:15020:java.lang.NumberFormatException: For input string: "azrgjlqweqsp"
catalina.out.20120614:27203:java.lang.NumberFormatException: For input string: "azrgjlqweqsp"
catalina.out.20120614:58559:java.lang.NumberFormatException: For input string: "azrgjlqweqsp"
catalina.out.20120708:62529:java.lang.NumberFormatException: For input string: "340 이브리드의 게시판"
catalina.out.20120805:91518:java.lang.NumberFormatException: null
catalina.out.20121013:48993:java.lang.NumberFormatException: For input string: "dqeiklmtmapmhbi"
catalina.out.20121014:11317:java.lang.NumberFormatException: For input string: "dqeiklmtmapmhbi"
catalina.out.20121014:16591:java.lang.NumberFormatException: For input string: "amsshepiejospz"
catalina.out.20121014:19073:java.lang.NumberFormatException: For input string: "dqeiklmtmapmhbi"
catalina.out.20121014:26273:java.lang.NumberFormatException: For input string: "amsshepiejospz"
catalina.out.20121014:28294:java.lang.NumberFormatException: For input string: "dqeiklmtmapmhbi"
catalina.out.20121014:46244:java.lang.NumberFormatException: For input string: "dqeiklmtmapmhbi"
catalina.out.20121014:46292:java.lang.NumberFormatException: For input string: "amsshepiejospz"
catalina.out.20121015:10690:java.lang.NumberFormatException: For input string: "amsshepiejospz"
catalina.out.20121015:11893:java.lang.NumberFormatException: For input string: "amsshepiejospz"
catalina.out.20121024:93148:java.lang.NumberFormatException: For input string: "obcxfraptak"
catalina.out.20121025:6384:java.lang.NumberFormatException: For input string: "obcxfraptak"
catalina.out.20121025:15269:java.lang.NumberFormatException: For input string: "obcxfraptak"
catalina.out.20121025:36952:java.lang.NumberFormatException: For input string: "zxkmzgojgcdarhlc"
catalina.out.20121025:47256:java.lang.NumberFormatException: For input string: "obcxfraptak"
catalina.out.20121025:92946:java.lang.NumberFormatException: For input string: "zxkmzgojgcdarhlc"
catalina.out.20121026:8730:java.lang.NumberFormatException: For input string: "zxkmzgojgcdarhlc"
catalina.out.20121026:18791:java.lang.NumberFormatException: For input string: "zxkmzgojgcdarhlc"
catalina.out.20121026:30792:java.lang.NumberFormatException: For input string: "gdmajovfecfnhh"
catalina.out.20121026:81588:java.lang.NumberFormatException: For input string: "gdmajovfecfnhh"
catalina.out.20121027:3001:java.lang.NumberFormatException: For input string: "gdmajovfecfnhh"
catalina.out.20121027:18510:java.lang.NumberFormatException: For input string: "gdmajovfecfnhh"
catalina.out.20121028:43671:java.lang.NumberFormatException: For input string: "sfrqencswgs"
catalina.out.20121029:7781:java.lang.NumberFormatException: For input string: "sfrqencswgs"
catalina.out.20121029:18782:java.lang.NumberFormatException: For input string: "sfrqencswgs"
catalina.out.20121029:43471:java.lang.NumberFormatException: For input string: "sfrqencswgs"
catalina.out.20121029:87806:java.lang.NumberFormatException: For input string: "sfrqencswgs"
catalina.out.20121031:5791:java.lang.NumberFormatException: For input string: "uaoezudursa"
catalina.out.20121031:38000:java.lang.NumberFormatException: For input string: "uaoezudursa"
catalina.out.20121031:77036:java.lang.NumberFormatException: For input string: "uaoezudursa"
catalina.out.20121101:998:java.lang.NumberFormatException: For input string: "uaoezudursa"
catalina.out.20121101:2621:java.lang.NumberFormatException: For input string: "uetpueyurrrccnxd"
catalina.out.20121101:10109:java.lang.NumberFormatException: For input string: "uetpueyurrrccnxd"
catalina.out.20121101:41867:java.lang.NumberFormatException: For input string: "uetpueyurrrccnxd"
catalina.out.20121101:42275:java.lang.NumberFormatException: For input string: "uetpueyurrrccnxd"
catalina.out.20121101:63991:java.lang.NumberFormatException: For input string: "uetpueyurrrccnxd"
catalina.out.20121102:18176:java.lang.NumberFormatException: For input string: "uetpueyurrrccnxd"
catalina.out.20121102:25476:java.lang.NumberFormatException: For input string: "qvieyitnnzd"
catalina.out.20121102:60165:java.lang.NumberFormatException: For input string: "qvieyitnnzd"
catalina.out.20121102:86748:java.lang.NumberFormatException: For input string: "qvieyitnnzd"
catalina.out.20121103:14234:java.lang.NumberFormatException: For input string: "qvieyitnnzd"
catalina.out.20121103:16517:java.lang.NumberFormatException: For input string: "cyiwqrxpeldbrku"
catalina.out.20121103:22697:java.lang.NumberFormatException: For input string: "qvieyitnnzd"
catalina.out.20121103:38483:java.lang.NumberFormatException: For input string: "cyiwqrxpeldbrku"
catalina.out.20121103:52964:java.lang.NumberFormatException: For input string: "cyiwqrxpeldbrku"
catalina.out.20121104:1925:java.lang.NumberFormatException: For input string: "cyiwqrxpeldbrku"
catalina.out.20121104:7942:java.lang.NumberFormatException: For input string: "cyiwqrxpeldbrku"
catalina.out.20121104:36253:java.lang.NumberFormatException: For input string: "zdojheceygmxuck"
catalina.out.20121105:36704:java.lang.NumberFormatException: For input string: "zdojheceygmxuck"
catalina.out.20121105:84556:java.lang.NumberFormatException: For input string: "zdojheceygmxuck"
catalina.out.20121108:7412:java.lang.NumberFormatException: For input string: "ydjmmasx"
catalina.out.20121108:7865:java.lang.NumberFormatException: For input string: "ydjmmasx"
catalina.out.20121108:39743:java.lang.NumberFormatException: For input string: "ydjmmasx"
catalina.out.20121108:58214:java.lang.NumberFormatException: For input string: "ydjmmasx"
catalina.out.20121109:21486:java.lang.NumberFormatException: For input string: "ydjmmasx"




srcFile:/misc/Record/SpxFiles/Server1/20121109/67264239-07076882167-01042436254-20121109122801-20121109123246-1.spx
destFile:/usr/local/nfs_mount_list/mount/record_wav/67264239-07076882167-01042436254-20121109122801-20121109123246-1.wav
filename:67264239-07076882167-01042436254-20121109122801-20121109123246-1.spx
[wave file  already exist]
filedirectory:/mount/record_wav/67264239-07076882167-01042436254-20121109122801-20121109123246-1.wav

본사



#/usr/local/skycom/var/record 211.38.95.165/255.255.255.0(rw,no_root_squash)
#/usr/local/skycom/var/record 211.38.95.166/255.255.255.0(rw,no_root_squash)
#/usr/local/skycom/var/record 211.38.95.168/255.255.255.0(rw,no_root_squash)
/usr/local/skycom/var/record 192.168.0.165/255.255.255.0(rw,no_root_squash)
/usr/local/skycom/var/record 192.168.0.166/255.255.255.0(rw,no_root_squash)
/usr/local/skycom/var/record 192.168.0.168/255.255.255.0(rw,no_root_squash)



srcFile:/misc/Record/SpxFiles/Server1/20121112/67695891-07076884068-01090303085-20121112103217-20121112103250-1.spx
destFile:/usr/local/nfs_mount_list/mount/record_wav/67695891-07076884068-01090303085-20121112103217-20121112103250-1.wav
filename:67695891-07076884068-01090303085-20121112103217-20121112103250-1.spx
Java Speex Command Line Decoder v0.9.7 ($Revision: 1.5 $)
using Java Speex Decoder v0.9.7 ($Revision: 1.5 $)
Copyright (C) 2002-2004 Wimba S.A.
[spx convert!]
filedirectory:/mount/record_wav/67695891-07076884068-01090303085-20121112103217-20121112103250-1.wav
prop_filename:/usr/local/tomcat/webapps/ws_skypbx/WEB-INF/prop/record.properties


srcFile:/misc/Record/SpxFiles/Server1/20121113/68508755-07076883500-01030032027-20121113164404-20121113165136-1.spx
destFile:/usr/local/nfs_mount_list/mount/record_wav/68508755-07076883500-01030032027-20121113164404-20121113165136-1.wav
filename:68508755-07076883500-01030032027-20121113164404-20121113165136-1.spx
[wave file  already exist]
filedirectory:/mount/record_wav/68508755-07076883500-01030032027-20121113164404-20121113165136-1.wav




path.upload_file=/usr/local/skycom/var
path.convert_file=/record/SpxFiles
path.play_file=/record/waveFiles


[maven 설정]


mvn archetype:create -DgroupId=tutorial -DartifactId=tutorial -DarchetypeGroupId=org.apache.struts -DarchetypeArtifactId=struts2-archetype-starter -DarchetypeVersion=2.0.5-SNAPSHOT -DremoteRepositories=http://people.apache.org/repo/m2-snapshot-repository

1. http://maven.apache.org/download.html  다운
2. MAVEN_HOME 잡아준다
3. mvn -v
4. eclipse - help - market - maven 검색해서 wtp 다운

[svn tomcat 자동배포]
http://stove99.tistory.com/30


[환경]
http://blog.naver.com/ez_/140157300770

[네트워크 모니터링 cacti]
http://jekyung.com/index.php/archives/67

[lets file_play]
<%@ page contentType = "text/html;charset=UTF-8" %><%@ taglib prefix="s" uri="/struts-tags" %>
<%@ page import="java.io.File" %>
<%@ page import="java.io.FileInputStream" %>
<%@ page import="java.io.FileOutputStream" %>
<html>
<head>
<title>WAVE Play</title>
</head>
<body>
<%
  String baseFileName = String.valueOf(request.getAttribute("filedirectory"));
  String srcFilePath = "/usr/local/nfs_mount_list" + baseFileName;
  String outFilePath = "/usr/local/tomcat3/webapps/SKYREC" + baseFileName;
  File srcFile = new File(srcFilePath);
  FileInputStream fin = new FileInputStream(srcFile);
  FileOutputStream fout = new FileOutputStream(outFilePath);
  int bytesRead = 0;
  byte[] buffer = new byte[1024];
  while((bytesRead = fin.read(buffer, 0, 1024)) != -1){
    fout.write(buffer, 0, bytesRead);
  }
  fin.close();
  fout.close();
%>
<embed src="http://211.38.95.168:8090/SKYREC<s:property value='filedirectory'/>"
width="300" height="100"
autostart = true
volume = 50
balance = 0
loop = false
showtracker = true
showcontrols = true
showaudiocontrols = true
showpositioncontrols = false
showstatusbar = true
></EMBED>
</body>
</html>


lets_skyrec

lk/1864


[proxy]
<embed src="/ws_skypbx/rest/record/get_record?filedirectory=<s:property value='filedirectory'/>"


srcFile:/misc/Record/SpxFiles/Server1/20121114/68592164-01021159299-07076883891-20121114085410-20121114085535-2.spx
srcFile:/misc/Record/SpxFiles/Server1/20121114/68592164-01021159299-07076883891-20121114085410-20121114085535-2.spx
destFile:/misc/Record/wavFiles/20121114/68592164-01021159299-07076883891-20121114085410-20121114085535-2.wav
filename:68592164-01021159299-07076883891-20121114085410-20121114085535-2.spx

Action=skycom.pbx.record.RecordAction@1551190, ProxyMenu=[skycom.pbx.menu.MenuDTO@1eac7f3, skycom.pbx.menu.MenuDTO@ed279b, skycom.pbx.menu.MenuDTO@1c33bd8, skycom.pbx.menu.MenuDTO@8e11ff, skycom.pbx.menu.MenuDTO@13f9b68]}
[11:27:08]  INFO [TP-Processor114] -menu_auth:33554432
filedirectory:0e967ab20b303bd7669aa5cd1876d1669125f11961ab80c5bb9a450d47df74bab66a684ff00bc9d96ecdccf90ba09ea8b591bd4b45741447019ea12812524f3ce705e0dd699a5ebeb2d6a841bff67ce2d4976de11103cf13fc30b09c61ec4162ab48893d2f964c17fe029cb53e976a3d19081a63e92e8e1f9a4f719cbc89c245e2a32a115e0fe75b6e0a376e336a98344be3dc5fbb7418c22c0a792a2e2490602747da6fa5bb0879304c77cc75cb89070c26576e8b37c8e2b8917d2d617ab9f64db46d7e925bad17
getRecord
prop_filename:/usr/local/tomcat/webapps/ws_skypbx/WEB-INF/prop/record.properties
Nov 14, 2012 11:27:08 AM org.apache.jk.common.ChannelSocket processConnection
WARNING: processCallbacks status 2
getRecord
prop_filename:/usr/local/tomcat/webapps/ws_skypbx/WEB-INF/prop/record.properties
Nov 14, 2012 11:27:08 AM org.apache.jk.common.ChannelSocket processConnection
WARNING: processCallbacks status 2
getRecord
prop_filename:/usr/local/tomcat/webapps/ws_skypbx/WEB-INF/prop/record.properties
Nov 14, 2012 11:27:08 AM org.apache.jk.common.ChannelSocket processConnection
WARNING: processCallbacks status 2
getRecord
prop_filename:/usr/local/tomcat/webapps/ws_skypbx/WEB-INF/prop/record.properties



  SDP_CODEC_PCMU = 0, // G.711 mu-law
  SDP_CODEC_PCMA = 8, // G.711 a-law
  SDP_CODEC_G729 = 18, // G.729, with or without Annexes A or B

[sessioncluster]

http://bongbong.net/entry/Apache-Tomcat-%EB%A1%9C%EB%93%9C-%EB%B0%B8%EB%9F%B0%EC%8B%B1-%EC%84%B8%EC%85%98-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0%EB%A7%81

[리눅스버전확인]
/cat/etc/*-release
[git설치및설정]
http://devday.tistory.com/2449
1.rpm -Uvh http://repo.webtatic.com/yum/centos/5/latest.rpm
2.yum install --enablerepo=webtatic git-all
git 사용법
http://k502000.blog.me/30127800031
http://ivivaldi.blog.me/120142257498

cd /root/.git/


[cvs 설정]
http://blog.naver.com/despair35?Redirect=Log&logNo=50135352958

http://blog.naver.com/coollapop?Redirect=Log&logNo=80069846610
1. cvs 는 기본적으로 설치되어있음 
2. cvs -v 버전확인
3. mkdir /home/cvs
4. cvs -d /home/cvs init //cvs 초기화
5. adduser cvs / useradd cvs
6 passwd cvs
7. chown root:cvs /home/cvs -R
8. chmod 770 /home/cvs -R
9. cd /home/cvs/CVSROOT
10. vi passwd
11. htpasswd -nb id passwd   (ex)htpasswd -nb pjw 1111
12 pjw:#$@@#$@!@# 를 vi /home/cvs/CVSROOT/passwd 에 추가 pjw:#$@@#$@!@#:cvs
13. 
	vi /etc/sysconfig/iptables
	# -A INPUT -m state --state NEW -m tcp -p tcp --dport 2401 -j ACCEPT
	# /etc/init.d/iptables restart
	(	9. 외부접속안될시 iptable 설정 
		>iptables -I INPUT -p tcp --dport 8080 -j ACCEPT
		>iptables -A INPUT -m state --state NEW -m tcp -p tcp --dport 2401 -j ACCEPT
		>/etc/rc.d/init.d/iptables save
		>/etc/rc.d/init.d/iptables restart
	)
14.
	vi /etc/xinetd.d/cvspserver
	service cvspserver
	{
	disable = no
	flags = REUSE
	port = 2401
	socket_type = stream
	protocol = tcp
	wait = no
	user = cvs
	server = /usr/bin/cvs
	server_args = --allow-root=/home/cvs pserver
	log_on_failure += USERID
	}

	 service cvspserver
		 {
		 disable = no
		 flags = REUSE
		 port = 2401
		 socket_type = stream
		 protocol = tcp
		 wait = no
		 user = cvs
		 server = /usr/bin/cvs
		 server_args = --allow-root=/home/cvs pserver
		 log_on_failure += USERID
		 }
service xinetd restart
15. cvs -d:pserver:사용자@localhost:/home/cvs login
16. cvs -d:pserver:pjw@localhost:/home/cvs checkout JAVA_TEST
17 cvs 간단하게 로그인하기 체크아웃
	#vi /etc/profile
	#export CVSROOT=:pserver:pjw@localhost:2041/home/cvs 추가
	http://blog.naver.com/ohpowel?Redirect=Log&logNo=80025670875
	cvs -d:pserver:z7454230@localhost:2401/media/dev/cvs login
	#source /etc/profil

[포트번호]
svn : 3690
cvs : 2401

CVS Linux Setting 


RPM 으로 CVS를 설치 후 , 셋팅

mkdir /home/CVS

cvs -d /home/CVS init - Repository 초기화(즉, CVSROOT란 디렉토리와 CVS 에서 기본적으로 쓰는 파일들이 생긴다)

groupadd cvs

vi /etc/group


내용중 cvs:*:510:flazma,pizza 그룹 구성원 추가


그러면 inetd로 CVS 접속을 허용하는 방법을 알아보자. 우선 CVS가 사용하는 포트 번호(2401번)를 등록해야 한다. /etc/services에 다음과 같은 줄이 있는지 살펴 보자.
cvspserver      2401/tcp 

만일 없다면 위의 내용을 추가하면 된다. 다음은 실제로 해당 포트를 열어줄 차례인데, 이는 씨스템이 inetd를 쓰고 있는지, xinetd를 쓰고 있는지에 따라 설정 방법이 다르다. 먼저 inetd의 경우는 /etc/inetd.conf에 다음 내용을 추가한다.
cvspserver stream tcp nowait root /usr/bin/cvs cvs 
   --allow-root=/home/cvs pserver 

편의상 두 줄로 나타냈으나, 실제 파일에는 한 줄로 들어가야 한다. 만약 tcpd를 사용한다면 위의 줄 대신 다음을 추가한다.
cvspserver stream tcp nowait root /usr/sbin/tcpd /usr/bin/cvs 
   --allow-root=/home/cvs pserver 

물론 /usr/bin/cvs나 /usr/sbin/tcpd는 실제로 이들 명령이 위치하는 절대 경로로 써 주어야 한다.

새로운 설정 내용을 반영하려면 inetd를 재시작하여야 한다. inetd의 프로세스 ID가 357이라면 다음과 같이 HUP 신호를 보내면 된다.
# kill -HUP 357 

xinetd를 쓴다면 /etc/xinetd.d에 cvspserver란 이름으로 별도의 파일을 만들어야 한다. 파일 내용은 다음과 같다.
# default: on 
# description: The cvspsever serves CVS Passowrd Server sessions; it uses  
#          unencrypted username/password pairs for authentication. 
service cvspserver 
{ 
        disable         = no
        flags           = REUSE 
        socket_type     = stream 
        wait            = no
        protocol             = tcp
        user            = root 
        server          = /usr/bin/cvs 
        server_args     = -f --allow-root=/home/CVS pserver 
        log_on_failure  += USERID 
} 

inetd의 경우와 마찬가지로 /usr/bin/cvs는 cvs 명령의 절대 경로, /home/CVS는 저장소의 위치로 바꿔 준다.

xinetd를 재시작하는 방법도 inetd와 동일하다. 우선 xinetd의 프로세스 ID(357이라 가정한다)를 알아낸 후, HUP 신호를 보내자.
# kill -HUP 357 
 

이제 접속 포트는 열어두었으니, 개발자들에게 CVS 계정을 발급하는 일만 남았다. 암호 인증 방식을 이용하는 경우, 계정과 암호는 저장소의 CVSROOT 디렉토리 밑에 passwd란 이름의 파일에 저장된다. 여기에서는 /home/CVS/CVSROOT/passwd가 될 것이다. 하지만 이 파일은 처음에는 존재하지 않는다. 그러므로 직접 만들어주어야 하는데, 먼저 예를 하나 보도록 하자.
flazma:YxNPCzaM/WCp2:cvs 
pizza:Yw2najHG5cLfo:cvs 

각 줄은 한 사용자에 대한 정보를 담고 있다. 줄은 ':'을 경계로 다시 세 부분으로 나뉘는데 첫 부분이 사용자의 CVS 계정 이름(씨스템 계정과는 무관하다), 그 다음은 암호, 그리고 마지막은 씨스템 계정 이름이다. 즉, 이 파일에는 현재 flazma 와 pizza이라는 두 사용자가 등록되어 있고, 이들이 CVS 이용시에는 cvs란 씨스템 계정의 권한을 갖는 것이다. 암호부분은 유닉스 씨스템에서 전통적으로 사용되는 crypt 함수를 이용하여 변환된 값이 저장되어 있다. 새로운 사용자를 추가하려면 같은 형식으로 한 줄을 추가해 주면 된다. 하지만 간단한 방법으로

/etc/shadow 파일 안의 내용중 암호화된 부분을 사용하여

/home/CVS/CVSROOT/passwd 로 만들면 된다


( 혹은 "htpasswd -nb USER_ID PASSWORD" 로 암호를 화면에 출력할수 있다. )


마지막으로 필요한 것은 cvs란 씨스템 계정에 저장소에 대한 읽기 및 쓰기 권한을 주는 것이다. 앞 절과 일관성을 유지하려면 cvs란 그룹을 만들고 cvs란 사용자를 cvs 그룹에 추가한 후, cvs 그룹에 대한 권한을 같은 방법으로 열어주면 된다.
# chgrp -R cvs /home/CVS 
# chmod ug+rwx /home/CVS /home/CVS/CVSROOT 로 권한 설정
 
CVS에 접근(login)
cvs -d :pserver:flazma@localhost:/home/CVS login
 
환경 변수 등록 (bash 쉘)
export CVSROOT=:pserver:flazma@localhost:/home/CVS
 
 
작업공간 생성 : CVS서버로부터 모듈들을 불러와 클라이언트에 작업공간을 생성한다.
※주의 : 현재 CVSN( Server ) 와 Linux CVS ( Server ) 에서 커맨드 가 안 먹는 것이 있음
cvs ls 라는 커맨드가 CVSNT에서는 먹히나 , Linux CVS에서는 안먹힘 , 셋팅상의 문제일수도??? 즉, 서버의 모듈 리스트를 가져올 수가 없음


모두 마친후 , 
cvs login 으로 접속을 해보시길... 
cvs [login aborted]: unrecognized auth response from 192.168.0.1: cvs pserver: cannot open /home/CVS/CVSROOT/config: Permission denied
 

위와 같은 오류가 발생하는 원인은 SELinux 보안 정책 때문이며, 다음과 같은 명령어로
SELinux 보안 정책을 하향 조절(permissive)함으로서 문제를 해결할 수 있다.

[root@fedora8 CVSROOT]# /usr/sbin/setenforce 0



[리눅스 계정 삭제시 유의사항]
http://blog.naver.com/venet4u?Redirect=Log&logNo=110047103394

[리눅스 한글깨질경우]
http://samaim.tistory.com/47



 <Context path="/CVS_PROJECT" docBase="CVS_PROJECT/WebContent" debug="0" reloadable="false" />

 <taskdef resource="org/apache/catalina/ant/catalina.tasks" classpathref="project.classpath"/>
<classpath refid="project.classpath"/> 

tomcat reloadable

<path id="tomcat.deployer.classpth">
   <fileset dir="C:\3_PROGRAMs\tomcat-5.5.26-deployer\lib"></fileset>
 </path>

<target name="reload" depends="publish">
  <taskdef resource="org/apache/catalina/ant/catalina.tasks" 
     classpathref="tomcat.deployer.classpth"/>
  <reload url="http://zeeha-utsman:9090/manager"  
              username="utsman"  
              password="******"  
              path="/chapter13"/>   
 </target>

[ant사용법]
http://donzbox.tistory.com/208

[리눅스 zip 압축]
# zip -r SkyProxy.zip SkyProxy 
# tar -zcvf SkyProxy.tar.gz SkyProxy


헝가리
Last login: Mon Nov 19 09:21:01 2012 from 210.121.190.163
[root@localhost ~]# ssh root@localhost -p 9999
root@localhost's password: 
Last login: Mon Nov 19 01:21:14 2012 from localhost.localdomain
cti123


ssujjy = 1111
mugdo = 1111
sevoon = 1111
eblee = 1111
hdopen = 1111
chsong = chsong
doockung = 1111
needcom=1111
egoistlove=1111
~

HU           3690       (헝가리)
HR           3691       (크로아티아)
BG           3692       (불가리아)
RS           3693       (세르비아)
RO           3694       (루마니아)




SkyProxy_CVS/war




DEBUG [http-8080-3] - {conn-100066} Connection
SELECT  b_seq, b_name, b_userid, b_title, b_text,      b_file, b_fileurl, b_gubun, date_format(b_date,'%Y-%m-%d') b_date, b_hit,      b_important, b_secret, b_vodname      FROM t_vodboard      WHERE b_gubun ='001'      AND b_seq = ?     
SELECT  b_seq, b_name, b_userid, b_title, b_text,      b_file, b_fileurl, b_gubun, date_format(b_date,'%Y-%m-%d') b_date, b_hit,      b_important, b_secret, b_vodname      FROM t_vodboard      WHERE b_gubun ='001'      AND b_seq = ?     

[b_seq, b_name, b_userid, b_title, b_text, b_file, b_fileurl, b_gubun, b_date, b_hit, b_important, b_secret, b_vodname]
[40, 관리자, 1, 창립식영상, null, foundation.gif, home/tomcat/webapps/FutsalLeague/upload/vedio/foundation.gif, 001, 2010-07-07, 0, null, null, foundation_ceremony]
  

<object codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,19,0" 
	width="451" 
	height="363" 
	classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"> 
	<param name="movie" value="/FutsalLeague/iamges/MediaPlayer3.swf"/>
	<param name="quality" value="high"/>
	<param name="flashVars" value="firstName=FK"/>
	<embed 
		width="451" height="363" 
		src="/FutsalLeague/iamges/MediaPlayer3.swf" 
		quality="high" pluginpage="http://www.macromedia.com/go/getflashplayer"
		flashVars="firstName=FK" type="application/x-shockwave-flash"> 
	</embed>
</object>
[web.xml]
http://mclee.tistory.com/6
[struts2 exception]
http://javastore.tistory.com/63
다음과 같이 <action/>태그 내에 <excpetion-mapping/>을 선언한다. 위와 같은 코드는 NullPointerException이 발생되었을때 <action/>태그내에 선언되어 있는 result name="exception" 인 에러 페이지로 이동하게 된다.(exception-mapping result와 result name="exception" 이 같아야 한다.)

<공통>
Exception이 발생하였을때 보여지는 jsp페이지에서는 struts2에서 제공하는 태그라이브러리를 통해 에러 내용을 출력 할 수 있다.

<%@ taglib prefix="s" uri="/struts-tags" %>

tag lib을 추가 하고
<s:actionerror/>
<s:actionmessage/>
<s:fielderror/>
다음과 같은 테그로 에러 내용을 표시 할 수 있다. 또한
${exception.message}
이렇게 선언할 수 도 있고

예외 상세 정보를 확인 하려면
${exceptionStack}

선언하여 exceptionStack에 쌓여있는 에러 정보를 확인 할 수도 있다

		SELECT * FROM information_schema.tables 
		where table_schema = 'SKYRECORD';
    
   SELECT * FROM information_schema.columns where TABLE_NAME = 't_record_file_201211' order by ORDINAL_POSITION;
   
  
   
   SELECT schema_name FROM information_schema.SCHEMATA where SCHEMA_NAME  not in ('test','mysql','information_schema') ;
   

spring3 + mybatis 연동 
http://blog.naver.com/skarion?Redirect=Log&logNo=10146805159
http://kdonghwa.tistory.com/206
http://theeye.pe.kr/entry/simple-way-to-integration-spring-3-with-mybatis-3



log4j 
http://suein1209.tistory.com/206


/usr/local/skycom/var/ivr/ment/ext

futsal
192.168.0.12

id: sshdbwj
pass: tmzkdlzjadbwj)!@ (스카이컴유저012 +shift)
스카이컴유저)!@


root
tmzkdlzjatjqj)!@)!@ (스카이컴서버012012 + shift)

tomcat 
tmzkdlzjaxhazot))!!@@ (스카이컴톰캣001122+shift)



home/tomcat/k-futsal/webapps/ws_skycom/WEB-INF/prop/image.properties

/etc/httpd

10052066





10052066 or 10040709


 $(".datepicker").datepicker({


  showOn: "both", // 버튼과 텍스트 필드 모두 캘린더를 보여준다.

  buttonImage: "/application/db/jquery/images/calendar.gif", // 버튼 이미지

  buttonImageOnly: true, // 버튼에 있는 이미지만 표시한다.

  changeMonth: true, // 월을 바꿀수 있는 셀렉트 박스를 표시한다.

  changeYear: true, // 년을 바꿀 수 있는 셀렉트 박스를 표시한다.

  minDate: '-100y', // 현재날짜로부터 100년이전까지 년을 표시한다.

  nextText: '다음 달', // next 아이콘의 툴팁.

  prevText: '이전 달', // prev 아이콘의 툴팁.

  numberOfMonths: [1,1], // 한번에 얼마나 많은 월을 표시할것인가. [2,3] 일 경우, 2(행) x 3(열) = 6개의 월을 표시한다.

  stepMonths: 3, // next, prev 버튼을 클릭했을때 얼마나 많은 월을 이동하여 표시하는가. 

  yearRange: 'c-100:c+10', // 년도 선택 셀렉트박스를 현재 년도에서 이전, 이후로 얼마의 범위를 표시할것인가.

  showButtonPanel: true, // 캘린더 하단에 버튼 패널을 표시한다. 

  currentText: '오늘 날짜' , // 오늘 날짜로 이동하는 버튼 패널

  closeText: '닫기',  // 닫기 버튼 패널

  dateFormat: "yy-mm-dd", // 텍스트 필드에 입력되는 날짜 형식.

  showAnim: "slide", //애니메이션을 적용한다.

  showMonthAfterYear: true , // 월, 년순의 셀렉트 박스를 년,월 순으로 바꿔준다. 

  dayNamesMin: ['월', '화', '수', '목', '금', '토', '일'], // 요일의 한글 형식.

  monthNamesShort: ['1월','2월','3월','4월','5월','6월','7월','8월','9월','10월','11월','12월'] // 월의 한글 형식.

 });

http://87nyunseng.tistory.com/entry/JQUERY-%ED%81%AC%EB%A1%9C%EC%8A%A4%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A7%95-%EB%8B%AC%EB%A0%A5-datepicker


1. 일반적인 오라클 페이징 처리



 
01.SELECT * FROM ( 
02.     SELECT A.*,  
03.                 ROWNUM AS RNUM, 
04.                 FLOOR((ROWNUM-1)/{디스플레이수}+1) AS PAGE, 
05.                 COUNT(*) OVER() AS TOTCNT FROM ( 
06.          {검색쿼리 - 정렬이 필요할 경우 정렬조건 포함} 
07.    ) A 
08.) WHERE PAGE = {페이지번호}; 
09.  
10.OR
11.  
12.SELECT * FROM ( 
13.     SELECT A.*,  
14.                 ROWNUM AS RNUM, 
15.                 COUNT(*) OVER() AS TOTCNT FROM ( 
16.          {검색쿼리 - 정렬이 필요할 경우 정렬조건 포함} 
17.    ) A 
18.) WHERE RNUM > {범위부터} AND RNUM <= {범위까지};


2. 오라클 대용량 페이징 처리



 
01.SELECT * FROM ( 
02.     SELECT ROWNUM AS RNUM, A.* FROM ( 
03.          {검색쿼리 - 정렬이 필요할 경우 정렬조건 포함} 
04.    ) A WHERE ROWNUM <= {범위까지} 
05.) WHERE RNUM > {범위부터}; 
06.  
07.OR
08.  
09.SELECT * FROM ( 
10.     SELECT /*+ INDEX_ASC or INDEX_DESC(A {정렬조건 인덱스명}) */ 
11.                 ROWNUM AS RNUM, A.*  FROM ( 
12.          {검색쿼리 - 정렬이 필요한 경우 정렬조건을 포함하지 않고 ORACLE 힌트사용} 
13.     ) A WHERE ROWNUM <= {범위까지} 
14.) WHERE RNUM > {범위부터};



http://v3brs.egloos.com/1868783 엑셀 표현

http://v.daum.net/link/9204774 사이트 스크랩핑 기법

http://v.daum.net/link/9204774


http://stbaeya.com/tc/category/45


package lotte.main;

import java.util.Enumeration;
import java.util.Hashtable;

import javax.servlet.http.HttpSession;
import javax.servlet.http.HttpSessionBindingEvent;
import javax.servlet.http.HttpSessionBindingListener;

public class LoginManager implements HttpSessionBindingListener {
	private static LoginManager manager = null;
	private static Hashtable users = new Hashtable();
	
	public LoginManager() {
		// TODO Auto-generated constructor stub
		super();
	}
	public static synchronized LoginManager getInstance(){
		if(manager == null){
			manager = new LoginManager();
		}
		return manager;
	}
	//아이디 체크
	public boolean isValid(String userId, String userPw){
		return true;
	}
	//해당세션에 로그인되있는지 체크
	public boolean isLogin(String sessionId){
		boolean isLogin = false;
		Enumeration e = users.keys();
		String key = "";
		while (e.hasMoreElements()) {
			key = (String) e.nextElement();			
			if(sessionId.equals(key)){
				isLogin = true;
			}
		}
		return isLogin;
	}
	//중복 로그인 막기 위해 아이디 사용중인지 체크
	public boolean isUsing(String userId){
		boolean isUsing = false;
		Enumeration e = users.keys();
		String key = "";
		while (e.hasMoreElements()) {
			key = (String) e.nextElement();
			if(userId.equals(users.get(key))){
				isUsing = true;
			}
		}
		return isUsing;
	}
	//세션생성
	public void setSession(HttpSession session, String userId){
		users.put(session.getId(), userId);
		session.setAttribute("loginId", this.getInstance());
	}
	public void setUser(HttpSession session, String userId){
		users.put(session.getId(), userId);
		session.setAttribute("loginId", this.getInstance());
	}
	//세션성립될때
	@Override
	public void valueBound(HttpSessionBindingEvent arg0) {
		// TODO Auto-generated method stub

	}
	//세션 끊길때
	@Override
	public void valueUnbound(HttpSessionBindingEvent arg0) {
		// TODO Auto-generated method stub

	}
	//세션ID로  로긴된 ID 구분
	public String getUserId(String sessionId){
		return (String)users.get(sessionId);
	}
	//현재접속자수
	public int getUserCount(){
		return users.size();
	}
	
}
 <interceptors>
			<interceptor-stack name="myBasicStack">
				<interceptor-ref name="exception" />
                <interceptor-ref name="servletConfig" /> 
				<interceptor-ref name="params" />
			</interceptor-stack>
        
			<interceptor-stack name="myPrepareParamsStack">
				<interceptor-ref name="exception" />
                <interceptor-ref name="servletConfig" /> 
				<interceptor-ref name="prepare" />
				<interceptor-ref name="modelDriven" />
				<interceptor-ref name="params" />
			</interceptor-stack>

			<interceptor-stack name="myFileUploadPrepareParamsStack">
				<interceptor-ref name="exception" />
                <interceptor-ref name="servletConfig" /> 
				<interceptor-ref name="fileUpload" />
				<interceptor-ref name="prepare" />
				<interceptor-ref name="modelDriven" />
				<interceptor-ref name="params" />
			</interceptor-stack>
        </interceptors>
        <default-interceptor-ref name="myBasicStack" />

package lotte.main;

import java.sql.SQLException;
import java.util.HashMap;
import java.util.Map;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

import lotte.common.dao.CommonDAO;
import lotte.common.dao.CommonDAOIF;
import lotte.common.util.Func;
import lotte.common.util.LoggerHelper;

import org.apache.log4j.Logger;
import org.apache.struts2.ServletActionContext;
import org.apache.struts2.interceptor.ServletRequestAware;
import org.apache.struts2.interceptor.ServletResponseAware;

import com.opensymphony.xwork2.ActionContext;
import com.opensymphony.xwork2.ActionSupport;

public class MainAction extends ActionSupport implements ServletRequestAware, ServletResponseAware{

	private static final long serialVersionUID = 1L;
	private static final Logger logger = LoggerHelper.getLogger();
	private static LoginManager loginManager = LoginManager.getInstance();
	private HttpServletRequest req;
	private HttpServletResponse res;
	private String user_id;
	private String user_pwd;
	private MainDTO sessionDTO;
	private Func func;		
	
	public MainAction(){
		
	}
	@Override
	public void setServletRequest(HttpServletRequest req){
		this.req = req;
	}
	@Override
	public void setServletResponse(HttpServletResponse res){
		this.res = res;
	}
	
	public String main(){
		return SUCCESS;
	}	
	
	public String login() throws SQLException {
		boolean flag = false;		
		Map session = ActionContext.getContext().getSession();
		HttpSession httpSession = req.getSession();
		logger.info("httpsession :: "+httpSession.getId());
		logger.info("login id :: " + user_id);		
		if(loginChk()){		
			session.put("user_id", user_id);			
			session.put("user_name", sessionDTO.getUser_name());
			session.put("site_code", sessionDTO.getSite_code());
			loginManager.setUser(session, user_id);
			//loginManager.setUser(httpSession, user_id);
			return "success";
		}else{
			return "returnlogin";
		}		
	}
	public boolean loginChk(){
		boolean flag = false;
		Integer loginCount = 0;
		Map<String, Object> hMap = new HashMap<String, Object>();
		CommonDAOIF commonDAO = new CommonDAO();		
		hMap.put("user_id", user_id);
		hMap.put("user_pwd", user_pwd);		
		try {
			loginCount = (Integer)commonDAO.getIntValue("main.loginChk", hMap);	System.out.println(loginCount);		
			if(loginCount > 0){
				sessionDTO = (MainDTO)commonDAO.getReadData("main.login", hMap);
				if(loginManager.isUsing(sessionDTO.getUser_id())){
					logger.info("중복로그인된 유저입니다");
				}else{
					logger.info("중복 노노");
				}
				flag = true;
			}else{
				flag = false;
			}
		} catch (Exception e) {
			e.printStackTrace();
		}		
		
		return flag;
	}
	public String logout() {
		Map session = ActionContext.getContext().getSession();
		logger.info("log out :: " + session.get("user_id"));
		if(session !=null){
			session.remove("user_id"); // 아이디
			session.remove("site_cd"); // 고개번호
			session.remove("user_name"); // 고객명
			session.remove("sessionCheckId:"+session.get("user_id")); // 세션아이디체크용			
			session.clear();
		}
		return SUCCESS;
	}	
	public String getUser_id() {
		return user_id;
	}
	public void setUser_id(String user_id) {
		this.user_id = user_id;
	}
	public String getUser_pwd() {
		return user_pwd;
	}
	public void setUser_pwd(String user_pwd) {
		this.user_pwd = user_pwd;
	}
	public MainDTO getSessionDTO() {
		return sessionDTO;
	}
	public void setSessionDTO(MainDTO sessionDTO) {
		this.sessionDTO = sessionDTO;
	}
	
	
	
	
	

}


<listener>
		<listener-class>lotte.main.LoginManager</listener-class>
	</listener>
tstorage/vol3/record/Server1/20130213/029-003-183-5613-0324348191-20130213091306-20130213091327-0.mp3

body onUnload= 


Onunload 이벤트 할당 하기




페이지 로드 이벤트인 onload 이벤트와 달리 페이지 종료 시(Refrash, Redirect, window.close) 발생하는 onunload 이벤트와 같은 경우 브라우저 벤더 및 버전까지 분기 처리해야 하는 이슈가 존재한다.


특히, Chrome 브라우저 같은 경우는 테스트 해본 결과 종료 시 onunload 이벤트가 발생하지 않아 onbeforeunload 이벤트를 이용하여 처리해야 한다.


이를 해결하기 위해 아래 코드의 onUnload() 함수를 "onbeforeunload" 이벤트에 할당하여, onunload 이벤트 발생 브라우저(Chrome 브라우저 제외)와 그렇지 않은 브라우저(Chrome)를 분기처리 하여 모든 브라우저에서 onunload 시 해당 이벤트 handler를 발생 시킨다.


function getBrowserInfo() {
 
    var msie = /(msie) ([\d]{1,})./gi.exec(window.navigator.userAgent.split(';'));
    var firefox = /(firefox)\/([\d]{1,})./gi.exec(window.navigator.userAgent.split(' ')[6]);
    var safari = /(safari)\/([\d]{1,})./gi.exec(window.navigator.userAgent.split(' ')[9]);
    var chrome = /(chrome)\/([\d]{1,})./gi.exec(window.navigator.userAgent.split(' ')[8]);
 
    var name = '';
    var version = 0;
 
    if (msie) {
        name = msie[1].toLowerCase();
        version = msie[2];
    }
    else if (firefox) {
        name = firefox[1].toLowerCase();
        version = firefox[2];
    }
    else if (safari && !chrome) {
        name = safari[1].toLowerCase();
        version = /(version)\/([\d]{1,})./gi.exec(window.navigator.userAgent.split(' ')[8])[2];
    }
    else if (safari && chrome) {
        name = chrome[1].toLowerCase();
        version = chrome[2];
    }
 
    return {
        name: name,
        version: version
    }
}
 
function onUnload(e, callback) {
 
    var ag = window.navigator.userAgent.toLocaleLowerCase()
      , binfo = getBrowserInfo();
 
    e = window.event || e;
    callback = typeof callback === 'function' ? callback : function () { ; };
 
    // IE
    if (binfo.name === 'msie') {
        if (confirm("callback 함수가 실행 됩니다.")) {
            bind(window, 'unload', function (e) { callback() });
        }
    }
    else {
        if (binfo.name === 'firefox') {
            if (confirm("callback 함수가 실행 됩니다.")) {
                bind(window, 'unload', function (e) { callback(); });
            }
            else {
                // window loading stop
                windiw.setTimeout(function () { window.stop(); }, 1);
            }
        }
        else if (binfo.name === 'safari') {
            if (window.confirm('callback 함수가 실행 됩니다.')) {
                bind(window, 'unload', function (e) { callback(); });
            }
        }
        else if (binfo.name === 'chrome') {
            return callback();
        }
    }
}
 
function callback() {
    // window unload 이벤트 핸들러
    document.title = 'title';
    alert(document.title);
    return 'callback 함수가 실행 됩니다.';
}
 
// 이벤트 등록 함수
function bind(elem, type, handler, capture) {
    type = typeof type === 'string' && type || '';
    handler = typeof handler === 'function' ? handler : function () { ; };
 
    if (elem.addEventListener) {
        elem.addEventListener(type, handler, capture);
    }
    else if (elem.attachEvent) {
        elem.attachEvent('on' + type, handler);
    }
 
    return elem;
};
 
 
bind(window, 'beforeunload', function (e) {
    return onUnload.apply(this, [e, callback]);
});



위 코드와 같이 Chrome 브라우저를 제외한 나머지 브라우저는 onunload 이벤트가 정상적으로 발생하므로 onbeforeunload 이벤트 발생 시 해당 이벤트를 할당 시킨다.
http://mohwaproject.tistory.com/entry/%EB%AA%A8%EB%93%A0-%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80%EC%97%90%EC%84%9C-onbeforeunload-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EC%A0%81%EC%9A%A9-%ED%95%98%EA%B8%B0

jquery tooltip poshytip



window.onbeforeunload = function(){
		alert("dd :: "+window);
		if(self.screenTop > 9000){
			alert('닫힘');
		}else{
			if(document.readyState == 'complete'){
				alert('새로고침');
			}else if (document.readyState == 'loading'){
				alert('이동');
			}
		}
	}
	/*bind(window, 'beforeunload', function (e) {
	    return onUnload.apply(this, [e, callback]);
	});*/

	function getBrowserInfo() {
		 
	    var msie = /(msie) ([\d]{1,})./gi.exec(window.navigator.userAgent.split(';'));
	    var firefox = /(firefox)\/([\d]{1,})./gi.exec(window.navigator.userAgent.split(' ')[6]);
	    var safari = /(safari)\/([\d]{1,})./gi.exec(window.navigator.userAgent.split(' ')[9]);
	    var chrome = /(chrome)\/([\d]{1,})./gi.exec(window.navigator.userAgent.split(' ')[8]);
	 
	    var name = '';
	    var version = 0;
	 
	    if (msie) {
	        name = msie[1].toLowerCase();
	        version = msie[2];
	    }
	    else if (firefox) {
	        name = firefox[1].toLowerCase();
	        version = firefox[2];
	    }
	    else if (safari && !chrome) {
	        name = safari[1].toLowerCase();
	        version = /(version)\/([\d]{1,})./gi.exec(window.navigator.userAgent.split(' ')[8])[2];
	    }
	    else if (safari && chrome) {
	        name = chrome[1].toLowerCase();
	        version = chrome[2];
	    }
	 
	    return {
	        name: name,
	        version: version
	    }
	}
	 
	function onUnload(e, callback) {
	 
	    var ag = window.navigator.userAgent.toLocaleLowerCase()
	      , binfo = getBrowserInfo();
	 
	    e = window.event || e;
	    callback = typeof callback === 'function' ? callback : function () { ; };
	 
	    // IE
	    if (binfo.name === 'msie') {
	        if (confirm("callback 함수가 실행 됩니다.")) {
	            bind(window, 'unload', function (e) { callback() });
	        }
	    }
	    else {
	        if (binfo.name === 'firefox') {
	            if (confirm("callback 함수가 실행 됩니다.")) {
	                bind(window, 'unload', function (e) { callback(); });
	            }
	            else {
	                // window loading stop
	                windiw.setTimeout(function () { window.stop(); }, 1);
	            }
	        }
	        else if (binfo.name === 'safari') {
	            if (window.confirm('callback 함수가 실행 됩니다.')) {
	                bind(window, 'unload', function (e) { callback(); });
	            }
	        }
	        else if (binfo.name === 'chrome') {
	            return callback();
	        }
	    }
	}
	 
	function callback() {
	    // window unload 이벤트 핸들러
	    document.title = 'title';
	    alert(document.title);
	    return 'callback 함수가 실행 됩니다.';
	}
	 
	// 이벤트 등록 함수
	function bind(elem, type, handler, capture) {
	    type = typeof type === 'string' && type || '';
	    handler = typeof handler === 'function' ? handler : function () { ; };
	 
	    if (elem.addEventListener) {
	        elem.addEventListener(type, handler, capture);
	    }
	    else if (elem.attachEvent) {
	        elem.attachEvent('on' + type, handler);
	    }
	 
	    return elem;
	};
	 

	 recordFileList








#!/bin/bash

Today=`date -d today +%Y%m%d`

#백업전 삭제작업
rm -rf /home/tomcat/backup/*


#디비 백업
/usr/bin/mysqldump -uroot -pskycom67960 k_futsal > /home/tomcat/backup/k_futsal.sql_$Today

/usr/bin/mysqldump -uroot -pskycom67960 futsal > /home/tomcat/backup/futsal.sql_$Today

/usr/bin/mysqldump -uroot -pskycom67960 koreasoccer > /home/tomcat/backup/koreasoccer.sql_$Today

#k-futsal 압축작업 후 복사했던 자료 삭제
cp -Rf /home/tomcat/k-futsal/webapps/FutsalLeague/war/images /imsi/images
cp -Rf /home/tomcat/k-futsal/webapps/FutsalLeague/war/upload /imsi/upload
cp -Rf /home/tomcat/k-futsal/log /imsi/log

tar -zcvf /home/tomcat/backup/k-futsal.tar.gz_$Today /imsi
rm -rf /imsi/*

#futsal 압축작업
cp -Rf /home/tomcat/upload /imsi/upload_d
cp -Rf /home/tomcat/futsal/webapps/FutsalUnite/war/upload /imsi/upload
cp -Rf /home/tomcat/futsal/log /imsi/log

tar -zcvf /home/tomcat/backup/futsal.tar.gz_$Today /imsi
rm -rf /imsi/*

#koreasoccer 압축작업
cp -Rf /home/tomcat/koreasoccer/webapps/KoreaSoccer/war/upload /imsi/upload
cp -Rf /home/tomcat/koreasoccer/log /imsi/log

tar -zcvf /home/tomcat/backup/KoreaSoccer.tar.gz_$Today /imsi
rm -rf /imsi/*


#192.168.255.38서버에 rsync로 백업
rsync -avz /home/tomcat/backup/k_futsal.sql_$Today 192.168.255.38:/home/backup/FutsalServer/k-futsal/db/day

rsync -avz /home/tomcat/backup/futsal.sql_$Today 192.168.255.38:/home/backup/FutsalServer/futsal/db/day

rsync -avz /home/tomcat/backup/koreasoccer.sql_$Today 192.168.255.38:/home/backup/FutsalServer/koreasoccer/db/day

rsync -avz /home/tomcat/backup/k-futsal.tar.gz_$Today 192.168.255.38:/home/backup/FutsalServer/k-futsal/project/day

rsync -avz /home/tomcat/backup/futsal.tar.gz_$Today 192.168.255.38:/home/backup/FutsalServer/futsal/project/day

rsync -avz /home/tomcat/backup/koreasoccer.tar.gz_$Today 192.168.255.38:/home/backup/FutsalServer/koreasoccer/project/day



mysql> SELECT UNIX_TIMESTAMP();
        -> 1196440210

특정 시간을 UNIX 타임 스탬프로 변환하고자 할때

mysql> SELECT UNIX_TIMESTAMP('2007-11-30 10:30:19');
        -> 1196440219
 
UNIX 타임 스탬프를 일반 시간으로 계산
mysql> SELECT FROM_UNIXTIME(1111885200);

1시간  : 3600 초
1 * 60 *60

1분 60 초

1*60


<%@ taglib prefix="s" uri="/struts-tags" %>
<s:if test="#session.get('user_id') == NULL">
<s:property value="#session.get('user_id')"/>

<%
Map session = ActionContext.getContext().getSession();
Map<String, String> map = new HashMap<String, String>();
String user_id=(String)session.get("user_id");
map.put("user_id",user_id);
CommonDAOIF commonDAO = new CommonDAO(DbChooseInit.emsplusdb);
WebUserDTO webUserDTO = (WebUserDTO)commonDAO.getReadData("WebUser.getPasswd",map);
%>


 http://58.226.213.172/uni
 id 10040709
 pw 1111




자바서비스넷
이희승 이원영

kmtune | grep max_thread_proc





RTP 전송 
http://karsvv.tistory.com/21
웹소켓
http://mohwaproject.tistory.com/archive/20120517

QuickTime for java
http://blog.kimkoon.net/224



import java.io.File;

import javax.media.Format;
import javax.media.Manager;
import javax.media.MediaLocator;
import javax.media.Player;
import javax.media.PlugInManager;
import javax.media.format.AudioFormat;

public class AudioTest {
public static void main(String[] args) {
    Format input1 = new AudioFormat(AudioFormat.MPEGLAYER3);
    Format input2 = new AudioFormat(AudioFormat.MPEG);
    Format output = new AudioFormat(AudioFormat.LINEAR);
    PlugInManager.addPlugIn(
        "com.sun.media.codec.audio.mp3.JavaDecoder",
        new Format[]{input1, input2},
        new Format[]{output},
        PlugInManager.CODEC
    );
    try{
        Player player = Manager.createPlayer(new MediaLocator(new File("mp3tester.mp3").toURI().toURL()));
        player.start();
    }
    catch(Exception ex){
        ex.printStackTrace();
    }
}
}

import java.io.*;
import sun.audio.*;

public class PlayMusic {


    public void playSound() {
        try {
            AudioPlayer p = AudioPlayer.player;
            AudioStream as = new AudioStream(new FileInputStream("02 River Flows In You.wav"));
            p.start(as);


        } catch (IOException IOE) {
        }
    }

AudioStream audiostream = new AudioStream(url.openStream());
AudioPlayer.player.start(audiostream);

http://docs.oracle.com/javase/tutorial/sound/playing.html
was 서버 :NGINX
그래서 부하테스트 오픈소스프로그램 nGrinder

http://www.nhnopensource.org/ngrinder/    nGrinder 웹페이지

http://junoyoon.tistory.com                          개발자 블로그

http://prezi.com/sv1xtz75ybaq/ngrinder/       nhn helloworld nGrinder 소개 prez

node.js

http://h9911120.blog.me/50152756458


JMS를 하기 위해서는 JMS 서버가 필요하다. 웹로직이나 웹스피어 같은 엔터프라이즈의
상용 어플리케이션에서 제공하는 JMS 서버 서비스를 사용하기도 하지만, 그렇지 못한 경우
오픈 소스 진영의 JMS 서버를 구축하는 것도 좋을 거 같아 포스팅을 한다.


Apache Qpid - http://qpid.apache.org/
Apache ActiveMQ - http://activemq.apache.org/
HornetQ - http://www.jboss.org/hornetq
OpenMQ - http://mq.java.net/



[25/Feb/2013:08:14:40 +0900] USqe4H8AAAEAAEF1zVoAAAAT 66.249.75.33 51835 210.121.190.12 80
--d7008d74-B--
GET /ws_skycom/rest_image/image/get_image?fileName=news/AK2Z7926.jpg HTTP/1.1
Host: k-futsal.or.kr
Connection: Keep-alive
Accept: */*
From: googlebot(at)googlebot.com
User-Agent: Googlebot-Image/1.0
Accept-Encoding: gzip,deflate
If-Modified-Since: Wed, 21 Mar 2012 19:04:29 GMT

--d7008d74-F--
HTTP/1.1 500 Internal Server Error
Content-Length: 2635
Connection: close
Content-Type: text/html;charset=utf-8

--d7008d74-H--
Apache-Handler: jakarta-servlet
Stopwatch: 1361747680782283 4420 (- - -)
Stopwatch2: 1361747680782283 4420; combined=1298, p1=0, p2=1291, p3=1, p4=0, p5=6, sr=0, sw=0, l=0, gc=0
Producer: ModSecurity for Apache/2.6.8 (http://www.modsecurity.org/).
Server: Apache/2.2.15 (CentOS)

--d7008d74-Z--

--02324f65-A--
[25/Feb/2013:09:17:29 +0900] USqtmH8AAAEAAAYwELwAAAAH 39.7.25.115 6820 210.121.190.12 80
8:53 ~ 56
Feb 25, 2013 9:13:14 AM org.apache.catalina.connector.Connector pause
SEVERE: Protocol handler pause failed
java.net.NoRouteToHostException: Network is unreachable

[2013-02-25 09:10:11] [PreparedStatement] [27] [DEBUG] {pstm-136263} Parameters: [null, 0000000330]
[2013-02-25 09:10:11] [PreparedStatement] [27] [DEBUG] {pstm-136263} Types: [null, java.lang.String]
java.lang.NullPointerException
        at skycom.brd.boardBrdAction.readBoard(boardBrdAction.java:112)
        at sun.reflect.GeneratedMethodAccessor749.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:616)
        at com.opensymphony.xwork2.DefaultActionInvocation.invokeAction(DefaultActionInvocation.java:404)
        at com.opensymphony.xwork2.DefaultActionInvocation.invokeActionOnly(DefaultActionInvocation.java:267)
        at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:229)
        at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:184)
        at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:86)
        at com.opensymphony.xwork2.DefaultActionInvocation$2.doProfiling(DefaultActionInvocation.java:224)
        at com.opensymphony.xwork2.DefaultActionInvocation$2.doProfiling(DefaultActionInvocation.java:223)
        at com.opensymphony.xwork2.util.profiling.UtilTimerStack.profile(UtilTimerStack.java:455)
        at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:221)

→
Feb 25, 2013 9:13:14 AM org.apache.catalina.connector.Connector pause
SEVERE: Protocol handler pause failed
java.net.NoRouteToHostException: Network is unreachable
        at java.net.PlainSocketImpl.socketConnect(Native Method)
        at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:327)
        at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:193)
        at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:180)
        at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:384)
        at java.net.Socket.connect(Socket.java:546)
        at java.net.Socket.connect(Socket.java:495)
        at java.net.Socket.<init>(Socket.java:392)
        at java.net.Socket.<init>(Socket.java:235)
        at org.apache.jk.common.ChannelSocket.unLockSocket(ChannelSocket.java:492)
        at org.apache.jk.common.ChannelSocket.pause(ChannelSocket.java:288)
        at org.apache.jk.server.JkMain.pause(JkMain.java:739)
        at org.apache.jk.server.JkCoyoteHandler.pause(JkCoyoteHandler.java:153)
        at org.apache.catalina.connector.Connector.pause(Connector.java:1138)
        at org.apache.catalina.core.StandardService.stop(StandardService.java:578)
        at org.apache.catalina.core.StandardServer.stop(StandardServer.java:788)
        at org.apache.catalina.startup.Catalina.stop(Catalina.java:662)
        at org.apache.catalina.startup.Catalina$CatalinaShutdownHook.run(Catalina.java:706)


driver=oracle.jdbc.driver.OracleDriver
url=jdbc:oracle:thin:@10.23.102.121:1521:ucbill
username=uc_admn
password=system


Meteor, Node.js, deployd, Redis, Cassandra, MongoDB, chef, Ganglia, Puppet


자동가입방지

jcaptcha
http://rexraio.tistory.com/52
simplecaptcha
http://winflahed.tistory.com/132


16:08분 tomcat

com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure
        
The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
List()com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure
        
The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure
        
The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
        at java.lang.reflect.Constructor.newInstance(Constructor.java:532)
        at com.mysql.jdbc.Util.handleNewInstance(Util.java:409)
        at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1118)
        at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:343)
        at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2308)
        at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2122)
        at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:774)
        at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:49)


2013-02-28 16:08:04,311 | INFO  | Database /usr/local/emsmq/amq/data/kahadb/lock is locked... waiting 10 seconds for the database to be unlocked. Reason: java.io.IOException: File '/usr/local/emsmq/amq/data/kahadb/lock' 
could not be locked. | org.apache.activemq.store.kahadb.MessageDatabase | main
ed. | org.apache.activemq.store.kahadb.MessageDatabase | main


130228 16:09:22 [Note] /usr/libexec/mysqld: ready for connections.
Version: '5.0.77-log'  socket: '/var/lib/mysql/mysql.sock'  port: 3306  Source distribution
A mysqld process already exists at  Thu Feb 28 16:09:24 KST 2013
130228 16:16:14 [Note] /usr/libexec/mysqld: Normal shutdown
130228 16:16:16  InnoDB: Starting shutdown...
130228 16:16:17  InnoDB: Shutdown completed; log sequence number 0 11139808
130228 16:16:17 [Note] /usr/libexec/mysqld: Shutdown complete








select a.emp_name avcName,
a.emp_id avcid, 
       b.hwan_code avcHwan, 
       b.jum_id order_online, 
       decode(b.agent_type,'0','1','1','2') agent_type,
       a.dept_code      
  from cm_employee a, cm_agent b 
 where  a.agent_code = b.agent_code
 and a.emp_id = '04301728';
 
 select * from cm_employee where emp_name = '이병순';
 
 
 select basic_data from cm_basic_code
where code_type='WPWD'
  and basic_code='01';super@1234
  
  공유전화번호관리 --&gt; 





 CATALINA_OPTS="$CATALINA_OPTS $JPDA_OPTS" #-server -Xms512m -Xmx2048m  -XX:PermSize=256m -XX:MaxPermSize=768m -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+PrintHeapAtGC -XX:+UseParallelGC
  shift
cat /proc/meminfo 리눅스 메모리 확인
ErrorLog "|/usr/local/cronolog/sbin/cronolog /home/weblog/apache/error/%Y%m/%d/error_log.%Y%m%d"


<%@ page language="java" contentType="text/html; charset=EUC-KR"
    pageEncoding="EUC-KR"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=EUC-KR">
<title>Insert title here</title>
<script>
  function send(){
    var param = "";
    param += "<parameter>";
    param += "<var name='type' value='01'/>";
    param += "<var name='work_type' value='02'/>";
    param += "<var name='forward_type' value='0'/>";
    param += "<var name='from_server' value='4'/>";
    param += "<var name='e164' value='302'/>";
    param += "<var name='hashdata' value='88d9c54dbc5f70664d1347a78b6a7976'/>";
    param += "</parameter>";

    var frm = document.frm;
    frm.parameter.value = param;
    alert(frm.parameter.value);
    frm.submit();
  }
</script>
</head>
<body>
  <form method="post" name="frm" id="frm" action="GetIvrCheck.action">

    <!-- <input type="hidden" name="type" value="01"/>
    <input type="hidden" name="work_type" value="02"/>
    <input type="hidden" name="forward_type" value="0"/>
    <input type="hidden" name="from_server" value="4"/>
    <input type="hidden" name="e164" value="302"/>
    <input type="hidden" name="hashdata" value="88d9c54dbc5f70664d1347a78b6a7976"/> -->
    <input type="hidden" name="parameter" />
    <input type="button" value="전송" onclick="send()">
  </form>
</body>
</html>


priority_codec_1 
priority_codec_2
priority_codec_3
(0,8,18)
negotiation_flag ( 0,1)

<label>
			    	<input type="radio" id="e164TypeFlag" name="e164TypeFlag" checked="checked">user
			    </label>
			    <label>
			    	<input type="radio" id="e164TypeFlag" name="e164TypeFlag">group
			    </label>

<div id="m_totalcnt"  style="margin:2px 0 2px 10px;float:left">Total : 0</div>
			<br/>
			<div style="float: right; margin:3px 5px 5px 0">
		    	 <img style="cursor: pointer;" src="images/bt_search.gif"  border="0"  alt="search" onclick="javascript:goSearch()">
		    </div>
		   	<div id="bt_save3" style="float: right;margin-right: 3px">
		    	<span>E164:</span>
		        <input type = "text" id="sh_start_e164" class="w8tb_input3" onkeyup="goSearchEnter(event);"/>		        
		    </div>


menu_id:parent:menu_level:menu_game    : menu_url             : menu_code
34	3	2	IVR Trunk List	IvrTrunkList.action	8589934592
203	2	2	IVR Common	IVRCommon.action	137438953472

insert into t_menu(menu_id, parent_menu_id, menu_level, menu_name, menu_url, menu_code ) 
values (34, 3,2,'IVR Trunk List','IvrTrunkList.action',8589934592);
insert into t_auth(user_id, menu_id, auth_type, menu_code, write_type ) 
values('admin',34,1,8589934592,1);



 NONE = 0, RING = 1 CONNECT = 2, RING_FTP = 3, CONNECT_FTP = 4

29	2	2	Record	Record.action	33554432
81	8	2	Web User	WebUser.action	1048576
82	8	2	Web User Grant	AuthAdmin.action	2097152


SELECT *
		  FROM t_basiccode
		 WHERE basic_type = 07;
     
     insert into t_basiccode values(7,2,'User',null,null,null,null,null);




insert into t_menu(menu_id, parent_menu_id, menu_level, menu_name, menu_url, menu_code ) 
values (83, 8,2,'Web Record User','WebRecordUser.action',549755813888);

insert into t_auth(user_id, menu_id, auth_type, menu_code, write_type ) 
values('admin',83,1,549755813888,1);


select z.group_id,z.parent_group_id,z.group_name,z.description,z.prefix_no,    (CASE WHEN z.parent_group_id = '00' THEN 'root' ELSE w.group_name END)AS "parent_group_name"    from (select y.group_id,parent_group_id,group_name,y.prefix_no,y.description    from t_group y    where parent_group_id = '1'    and y.group_name like concat('', '%')    )z    LEFT OUTER JOIN t_group w  ON z.parent_group_id = w.group_id    order by z.prefix_no      
Executing Statement:        select z.group_id,z.parent_group_id,z.group_name,z.description,z.prefix_no,    (CASE WHEN z.parent_group_id = '00' THEN 'root' ELSE w.group_name END)AS "parent_group_name"    from (select y.group_id,parent_group_id,group_name,y.prefix_no,y.description    from t_group y    where parent_group_id = '1'    and y.group_name like concat('', '%')    )z    LEFT OUTER JOIN t_group w  ON z.parent_group_id = w.group_id    order by z.prefix_no      
Parameters: [] 
Types: [] 
t 
[group_id, parent_group_id, group_name, description, prefix_no, parent_group_name] 
[25, 1, sbs, sbs, 600, 관리자] 

function flagChg(){
		if(prg_status.value=="UPDATE"){
			user_id.readOnly = true;
			user_id.className = "w4tb_dinput";
		}else{
			user_id.readOnly = false;
			user_id.className = "w4tb_input";
		}
	}




"admin";"rootgroup";"2";"기본 그룹 관리자";"";"";"admin";"655601";"admin123";"기본 그룹 관리자입니다";"";"root";"20110216141627";"";"admin_setcode";""

"basicuser";"rootgroup";"201102161416274";"최고관리자";"";"";"basicuser";"655601";"basicuser123";"";"";"root";"20110216141627";"";"basicuser_setcode";""

"midMng";"rootgroup";"3";"중간관리자";"";"";"midMng";"655601";"midMng123";"기본 중간 관리자입니다";"";"root";"20110216141627";"";"midMng_setcode";""

"root";"rootgroup";"1";"최고관리자";"";"8700";"root";"655601";"root123";"''";"";"root";"20110216163100";"";"root_setcode";""
"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""


mysql> select user_id, group_id, auth_id from t_user;
+---------+----------+---------+
| user_id | group_id | auth_id |
+---------+----------+---------+
| root    | 1        | 1       | 
+---------+----------+---------+
1 row in set (0.00 sec)
mysql> select * from t_auth;
+---------+---------------------------------+-----------+-----------+----------------+------------------+----------+
| auth_id | description                     | update_id | master_yn | update_date    | auth_name        | auth_div |
+---------+---------------------------------+-----------+-----------+----------------+------------------+----------+
|       1 | 최고 관리자                     | root      | Y         | 20120517144200 | root             | 00       | 
|       3 | 그룹 기본 관리자  권한          | root      | N         | 20120517150427 | 그룹 관리자      | 01       | 
+---------+---------------------------------+-----------+-----------+----------------+------------------+----------+

mysql> select group_id, parent_group_id, group_name,  group_div, group_seq  from t_group;
+----------+-----------------+--------------+-----------+-----------+
| group_id | parent_group_id | group_name   | group_div | group_seq |
+----------+-----------------+--------------+-----------+-----------+
| 1        | 00              | 양천구청     | 001       |         1 | 
+----------+-----------------+--------------+-----------+-----------+
1 row in set (0.00 sec)

mysql> select * from t_group_auth;
+----------+---------+-----------+----------------+
| group_id | auth_id | update_id | update_date    |
+----------+---------+-----------+----------------+
|        1 | 1       | root      | 20120517150427 | 
|        1 | 3       | root      | 20120517150427 | 
+----------+---------+-----------+----------------+
2 rows in set (0.00 sec)







enable_register int(1) NOT NULL default '0',


user_id	varchar(32)	utf8_general_ci	NO	PRI	
user_pwd	varchar(32)	utf8_general_ci	YES		
user_name	varchar(64)	utf8_general_ci	YES		
auth	int(11)		NO		0
auth_level	int(11)		YES		-1
menu_code_sum	longblob		NO		
write_grant_sum	longblob		NO		
policy_group	varchar(30)	utf8_general_ci	YES		
e164	varchar(32)	utf8_general_ci	YES		-1

<s:if test='#status.count%2 == 0'>





src/skycom.pbx.db/sqlMapConfig.xml : <sqlMap resource="skycom/pbx/groupadmin/RecordPolicyGroup.xml"/>
		  sqlMapConfigRecord.xml : <sqlMap resource="skycom/pbx/groupadmin/RecordPolicyGroup.xml"/>


src/skycom.pbx.groupadmin/GroupAdmin.xml
			  RecordPolicyGroupAction.java
			  RecordPolicyGroupDTO.java
			  RecordPolicyGroupMgr.java
			  RecordPolicyGroup.xml
			 

src/groupAdmin.xml


WebContent/WEB-INF/dwr.xml
:

<create creator="new" javascript="RecordPolicyGroupAction" scope="session">
			<param name="class" value="skycom.pbx.groupadmin.RecordPolicyGroupAction" />
		</create>
		<convert converter="bean" match="skycom.pbx.groupadmin.RecordPolicyGroupDTO" javascript="RecordPolicyGroupDTO" />



WebContent/jsp/group_admin/group_config.jsp
			   record_policy_group_ajax.jsp
			   record_policy_group_list_ajax.jsp



<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
    "http://struts.apache.org/dtds/struts-2.0.dtd">

<struts>
        <package name="groupAdmin" extends="struts-default" namespace="/">
                <action name="GroupAdmin" class="skycom.pbx.groupadmin.GroupAdminAction">
                        <result name="success">/jsp/group_admin/group_admin.jsp</result>
                        <result name = "returnlogout">/skyproxy.jsp</result>
                </action>
                <action name="GetPolicy" class="skycom.pbx.groupadmin.GetPolicyAction">
                        <result name="success">/returnMsg.jsp</result>
                </action>
        </package>
</struts>








SELECT basic_key, basic_value     
FROM t_basiccode    WHERE basic_type = 8      AND basic_value2 is null     
AND basic_key != 2      AND basic_key != 4      AND basic_key != 1    ORDER BY sort, basic_key      


<!--
<s:select list="methodList" id = "call_method" listKey="key" listValue="value" cssClass="tb_input"/>
-->
<!-- 
								<s:select list="policygroupList" id = "policy_property"	listKey="admin_key"	listValue="admin_value"	cssClass="tb_input"/>
								-->
 
<select id="selectUser" resultClass="UserDTO" parameterClass = "HashMap">
  SELECT  
	 a.idx
	,a.e164
	,a.id
	,CASE WHEN a.ext = '' THEN '-' 
	      WHEN a.ext is null THEN '-'
         ELSE a.ext end AS ext
 FROM t_user a
 WHERE use_yn = 1
   AND a.policy_group = #policy_group#
   AND a.realm = #realm# 
   AND a.e164 NOT IN (SELECT e164  FROM t_group_member  WHERE t_group_property_idx = #t_group_property_idx# )
   AND a.e164 LIKE '$sh_start_e164$%'
   AND a.id LIKE '$sh_id$%'
   AND a.e164 NOT IN 	 
 <iterate property="whereList" open="(" close=")" conjunction=",">
	#whereList[]#
 </iterate>
ORDER BY update_time
</select>



http://hdw.eweb4.com/out/76289.html



+-----------------+-------------+------+-----+---------+-------+
| Field           | Type        | Null | Key | Default | Extra |
+-----------------+-------------+------+-----+---------+-------+
| idx             | int(11)     | NO   | PRI | NULL    |       | 
| e164            | varchar(32) | NO   |     | NULL    |       | 
| call_method     | int(11)     | NO   |     | 0       |       | 
| policy          | int(11)     | NO   |     | 0       |       | 
| apply_last_time | int(1)      | NO   |     | 0       |       | 
| enable_rbt      | int(1)      | NO   |     | 0       |       | 
| realm           | int(11)     | NO   |     | 0       |       | 
| enable_wait     | int(1)      | NO   |     | 0       |       | 
| start_hour      | int(11)     | NO   |     | 0       |       | 
| start_minutes   | int(11)     | NO   |     | 0       |       | 
| end_hour        | int(11)     | NO   |     | 0       |       | 
| end_minutes     | int(11)     | NO   |     | 0       |       | 
| monday          | int(11)     | NO   |     | 1       |       | 
| tuesday         | int(11)     | NO   |     | 1       |       | 
| wednesday       | int(11)     | NO   |     | 1       |       | 
| thursday        | int(11)     | NO   |     | 1       |       | 
| friday          | int(11)     | NO   |     | 1       |       | 
| saturday        | int(11)     | NO   |     | 1       |       | 
| sunday          | int(11)     | NO   |     | 1       |       | 
+-----------------+-------------+------+-----+---------+-------+

ivrMent, CRBT
$("#upload").replaceWith('<input type="file" id="upload" name="upload" accept="wav" class="table_input_3" style="width:242"/>');

$("#upload").replaceWith('<input type="file" id="upload" name="upload" accept="wav,mp3" class="table_input_3" style="width:242"/>');	


/usr/local/skycom/var/ivr/scenario/


/usr/local/skycom/var/ivr/ment/ext/







CREATE TABLE `t_web_user` (
  `user_id` varchar(32) NOT NULL,
  `user_pwd` varchar(32) default NULL,
  `user_name` varchar(64) default NULL,
  `auth` int(11) NOT NULL default '0',
  `auth_level` int(11) default '-1' COMMENT 'auth : 2(user) 일때만 쓰임 0: 관리자 , 2: 유저',
  `menu_code_sum` longblob NOT NULL,
  `write_grant_sum` longblob NOT NULL,
  `policy_group` varchar(30) default NULL,
  `e164` varchar(32) default '-1',
  PRIMARY KEY  (`user_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 CHECKSUM=1 DELAY_KEY_WRITE=1 ROW_FORMAT=COMPACT;



백업
/usr/bin/mysqldump -uroot -pskycom67960 SKYCOMMON > /usr/sql_back/SKYCOMMON.sql

/usr/bin/mysqldump -uroot -pskycom67960 EMSPLUS > /usr/local/tomcat/backup/EMSPLUS.sql
/usr/bin/mysqldump -uroot -pskycom67960 SKYAGENT > /usr/local/tomcat/backup/SKYAGENT.sql
/usr/bin/mysqldump -uroot -pskycom67960 SKYCRBT > /usr/local/tomcat/backup/SKYCRBT.sql

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE9" />

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE8" />
IE 버전

http://blog.naver.com/PostView.nhn?blogId=xcynicx&logNo=110129450755
http://digiko.egloos.com/5701275








[2013-04-05 17:58:37,159] INFO  skycom.ems.mq.EMSConsumer.onMessage(EMSConsumer.java:71) - RECEIVED FROM WEB [UID=5a52dd83-47bc-4fad-80d5-9cd8f02f07c3][ip=192.168.0.96][port=8020][command=0][xmlData=<?xml version="1.0" standalone="no"?><PACKET><FUNCTION TYPE="HEARTBEAT" COMMAND="REQUEST"></FUNCTION></PACKET>]
[2013-04-05 17:58:37,162] INFO  skycom.ems.nio.XmlProtocolHandler.messageSent(XmlProtocolHandler.java:48) - SENT MESSAGE: <?xml version="1.0" standalone="no"?><PACKET><FUNCTION TYPE="HEARTBEAT" COMMAND="REQUEST"></FUNCTION></PACKET>
[2013-04-05 17:58:37,164] INFO  skycom.ems.nio.XmlProtocolHandler.messageReceived(XmlProtocolHandler.java:63) - RECEIVED MESSAGE: <?xml version="1.0" standalone="no"?><PACKET> <FUNCTION TYPE="HEARTBEAT" COMMAND="RESPONSE">  </FUNCTION></PACKET>
[2013-04-05 17:58:37,268] INFO  skycom.ems.mq.EMSProducer.run(EMSProducer.java:71) - RETURN TO WEB [UID=5a52dd83-47bc-4fad-80d5-9cd8f02f07c3][ip=192.168.0.96][port=8020][command=0][success=true][error=]
[xmlData=<?xml version="1.0" standalone="no"?><PACKET>  <FUNCTION TYPE="HEARTBEAT" COMMAND="RESPONSE">  </FUNCTION></PACKET>]
[2013-04-05 17:58:37,432] INFO  skycom.ems.mq.EMSConsumer.onMessage(EMSConsumer.java:71) - RECEIVED FROM WEB [UID=a9ea769d-df2a-48db-9d2c-035213768db0][ip=192.168.0.96][port=8020][command=0][xmlData=<PACKET><FUNCTION TYPE="RELOAD" COMMAND="REQUEST" TABLE="T_SIGNAL_CONFIG"><VALUE><KEY>0</KEY></VALUE></FUNCTION></PACKET>]
[2013-04-05 17:58:37,434] INFO  skycom.ems.nio.XmlProtocolHandler.messageSent(XmlProtocolHandler.java:48) - SENT MESSAGE: <PACKET><FUNCTION TYPE="RELOAD" COMMAND="REQUEST" TABLE="T_SIGNAL_CONFIG"><VALUE><KEY>0</KEY></VALUE></FUNCTION></PACKET>
[2013-04-05 17:58:37,438] INFO  skycom.ems.nio.XmlProtocolHandler.messageReceived(XmlProtocolHandler.java:63) - RECEIVED MESSAGE: 
<?xml version="1.0" standalone="no"?><PACKET><FUNCTION TYPE="RELOAD" COMMAND="RESPONSE" TABLE="T_SIGNAL_CONFIG" RESULT="SUCCESS">
<MESSAGE>Success</MESSAGE></FUNCTION></PACKET>
[2013-04-05 17:58:37,540] INFO  skycom.ems.mq.EMSProducer.run(EMSProducer.java:71) - RETURN TO WEB [UID=a9ea769d-df2a-48db-9d2c-035213768db0][ip=192.168.0.96][port=8020][command=0][success=true][error=]
[xmlData=<?xml version="1.0" standalone="no"?><PACKET><FUNCTION TYPE="RELOAD" COMMAND="RESPONSE" TABLE="T_SIGNAL_CONFIG" RESULT="SUCCESS"><MESSAGE>Success</MESSAGE></FUNCTION></PACKET>]



drwxrwxr-x 5 cvs  cvs 4096 Feb 23 09:20 app
drwxrwx--- 3 root cvs 4096 Apr  8 10:03 CVSROOT
drwxrwxr-x 4 cvs  cvs 4096 Feb 23 09:20 doc
drwxrwxr-x 9 cvs  cvs 4096 Feb  5 18:55 EMSIF
drwxrwxr-x 6 cvs  cvs 4096 Feb 21 18:46 grs
drwxrwxr-x 6 cvs  cvs 4096 Feb 27 16:27 java_app
drwxrwxr-x 6 cvs  cvs 4096 Feb 21 18:46 NH_AVC
drwxrwxr-x 7 cvs  cvs 4096 Feb 21 18:44 NH_Twitter
drwxrwxr-x 4 cvs  cvs 4096 Feb 26 20:23 nodeJs
drwxrwxr-x 8 cvs  cvs 4096 Jan 12 20:33 phoneGap
drwxrwxr-x 7 cvs  cvs 4096 Jan 26 15:05 RICH
drwxrwxr-x 5 cvs  cvs 4096 Jan 26 15:05 RICH_SPRING3
drwxrwxr-x 5 cvs  cvs 4096 Jan 12 22:42 sencha
drwxrwxr-x 5 cvs  cvs 4096 Jan 12 22:39 sencha_example
drwxrwxr-x 6 cvs  cvs 4096 Feb 21 18:43 smartClick
drwxrwxr-x 4 cvs  cvs 4096 Feb  5 18:56 ws_pbx
[root@localhost cvs]# ls


 printf "ID:$(openssl passwd -crypt pw)\n" >> /etc/nginx/security/.htpasswd

pacman -S alsa-utils alsalib 
http://cafe.naver.com/audiostudy/76 mpd 설정

포고가이드
http://cafe.naver.com/pogolinux/8

jwplayer 
http://anrosua.tistory.com/42








    select * from(
      select  
        @RNUM := @RNUM + 1 AS row 
      from t_acd_agent,( SELECT @RNUM := 0 ) R      
     ) t where t.row not in (select idx from t_acd_agent);



skyweb

Incoming message(
<PACKET>
	<FUNCTION TYPE=\"UPDATE\" COMMAND=\"REQUEST\" TABLE=\"T_ACD_AGENT\">
		<VALUE>
			<KEY>15</KEY>
		</VALUE>
	</FUNCTION>
</PACKET>)"


skycall

"2013-04-10T09:24:49.639682":12211:OS:INFO:pbx1:pid-3372:AFF00B90:SKYCALL:"[TABLE:T_ACD_AGENT][INDEX:15][COMMAND:0x0212]"
"2013-04-10T09:24:49.640008":12212:OS:INFO:pbx1:pid-3372:AFF00B90:SKYCALL:"[QUERY][ACD][AGENT][IDX:15][ID:10][POLICY:10][REALM:1][ACD_GROUP:0][CC_USER:0]"
"2013-04-10T09:24:49.640086":12213:OS:INFO:pbx1:pid-3372:AFEBEB90:SKYCALL:"[UPDATE][ACD][AGENT][IDX:15][ID:10][POLICY:10][REALM:1][ACD_GROUP:0]"

tcpMgr.tcpExeControl(mgr);

TCPComm.java 
Make_XmlMsg();

<PACKET><FUNCTION TYPE=\"UPDATE\" COMMAND=\"REQUEST\" TABLE=\"T_TRUNK_LIST\"><VALUE><KEY>19</KEY></VALUE><INDEX>1</INDEX></FUNCTION></PACKET>

<PACKET><FUNCTION TYPE=\"DELETE\" COMMAND=\"REQUEST\" TABLE=\"T_TRUNK_LIST\"><VALUE><KEY>19</KEY></VALUE><INDEX>1</INDEX></FUNCTION></PACKET>




[10:48:12]  INFO [http-8000-17] -<PACKET><FUNCTION TYPE="UPDATE" COMMAND="REQUEST" TABLE="T_ACD_AGENT"><VALUE><KEY>0</KEY></VALUE></FUNCTION></PACKET>
[10:48:12]  INFO [http-8000-17] -###################################
[10:48:12] DEBUG [http-8000-17] -{conn-100574} Connection
[10:48:12] DEBUG [http-8000-17] -{conn-100574} Preparing Statement:    SELECT  skyweb_address      ,skyweb_port      ,ip_address    FROM t_server_info   WHERE system_id = ?   
[10:48:12] DEBUG [http-8000-17] -{pstm-100575} Executing Statement:    SELECT  skyweb_address      ,skyweb_port      ,ip_address    FROM t_server_info   WHERE system_id = ?   
[10:48:12] DEBUG [http-8000-17] -{pstm-100575} Parameters: [0]
[10:48:12] DEBUG [http-8000-17] -{pstm-100575} Types: [java.lang.Integer]
[10:48:12] DEBUG [http-8000-17] -{rset-100576} ResultSet
[10:48:12] DEBUG [http-8000-17] -{rset-100576} Header: [skyweb_address, skyweb_port, ip_address]
[10:48:12] DEBUG [http-8000-17] -{rset-100576} Result: [192.168.0.96, 8020, 192.168.0.96]
[10:48:12]  INFO [http-8000-17] -currentSkyWebSendAddress:192.168.0.96
[10:48:12]  INFO [http-8000-17] -currentSkyWebSendPort:8020
[10:48:12]  INFO [http-8000-17] -ip:192.168.0.96
[10:48:12]  INFO [http-8000-17] -port8020
sendUUida91bc5b0-ccf8-402f-b175-e86ba40c9162
[10:48:12]  INFO [http-8000-17] -fromUid:a91bc5b0-ccf8-402f-b175-e86ba40c9162
[10:48:12]  INFO [http-8000-17] -fromUid:a91bc5b0-ccf8-402f-b175-e86ba40c9162
[10:48:12]  INFO [http-8000-17] -getXmlData():<?xml version="1.0" standalone="no"?>
<PACKET><FUNCTION TYPE="UPDATE" COMMAND="RESPONSE" TABLE="T_ACD_AGENT" RESULT="SUCCESS"><MESSAGE>Success</MESSAGE></FUNCTION></PACKET>
[10:48:12]  INFO [http-8000-17] -getIp():192.168.0.96
[10:48:12]  INFO [http-8000-17] -getPort():8020
[10:48:12]  INFO [http-8000-17] -getCommand():0
[10:48:12]  INFO [http-8000-17] -isDone():true
[10:48:12]  INFO [http-8000-17] -isSuccess():true
[10:48:12]  INFO [http-8000-17] -getError():null
start element    : PACKET
start element    : FUNCTION
start element    : MESSAGE
characters_MessageEvent : Success
this.rawName:MESSAGE
[{MESSAGE=Success, RESULT=SUCCESS}]:1
end element : MESSAGE
end element : FUNCTION
end element : PACKET
getMqlist.size()():1




 INFO [http-8000-4] -fromUid:25c2b4b6-3443-4d6a-8b33-b5ed2840a837
 INFO [http-8000-4] -getXmlData():<PACKET><FUNCTION TYPE="IVR_DELETE" COMMAND="REQUEST" TABLE="T_VMS_USER"><VALUE><KEY>3</KEY></VALUE></FUNCTION></PACKET>
 INFO [http-8000-4] -getIp():192.168.0.218
 INFO [http-8000-4] -getPort():8020
 INFO [http-8000-4] -getCommand():0
 INFO [http-8000-4] -isDone():true
 INFO [http-8000-4] -isSuccess():false
 INFO [http-8000-4] -getError():java.lang.Throwable: JOB FAIL
start element    : PACKET
start element    : FUNCTION
start element    : MESSAGE
characters_MessageEvent : JOB FAIL
this.rawName:MESSAGE
[{MESSAGE=JOB FAIL, RESULT=FAIL}]:1
end element : MESSAGE
end element : FUNCTION
end element : PACKET
getMqlist.size()():1


/usr/lib/jvm/jre-1.6.0-openjdk/bin
java: /usr/bin/java /etc/java /usr/lib/java /usr/share/java /usr/share/man/man1/java.1.gz


#!/bin/sh

LANG=ko_KR.eucKR
export LANG
cd /usr/local/tomcat/webapps/SkyProxy/bin

# JVM_ARGS for VM
##########################
#JVM_ARGS="-Du=WEATHER_SYNC -DTN_ENV=../conf"
#JVM_ARGS="$JVM_ARGS -cp ../WEB-INF/lib/SkyProxy.jar"

JVM_ARGS="-Du=WEATHER_SYNC"
JVM_ARGS="$JVM_ARGS -Xss512k -Xms128m -Xmx256m"
/usr/lib/jvm/jre-1.6.0-openjdk/bin/java $JVM_ARGS skycom.pbx.daemon.SYNCDaemon 1




#최상위 카테고리에 INFO로 레벨 설정 및 appender로 stdout, rolling을 정의
log4j.rootLogger=INFO, stdout, rolling

#stdout 어펜더는 콘솔에 뿌리겠다는 정의
log4j.appender.stdout=org.apache.log4j.ConsoleAppender

#stdout 어펜더는 patternlayout을 사용하겠다는 정의
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout

#페턴은 다음과 같이 포맷팅 하겠다는 것을 정의
log4j.appender.stdout.layout.ConversionPattern=%d %-5p [%t] %-17c{2} (%13F:%L) %3x - %m%n

#역시나 rolling 어펜더는 파일로 처리한다라고 정의
#log4j.appender.rolling=org.apache.log4j.DailyRollingFileAppender

#로그 파일 이름은 output.log
#log4j.appender.rolling.File=D:\\eclipse\\\test\log\\output.log

#true면 톰캣을 내렸다 올려도 파일이 리셋되지 않습니다.
#log4j.appender.rolling.Append=false

#파일 최대 사이즈는 500KB로 설정
#log4j.appender.rolling.MaxFileSize=500KB

#파일 포맷은 output.log.2005-03-10 으로 관리하겠다고 정의
#log4j.appender.rolling.DatePattern='.'yyyy-MM-dd

#역시나 rolling 어펜더는 패턴 레이아웃을 사용하겠다고 정의
log4j.appender.rolling.layout=org.apache.log4j.PatternLayout

#rolling 어펜더는 패턴 레이아웃 포맷
log4j.appender.rolling.layout.ConversionPattern=%d %-5p [%t] %-17c{2} (%13F:%L) %3x - %m%n


JAVA_OPTS="-Xms512m -Xmx1024m"
CATALINA_OPTS="$CATALINA_OPTS $JPDA_OPTS" -server -XX:PermSize=256m -XX:MaxPermSize=768m -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+PrintHeapAtGC -XX:+UseParallelGC

Core J2EE 및 Sun SL-500 J2EE architecture의 패턴에 보게 되면 

6가지의 패턴이 나옵니다.

 

1. CompositeView

2 DispatcherView

3. FrontController

4. InterceptingFilter

5. ServiceToWorker

6. ViewHelper

가 나오는데요...




디자인 원칙
    - 애플리케이션에서 달라지는 부분을 찾아내고, 달라지지 않는 부분으로부터 분리한다.
    - 구현이 아닌 인터페이스에 맞춰서 프로그래밍한다.
    - 상속보다는 구성을 활용한다.
    - 서로 상호작용을 하는 객체 사이에서는 가능하면 느슨하게 결한하는 디자인을 사용해야 한다.
    - 클래스는 확장에 대해서는 열려 있어야 하지만 코드 변경에 대해서는 닫혀 있어야 한다.
       (OCP : Open-Closed Principle)
    - 추상화된 것에 의존하도록 만들어라. 구상클래스에 의존하도록 만들지 않도록 한다.
    - 최소 지식 원칙 - 정말 친한 친구하고만 얘기하라.
       (다음 네 종류의 객체의 메서드만 호출한다.
         1. 객체 자체 / 2. 메서드에 매개변수로 전달된 객체 / 3. 그 메서드에서 생성하거나 인스턴스를 만든 객체 / 4. 그 객체에 속하는 구성 요소)
    - 헐리우드 원칙 - 먼저 연락하지 마세요. 저희가 연락 드리겠습니다.
    - 클래스를 바꾸는 이유는 한 가지 뿐이어야 한다.
    + ... 나중에 어떻게 바뀔 것인가?




스트래티지 패턴(Strategy Pattern)
    - 알고리즘군을 정의하고 각각을 캐슐화하여 교환해서 사용할 수 있도록 만든다.
    - 알고리즘을 사용하는 클라이언트와는 독립적으로 알고리즘을 변경할 수 있다.
    - 구성을 사용한다.
    - 일반적으로 서브클래스를 만드는 방법을 대신하여 유연성을 극대화하기 위한 용도로 쓰인다.
    - 예: QuarkBehavior & FlyBehavior
    


	
옵저버 패턴(Observer Pattern)
    - 한 객체의 상태가 바뀌면 그 객체에 의존하는 다른 객체들한테 연락이 가고
       자동으로 내용이 갱신되는 방식으로 일대다(one-to-many) 의존성을 정의한다.
    - 주제(Subject) & 옵저버(Observer)
    - Observable & Observer:
         Observable 에 register, remove, notify 가 있고, 
         Observer 에 update 가 있다. (notify 에서 update 를 호출)
    - 예: 신문 구독 서비스, 기상관측 시스템
    


데코레이터 패턴(Decorator Pattern)
    - 객체에 추가적인 요건을 동적으로 첨가한다.
    - 데코레이터는 서브클래스를 만드는 것을 통해서 기능을 유연하게 확장할 수 있는 방법을 제공한다.    
    - 예: 스타버즈 커피
    
    
팩토리 패턴(Factory Pattern)    
    - 팩토리 메서드 패턴 :
       객체를 생성하기 위한 인터페이스를 정의하는데, 어떤 클래스의 인스턴스를 만들지는 서브클래스에서 결정하게 만든다.
       클래스의 인스턴스를 만드는 일을 서브클래스에 맡긴다.
    - 제품을 생산하는 부분과 사용하는 부분을 분리시킬 수 있다.
    - 추상 팩토리 패턴 :
       인터페이스를 이용하여 서로 연관된, 또는 의존하는 객체를 구상 클래스를 지정하지 않고 생성한다.
       구상 클래스는 서브 클래스에 의해 만들어진다.



싱글턴 패턴(Singleton Pattern)
    - 해당 클래스의 인스턴스가 하나만 만들어지고,
       어디서든지 그 인스턴스에 접근할 수 있도록(전역 접근) 하기 위한 패턴
       
       
커맨드 패턴(Command Pattern)
    - 요구 사항을 객체로 캡슐화 할 수 잇으며, 매개변수를 써서 여러 가지 다른 요구 사항을 집어넣을 수 있다.
       또한 요청 내역을 큐에 저장하거나 로그로 기록할 수도 잇으며, 작업취소 기능도 지원 가능하다.
    - 예: 리모콘
    - 서블릿의 doGet(), doPost() 또는 스트럿츠의 Action() 메서드도 커맨드 패턴이지 않을까?
    


어댑터 패턴(Adapter Pattern)
    - 한 클래스의 인터페이스를 클라이언트에서 사용하고자 하는 다른 인터페이스로 변환한다.
       어댑터를 이용하면 인터페이스 호환성 문제 때문에 같이 쓸 수 없는 클래스들을 연결해서 쓸 수 있다.  
       


퍼사드 패턴(Facade Pattern)
    - 어떤 서브시스템의 일련의 인터페이스에 대한 통합된 인터페이스를 제공한다.
       퍼사드에서 고수준 인터페이스를 정의하기 때문에 서브시스템을 더 쉽게 사용할 수 있다.
    - 서브시스템의 호출을 퍼사드에서 처리해준다. (기본 명령 호출 정도랄까...)
    - 일련의 클래스들에 대한 인터페이스를 단순화 시킨다.
    
    - 각 패턴별 차이점:
       데코레이터 패턴 : 인터페이스는 바꾸지 않고 책임(기능)만 추가
       어댑터 패턴 : 한 인터페이스를 다른 인터페이스로 변환
       퍼사드 패턴 : 인터페이스를 간단하게 바꿈




템플릿 메서드 패턴(Template Method Pattern)
    - 메서드에서 알고리즘의 골격을 정의한다.
       알고리즘의 여러 단계 중 일부는 서브클래스에서 구현할 수 있다.
       템플릿 메서드를 이용하면 알고리즘의 구조는 그대로 유지하면서 서브클래스에서 특정 단계를 재정의할 수 있다.
    - 스트래티지 패턴과 다른 점:
       템플릿 메서드 패턴은 알고리즘의 개요를 정의한다. 실제 작업 중 일부는 서브클래스에서 처리.
       스트래티지 패턴은 객체 구성을 통해서 알고리즘을 캡슐화 및 구현
    - 예) Arrays.sort(배열); --- compareTo() 를 구현하도록 되어 있다.
            Applet , init(), start(), stop(), destory()
            그렇다면 서블릿에도 템플릿 메서드가 쓰이는 거구나. init() - service() - destory()


            
이터레이터 패턴(Iterator Pattern)
    - 컬렉션 구현 방법을 노출시키지 않으면서도
       그 잡합체 안에 들어있는 모든 항목에 접근할 수 있게 해주는 방법을 제공한다.
    - 컬렉션의 구현을 드러내지 않으면서 컬렉셔네 있는 모든 객체들에 대해 반복작업할 수 있다.
    


컴포지트 패턴(Composite Pattern)
    - 객체들을 트리 구조로 구성하여 부분과 전체를 나타내는 계층구조로 만들 수 있다.
       이 패턴을 이용하면 클라이언트에서 개별 객체와 다른 객체들로 구성된
       복합 객체(composite)를 똑같은 방법으로 다룰 수 있다.
    - 클라이언트에서 객체 컬렉션과 개별 객체를 똑같은 식으로 처리할 수 있다.
    - 예) 트리 구조의 패턴, 디렉토리 구조
    - 예) XMLObject 객체가 컴포지트 패턴을 구현한 게 아닐까
    


스테이트 패턴(State Pattern)
    - 객체의 내부 상태가 바뀜에 따라서 객체의 행동을 바꿀 수 있다.
       마치 객체의 클래스가 바뀌는 것과 같은 결과를 얻을 수 있다.
    - 상태 전환의 흐름을 결정하는 코드를 어느 쪽에 집어넣는지 잘 고려해야 한다.
       (상태 객체인지, Context 객체인지)
    - 각 상태를 클래스로 캡슐화함으로써 나중에 변경시켜야 하는 내용을 국지화시킬 수 있다.
    - 스트래티지 패턴:
          어떤 클래스의 인스턴스를 만들고 그 인스턴스에게 어떤 행동을 구현하는 전략 객체를 건내준다.
       스테이트 패턴:
          컨텍스트 객체를 생성할 때 초기 상태를 지정해주는 경우 이후로는 컨텍스트 객체가 알아서 상태를 변경.
          
          
프록시 패턴(Proxy Pattern)
    - 어떤 객체에 대한 접근을 제어하기 위한 용도로 대리인이나 대변인에 해당하는 객체를 제공하는 패턴
    - 다른 객체를 대변한느 객체를 만들어서 주 객체에 대한 접근을 제어할 수 있다.
    - 원격프록시(remote proxy): 원격 객체에 대한 접근 제어
                                                클라이언트와 원격 객체 사이에서 데이터 전달을 관리
       가상프록시(virtual proxy): 생성하기 힘든(인스턴스를 만드는 데 많은 비용이 드는) 자원에 대한 접근 제어
       보호프록시(protection proxy): 접근 권한이 필요한 자원에 대한 접근 제어
                                                     호출하는 쪽의 권한에 따라서 객체에 있는 메소드에 대한 접근 제어
       방화벽 프록시: 일련의 네트워크 자원에 대한 접근 제어
       스마트 레퍼런스 프록시: 주 객체가 참조될 때마나 추가 행동을 제공. 객체에 대한 레퍼런스 개수를 세는 등
       캐싱 프록시: 비용이 많이 드는 작업의 결과를 임시로 저장
                          웹 서버 프록시 또는 컨텐츠 관리 및 퍼블리싱 시스템 등에서 사용
       동기화 프록시: 여러 스레드에서 주 객체에 접근하는 경우 안전하게 작업을 처리할 목적(분산 환경 등에서 사용)
       복잡도 숨김 프록시: 복잡한 클래스들의 집합에 대한 접근을 제어하고 복잡도를 숨겨줌
                                     퍼사드 프록시라고도 함.
                                     프록시에서는 접근을 제어하지만 퍼사드 패턴에서는 대체 인터페이스만 제공
       지연 복사 프록시: 클라이언트에서 필요로 할 때까지 객체가 복사되는 것을 지연시킴으로써 객체의 복사 제어
       
    - 아래 객체들은 모두 클라이언트와 객체 사이에 끼여들어서 요청을 전달한다.
         데코레이터 패턴: 클래스에 새로운 행동을 추가하기 위한 용도
         어댑터 패턴: 다른 객체의 인터페이스를 바꿔주기 위한 용도
         프록시 패턴: 어떤 클래스에 대한 접근을 제어하기 위한 용도
    - java.reflect.Proxy 에 기능이 내장되어 있다.
    
    
디자인 패턴 정의
    - 패턴이란 특정 컨텍스트 내에서 주어진 문제에 대한 해결책이다.
    - 어떤 컨텍스트 내에서 일련의 제약조건에 의해 영향을 받을 수 있는 문제에 봉착했다면,
       그 제약조건 내에서 목적을 달성하기 위한 해결책을 찾아낼 수 있는 디자인을 적용하면 된다.    
      


주의점 및 추가 사항      
    - 디자인 패턴의 과다한 사용은 불필요하게 복잡한 코드를 초래할 수 있다.
       항상 가장 간단한 해결책으로 목적을 달성할 수 있도록 하고, 반드시 필요할 때만 디자인 패턴을 적용하자.      
    - 코딩할 때 어떤 패턴을 사용하고 있는지 주석으로 적어주자.
       클래스와 메서드 이름을 만들 때도 사용 중인 패턴이 분명하게 드러날 수 있도록 해보자.
       다른 개발자들이 그 코드를 볼 때 무엇을 어떻게 구현했는지 훨씬 빠르게 이해할 수 있다.
<LIST><INDEX></INDEX></LIST>










eclipse tptp down

install software 에서

http://download.eclipse.org/release/helios / emf 검색 Modeling - EMF  Eclipse Modeling Framework SDK 다운

String agent = request.getHeader("User-Agent");
mobileChk = agent.matches(".*Mobile.*");

<script type="text/javascript">
var UserAgent = navigator.userAgent; 
if (UserAgent.match(/iPhone|iPod|Android|Windows CE|BlackBerry|Symbian|Windows Phone|webOS|Opera Mini|Opera Mobi|POLARIS|IEMobile|lgtelecom|nokia|SonyEricsson/i) != null || UserAgent.match(/LG|SAMSUNG|Samsung/) != null)
 {
  location.href = "/mobile/index.html";
}
else
{
 alert("Web");
}
</script>



tomcat1
[02:44:22]  INFO [TP-Processor5] -===========================================================
Apr 22, 2013 10:33:01 AM org.apache.tomcat.util.digester.SetPropertiesRule begin
WARNING: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'debug' to '0' did not find a matching property.
Apr 22, 2013 10:33:01 AM org.apache.catalina.core.AprLifecycleListener init
INFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: /usr/lib/jvm/java-1.6.0-openjdk-1.6.0.0/jre/lib/i386/client:/usr/lib/jvm/java-1.6.0-openjdk-1.6.0.0/jre/lib/i386:/usr/lib/jvm/java-1.6.0-openjdk-1.6.0.0/jre/../lib/i386:/home/oracle/10g/lib:/usr/local/ssl/lib:/usr/local/skycom/lib:/usr/java/packages/lib/i386:/lib:/usr/lib
Apr 22, 2013 10:33:01 AM org.apache.coyote.http11.Http11Protocol init
INFO: Initializing Coyote HTTP/1.1 on http-127.0.0.1-8080
Apr 22, 2013 10:33:01 AM org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 1701 ms
Apr 22, 2013 10:33:01 AM org.apache.catalina.core.StandardService start
INFO: Starting service Catalina
Apr 22, 2013 10:33:01 AM org.apache.catalina.core.StandardEngine start
INFO: Starting Servlet Engine: Apache Tomcat/6.0.20




tomcat 2 [02:44:22]  INFO [TP-Processor30] -===========================================================
java.net.BindException: Address already in use /127.0.0.1:18080
        at org.apache.tomcat.util.net.JIoEndpoint.init(JIoEndpoint.java:549)
        at org.apache.coyote.http11.Http11Protocol.init(Http11Protocol.java:176)
        at org.apache.catalina.connector.Connector.initialize(Connector.java:1058)
        at org.apache.catalina.core.StandardService.initialize(StandardService.java:677)
        at org.apache.catalina.core.StandardServer.initialize(StandardServer.java:795)
        at org.apache.catalina.startup.Catalina.load(Catalina.java:535)
        at org.apache.catalina.startup.Catalina.load(Catalina.java:555)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:616)
        at org.apache.catalina.startup.Bootstrap.load(Bootstrap.java:260)
        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:412)
Caused by: java.net.BindException: Address already in use
        at java.net.PlainSocketImpl.socketBind(Native Method)
        at java.net.AbstractPlainSocketImpl.bind(AbstractPlainSocketImpl.java:353)
        at java.net.ServerSocket.bind(ServerSocket.java:336)
        at java.net.ServerSocket.<init>(ServerSocket.java:202)
        at org.apache.tomcat.util.net.DefaultServerSocketFactory.createSocket(DefaultServerSocketFactory.java:56)
        at org.apache.tomcat.util.net.JIoEndpoint.init(JIoEndpoint.java:540)
        ... 12 more
Apr 22, 2013 10:33:04 AM org.apache.catalina.startup.Catalina load
SEVERE: Catalina.start
LifecycleException:  Protocol handler initialization failed: java.net.BindException: Address already in use /127.0.0.1:18080
        at org.apache.catalina.connector.Connector.initialize(Connector.java:1060)
        at org.apache.catalina.core.StandardService.initialize(StandardService.java:677)
        at org.apache.catalina.core.StandardServer.initialize(StandardServer.java:795)
        at org.apache.catalina.startup.Catalina.load(Catalina.java:535)
        at org.apache.catalina.startup.Catalina.load(Catalina.java:555)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:616)
        at org.apache.catalina.startup.Bootstrap.load(Bootstrap.java:260)
        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:412)
Apr 22, 2013 10:33:04 AM org.apache.catalina.startup.Catalina load





c언어 blowfish 암호화 키 tjdnftlrnfhrnrnfh3ehd184-1dnflae-bizcenterII1301gh!@#$%^&
/root/PROJECT/SKYPBX_V2012.10/LIBBLOWFISH



[mysqld]
default-storage-engine=MyISAM



881167, 07045040503, 0222373819, 20130429000117, 20130429000153, 
2843198_07045040503_0503_0222373819_0_20130429000117_20130429000153_lvBokOC4Zb.spx, 
Server1/20130429/2843198_07045040503_0503_0222373819_0_20130429000117_20130429000153_lvBokOC4Zb.spx]


  function goPlay(filedirectory,filename){
                //alert(filedirectory);
                //var frm = $("#frm");
                //frm.attr("action","./recordDown.action?filedirectory="+filedirectory+"&filename="+filename);
                //frm.submit();
                //popupStreamminglistenRecord
                RecordAction.goConvert(filedirectory,filename,{
                        callback:function(str) {
                                parray = str.split(":");
                                if(parray[0]=='success'){
                                        filename = parray[1];
                                        popupStreamminglistenRecord(filename);
                                }
                        }
                });
        }








Dhttp-8000-11> [2013-04-29 =14:43:32] [Connection] [27] [DEBUG] {conn-101004} Connection 
3Dhttp-8000-11> [2013-04-29 =14:43:32] [Connection] [27] [DEBUG] {conn-101004} Preparing Statement:         insert into t_mellodysrc       (src_id,src_name,src_div,group_id,src_filename,reg_date,description,src_g711a,src_g711u,src_g729a,update_id,update_date)    values('12013042914432947','test2 group','00','1','12013042914432947.wav',date_format(now(),'%Y%m%d%H%i%s'),    '','12013042914432947.g711a','12013042914432947.g711u','12013042914432947.g729a',    'root',date_format(now(),'%Y%m%d%H%i%s'))   
3Dhttp-8000-11> [2013-04-29 =14:43:32] [PreparedStatement] [27] [DEBUG] {pstm-101005} Executing Statement:         insert into t_mellodysrc       (src_id,src_name,src_div,group_id,src_filename,reg_date,description,src_g711a,src_g711u,src_g729a,update_id,update_date)    values('12013042914432947','test2 group','00','1','12013042914432947.wav',date_format(now(),'%Y%m%d%H%i%s'),    '','12013042914432947.g711a','12013042914432947.g711u','12013042914432947.g729a',    'root',date_format(now(),'%Y%m%d%H%i%s'))   
3Dhttp-8000-11> [2013-04-29 =14:43:32] [PreparedStatement] [27] [DEBUG] {pstm-101005} Parameters: [] 
3Dhttp-8000-11> [2013-04-29 =14:43:32] [PreparedStatement] [27] [DEBUG] {pstm-101005} Types: [] 
3Dhttp-8000-11> [2013-04-29 =14:43:32] [Connection] [27] [DEBUG] {conn-101006} Connection 
3Dhttp-8000-11> [2013-04-29 =14:43:32] [Connection] [27] [DEBUG] {conn-101006} Preparing Statement:        select          menu_name          from t_menu         where menu_alias = ?      
3Dhttp-8000-11> [2013-04-29 =14:43:32] [PreparedStatement] [27] [DEBUG] {pstm-101007} Executing Statement:        select          menu_name          from t_menu         where menu_alias = ?      
3Dhttp-8000-11> [2013-04-29 =14:43:32] [PreparedStatement] [27] [DEBUG] {pstm-101007} Parameters: [srcFileUploadA] 
3Dhttp-8000-11> [2013-04-29 =14:43:32] [PreparedStatement] [27] [DEBUG] {pstm-101007} Types: [java.lang.String] 
3Dhttp-8000-11> [2013-04-29 =14:43:32] [ResultSet] [27] [DEBUG] {rset-101008} ResultSet 
3Dhttp-8000-11> [2013-04-29 =14:43:32] [ResultSet] [27] [DEBUG] {rset-101008} Header: [menu_name] 
3Dhttp-8000-11> [2013-04-29 =14:43:32] [ResultSet] [27] [DEBUG] {rset-101008} Result: [?뚯썝 ?뚯씪 ?낅줈?? 
3Dhttp-8000-11> [2013-04-29 =14:43:32] [Connection] [27] [DEBUG] {conn-101009} Connection 
3Dhttp-8000-11> [2013-04-29 =14:43:32] [Connection] [27] [DEBUG] {conn-101009} Preparing Statement:        select       group_id AS "id",      group_name AS "name",      prefix_no AS "info"       from t_group      where group_id =?       
3Dhttp-8000-11> [2013-04-29 =14:43:32] [PreparedStatement] [27] [DEBUG] {pstm-101010} Executing Statement:        select       group_id AS "id",      group_name AS "name",      prefix_no AS "info"       from t_group      where group_id =?       
3Dhttp-8000-11> [2013-04-29 =14:43:32] [PreparedStatement] [27] [DEBUG] {pstm-101010} Parameters: [1] 
3Dhttp-8000-11> [2013-04-29 =14:43:32] [PreparedStatement] [27] [DEBUG] {pstm-101010} Types: [java.lang.String] 
3Dhttp-8000-11> [2013-04-29 =14:43:32] [ResultSet] [27] [DEBUG] {rset-101011} ResultSet 
3Dhttp-8000-11> [2013-04-29 =14:43:32] [ResultSet] [27] [DEBUG] {rset-101011} Header: [id, name, info] 
3Dhttp-8000-11> [2013-04-29 =14:43:32] [ResultSet] [27] [DEBUG] {rset-101011} Result: [1, KBS?섏썝 珥앷뎅 援먰솚湲?洹몃９, 600] 
3Dhttp-8000-11> [2013-04-29 =14:43:32] [Connection] [27] [DEBUG] {conn-101012} Connection 
3Dhttp-8000-11> [2013-04-29 =14:43:32] [Connection] [27] [DEBUG] {conn-101012} Preparing Statement:              select          code   AS "id",         code   AS "value",         code_name  AS "name"       from t_basecode      where parent_code = ?             
3Dhttp-8000-11> [2013-04-29 =14:43:32] [PreparedStatement] [27] [DEBUG] {pstm-101013} Executing Statement:              select          code   AS "id",         code   AS "value",         code_name  AS "name"       from t_basecode      where parent_code = ?             
3Dhttp-8000-11> [2013-04-29 =14:43:32] [PreparedStatement] [27] [DEBUG] {pstm-101013} Parameters: [f01] 
3Dhttp-8000-11> [2013-04-29 =14:43:32] [PreparedStatement] [27] [DEBUG] {pstm-101013} Types: [java.lang.String] 
3Dhttp-8000-11> [2013-04-29 =14:43:32] [ResultSet] [27] [DEBUG] {rset-101014} ResultSet 
3Dhttp-8000-11> [2013-04-29 =14:43:32] [ResultSet] [27] [DEBUG] {rset-101014} Header: [id, value, name] 
3Dhttp-8000-11> [2013-04-29 =14:43:32] [ResultSet] [27] [DEBUG] {rset-101014} Result: [00, 00, ?띾낫] 
3Dhttp-8000-11> [2013-04-29 =14:43:32] [ResultSet] [27] [DEBUG] {rset-101014} Result: [01, 01, 誘쇱썝?덈궡] 
3Dhttp-8000-11> [2013-04-29 =14:43:32] [ResultSet] [27] [DEBUG] {rset-101014} Result: [02, 02, 罹좏럹?? 
3Dhttp-8000-11> [2013-04-29 =14:43:32] [ResultSet] [27] [DEBUG] {rset-101014} Result: [03, 03, 怨듭??ы빆] 
3Dhttp-8000-11> [2013-04-29 =14:43:32] [FileUploadInterceptor] [31] [INFO] Removing file upload /upload/upload__2a1ea2e9_13e5414cfa6__8000_00000031.tmp 
3Dhttp-8000-10> [2013-04-29 =14:43:32] [Connection] [27] [DEBUG] {conn-101015} Connection 
3Dhttp-8000-10> [2013-04-29 =14:43:32] [Connection] [27] [DEBUG] {conn-101015} Preparing Statement:        select src_id,src_name,src_div,group_id,src_filename,reg_date,description,      src_g711u,src_g711a,src_g729a   from t_mellodysrc   where group_id = '1'   and src_div like concat('', '%')   and src_name like concat('', '%')       
3Dhttp-8000-10> [2013-04-29 =14:43:32] [PreparedStatement] [27] [DEBUG] {pstm-101016} Executing Statement:        select src_id,src_name,src_div,group_id,src_filename,reg_date,description,      src_g711u,src_g711a,src_g729a   from t_mellodysrc   where group_id = '1'   and src_div like concat('', '%')   and src_name like concat('', '%')       
3Dhttp-8000-10> [2013-04-29 =14:43:32] [PreparedStatement] [27] [DEBUG] {pstm-101016} Parameters: [] 
3Dhttp-8000-10> [2013-04-29 =14:43:32] [PreparedStatement] [27] [DEBUG] {pstm-101016} Types: [] 
3Dhttp-8000-10> [2013-04-29 =14:43:32] [ResultSet] [27] [DEBUG] {rset-101017} ResultSet 
3Dhttp-8000-10> [2013-04-29 =14:43:32] [ResultSet] [27] [DEBUG] {rset-101017} Header: [src_id, src_name, src_div, group_id, src_filename, reg_date, description, src_g711u, src_g711a, src_g729a] 
3Dhttp-8000-10> [2013-04-29 =14:43:32] [ResultSet] [27] [DEBUG] {rset-101017} Result: [12013042913373043, Test Goup, 00, 1, 12013042913373043.wav, 20130429133731, , 12013042913373043.g711u, 12013042913373043.g711a, 12013042913373043.g729a] 
3Dhttp-8000-10> [2013-04-29 =14:43:32] [ResultSet] [27] [DEBUG] {rset-101017} Result: [12013042913391545, System Default, 00, 1, 12013042913391545.wav, 20130429133916, , 12013042913391545.g711u, 12013042913391545.g711a, 12013042913391545.g729a] 
3Dhttp-8000-10> [2013-04-29 =14:43:32] [ResultSet] [27] [DEBUG] {rset-101017} Result: [12013042914432947, test2 group, 00, 1, 12013042914432947.wav, 20130429144332, , 12013042914432947.g711u, 12013042914432947.g711a, 12013042914432947.g729a] 






3Dhttp-8000-11> [2013-04-29 =14:45:08] [Connection] [27] [DEBUG] {conn-101039} Connection 
3Dhttp-8000-11> [2013-04-29 =14:45:08] [Connection] [27] [DEBUG] {conn-101039} Preparing Statement:        update t_group set default_src_id = '12013042913373043',description = '',    default_src_use_yn='Y'    where group_id= '77'      
3Dhttp-8000-11> [2013-04-29 =14:45:08] [PreparedStatement] [27] [DEBUG] {pstm-101040} Executing Statement:        update t_group set default_src_id = '12013042913373043',description = '',    default_src_use_yn='Y'    where group_id= '77'      
3Dhttp-8000-11> [2013-04-29 =14:45:08] [PreparedStatement] [27] [DEBUG] {pstm-101040} Parameters: [] 
3Dhttp-8000-11> [2013-04-29 =14:45:08] [PreparedStatement] [27] [DEBUG] {pstm-101040} Types: [] 
3Dhttp-8000-11> [2013-04-29 =14:45:21] [Connection] [27] [DEBUG] {conn-101041} Connection 
3Dhttp-8000-11> [2013-04-29 =14:45:21] [Connection] [27] [DEBUG] {conn-101041} Preparing Statement:        select g.group_id,g.parent_group_id,g.group_name,g.description,g.prefix_no,default_src_id AS src_id,    c.src_name,default_src_use_yn,    (case when default_src_use_yn = 'N' then '鍮꾩궗?? else '?ъ슜 ' end)AS default_src_use_yn_name    from (    select group_id,parent_group_id,group_name,description,prefix_no,default_src_id,default_src_use_yn    from t_group where group_id = '1'    union all    select group_id,parent_group_id,group_name,description,prefix_no,default_src_id,default_src_use_yn    from t_group where parent_group_id = '1')g    LEFT OUTER JOIN t_mellodysrc c ON g.default_src_id = c.src_id    order by prefix_no      
3Dhttp-8000-11> [2013-04-29 =14:45:21] [PreparedStatement] [27] [DEBUG] {pstm-101042} Executing Statement:        select g.group_id,g.parent_group_id,g.group_name,g.description,g.prefix_no,default_src_id AS src_id,    c.src_name,default_src_use_yn,    (case when default_src_use_yn = 'N' then '鍮꾩궗?? else '?ъ슜 ' end)AS default_src_use_yn_name    from (    select group_id,parent_group_id,group_name,description,prefix_no,default_src_id,default_src_use_yn    from t_group where group_id = '1'    union all    select group_id,parent_group_id,group_name,description,prefix_no,default_src_id,default_src_use_yn    from t_group where parent_group_id = '1')g    LEFT OUTER JOIN t_mellodysrc c ON g.default_src_id = c.src_id    order by prefix_no      
3Dhttp-8000-11> [2013-04-29 =14:45:21] [PreparedStatement] [27] [DEBUG] {pstm-101042} Parameters: [] 
3Dhttp-8000-11> [2013-04-29 =14:45:21] [PreparedStatement] [27] [DEBUG] {pstm-101042} Types: [] 
3Dhttp-8000-11> [2013-04-29 =14:45:21] [ResultSet] [27] [DEBUG] {rset-101043} ResultSet 
3Dhttp-8000-11> [2013-04-29 =14:45:21] [ResultSet] [27] [DEBUG] {rset-101043} Header: [group_id, parent_group_id, group_name, description, prefix_no, src_id, src_name, default_src_use_yn, default_src_use_yn_name] 
3Dhttp-8000-11> [2013-04-29 =14:45:21] [ResultSet] [27] [DEBUG] {rset-101043} Result: [1, 00, KBS?섏썝 珥앷뎅 援먰솚湲?洹몃９, 理쒖긽??洹몃９, 600, null, null, N, 鍮꾩궗?? 
3Dhttp-8000-11> [2013-04-29 =14:45:21] [ResultSet] [27] [DEBUG] {rset-101043} Result: [77, 1, Tesr2, , 600, 12013042913373043, Test Goup, Y, ?ъ슜 ] 
3Dhttp-8000-11> [2013-04-29 =14:45:21] [ResultSet] [27] [DEBUG] {rset-101043} Result: [75, 1, Test, , 600, 12013042913373043, Test Goup, Y, ?ъ슜 ] 





-- skysbc 작업

2013-05-07

media_list mediaServer 셀렉트박스 추가
fire_wall
route_table



server_idx in
t_ip_route
t_ip_table
t_media_config
t_ntp


<PACKET>
	<FUNCTION TYPE="NTPSTART" COMMAND="REQUEST">
		<VALUE>
			<SERVERNAME>time.bora.net</SERVERNAME>
		</VALUE>
	</FUNCTION>
</PACKET>
<PACKET><FUNCTION TYPE="ADD" COMMAND="REQUEST" TABLE="T_IP_ROUTE"><VALUE><KEY>5</KEY></VALUE></FUNCTION></PACKET>
ServerInfoMgr serverInfoMgr = new ServerInfoMgr();
List option = new ArrayList();

option = serverInfoMgr.serverList(GroupTypeChooseInit.flagMediaList);

int optionSize = option.size()+1;
String[] server_idxs = new String[optionSize-1];

System.out.println("option.size():"+option.size());

for(int i = 0 ; i < option.size(); i ++){	
	ServerListDTO serverListDTO = new ServerListDTO();
	serverListDTO = (ServerListDTO)option.get(i);
	server_idxs[i] = serverListDTO.getIdx()+":"+serverListDTO.getName();
	System.out.println("aaaaaaaaa:"+serverListDTO.getIdx()+":"+serverListDTO.getName());
}



*관리자 계정만 로그인 가능합니다 일반계정으로는 로그인페이지에서 접속할수 없습니다*
ID : 사번
PW : nacf1234

NHPR_Web
IT LAND : http://address//NHPR1020.do
IT Book : http://address//NHPR1022.do

NHPR_Admin
Admin   : http://address//NHPR2207.do ADMIN 


mysql 부하 쿼리

UserAction.update
-> UserMgr.update -> UserBillMsgDAO.updateData
groupMemberIdxUpdate
웹에서는 단일건이라 상관없지만 url 등록시 다량의 건으로 등록될경우 사용됨
jsp 파일업로드
http://nanstrong.tistory.com/54


<struts>
	<package name="ivrMsg" extends="struts-default" namespace="/">
		<action name="GetIvrCheck" class="skycom.pbx.ivrMsg.GetIVRAction">
			<result name="success">/returnMsg.jsp</result>
		</action>
	</package>
</struts>








ifNames[i].toString()lo
false
false
ifNames[i].toString()eth0
true
false
ifNames[i].toString()eth0:1
true
false
ifNames[i].toString()eth1
true
false
ifNames[i].toString()eth1:1
true
false
ifNames[i].toString()eth2
true
false
ifNames[i].toString()sit0
false
false
DBCPMode ---> 0
con:org.apache.commons.dbcp.PoolableConnection@a6aa31Skycom Client Connection: 10922545

:stPathusr/local/tomcat/webapps/skysbc_lg
 
                select 
                          idx
                        , flag
                        , ip_addr
                        , port
                        , name
                        , description
                from t_server_list

[2013-05-09 15:17:08] [DEBUG]?럖kycom.sbc.dao.DAO:select(51)??Elapsed Time [0:00:00.000]
 
                select 
                          idx

			, flag
                        , ip_addr
                        , port
                        , name
                        , description
                from t_server_list



list:2
option.size():2
aaaaaaaaa:11:Server1
aaaaaaaaa:7:Server2
::<option value=11>Server1</option><option value=7>Server2</option>
DBCPMode ---> 0
con:org.apache.commons.dbcp.PoolableConnection@1e75e89Skycom Client Connection: 31940233

:stPathusr/local/tomcat/webapps/skysbc_lg
 
                select 
                          idx
                        , flag
                        , ip_addr
                        , port
                        , name
                        , description
                from t_server_list
                where idx = ?

[2013-05-09 15:17:08] [DEBUG]?럖kycom.sbc.dao.DAO:selectParam(57)??Elapsed Time [0:00:00.000]
 
                select 
                          idx
                        , flag
                        , ip_addr
                        , port
                        , name
                        , description
                from t_server_list
                where idx =  11 /**P*/



list:1
Connect Skyweb
[2013-05-09 15:17:08,473] INFO  skycom.common.TCPCommIPRoute.getMakeXmlMsg(TCPCommIPRoute.java:37)  =>###################################
[2013-05-09 15:17:08,474] INFO  skycom.common.TCPCommIPRoute.getMakeXmlMsg(TCPCommIPRoute.java:38)  =><PACKET><FUNCTION TYPE="IP_ROUTE_LIST" COMMAND="REQUEST"></FUNCTION></PACKET>
[2013-05-09 15:17:08,474] INFO  skycom.common.TCPCommIPRoute.getMakeXmlMsg(TCPCommIPRoute.java:39)  =>###################################
[2013-05-09 15:17:08,478] INFO  skycom.common.TCPCommAbs.sendToServer(TCPCommAbs.java:86)  =>#########RESULT########
[2013-05-09 15:17:08,478] INFO  skycom.common.TCPCommAbs.sendToServer(TCPCommAbs.java:87)  =>
<?xml version="1.0" standalone="no"?>
<PACKET>
	<FUNCTION TYPE="IP_ROUTE_LIST" COMMAND="RESPONSE">
		<ROUTE_INFO>1.1.1.0         0.0.0.0         255.255.255.252 U     0      0        0 eth2</ROUTE_INFO>
		<ROUTE_INFO>210.121.190.0   0.0.0.0         255.255.255.0   U     0      0        0 eth1</ROUTE_INFO>
		<ROUTE_INFO>169.254.0.0     0.0.0.0         255.255.0.0     U     0      0        0 eth2</ROUTE_INFO>
		<ROUTE_INFO>192.168.0.0     0.0.0.0         255.255.0.0     U     0      0        0 eth0</ROUTE_INFO>
		<ROUTE_INFO>0.0.0.0         210.121.190.254 0.0.0.0         UG    0      0        0 eth1</ROUTE_INFO>
	</FUNCTION>
</PACKET>


Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
1.1.1.0         *               255.255.255.252 U     0      0        0 eth2
210.121.190.0   *               255.255.255.0   U     0      0        0 eth1
169.254.0.0     *               255.255.0.0     U     0      0        0 eth2
192.168.0.0     *               255.255.0.0     U     0      0        0 eth0
default         210.121.190.254 0.0.0.0         UG    0      0        0 eth1

//route table FLAGS H --> host
//G gateway 유무
//U 사용중 -->처리안함

if(flags.indexOf("H")>-1){
	ipRouteDTO.setHostFlag(true);
	ipRouteDTO.setRoute_option("-host");
}else{
	ipRouteDTO.setHostFlag(false);
	ipRouteDTO.setRoute_option("-net");
}


[2013-05-09 15:17:08,478] INFO  skycom.common.TCPCommAbs.sendToServer(TCPCommAbs.java:88)  =>#######################
[2013-05-09 15:17:08,479] INFO  skycom.common.TCPCommIPRoute.resultMapMsg(TCPCommIPRoute.java:48)  =>map:
{
1=1.1.1.0         0.0.0.0         255.255.255.252 U     0      0        0 eth2, 
2=210.121.190.0   0.0.0.0         255.255.255.0   U     0      0        0 eth1,
3=169.254.0.0     0.0.0.0         255.255.0.0     U     0      0        0 eth2, 
4=192.168.0.0     0.0.0.0         255.255.0.0     U     0      0        0 eth0,
5=0.0.0.0         210.121.190.254 0.0.0.0         UG    0      0        0 eth1, 
all_count=5
}



route_key-->  1.1.1.0,          0.0.0.0,           255.255.255.252,    eth2
route_key-->  210.121.190.0,    0.0.0.0,           255.255.255.0,      eth1
route_key-->  169.254.0.0,      0.0.0.0,           255.255.0.0,        eth2
route_key-->  192.168.0.0,      0.0.0.0,           255.255.0.0,        eth0
route_key-->  0.0.0.0,          210.121.190.254,   0.0.0.0,            eth1
DBCPMode ---> 0
con:org.apache.commons.dbcp.PoolableConnection@a6aa31Skycom Client Connection: 10922545

:stPathusr/local/tomcat/webapps/skysbc_lg
 
        SELECT idx
              ,destination
              ,route_option
              ,gateway
              ,genmask
              ,iface
              ,note
          FROM t_ip_route
         WHERE use_yn = 1
         and server_idx = ?
         ORDER BY idx   

[2013-05-09 15:17:08] [DEBUG]?럖kycom.sbc.dao.DAO:selectParam(57)??Elapsed Time [0:00:00.000]
 
        SELECT idx
              ,destination
              ,route_option
              ,gateway
              ,genmask
              ,iface
              ,note
          FROM t_ip_route
         WHERE use_yn = 1
         and server_idx =  11 /**P*/
         ORDER BY idx   



db_route_key-->17.1.1.2,22.22.22.22,22.22.22.11,eth1[skycom.sbc.dto.IPRouteDTO@e3f6d]
key:0.0.0.0,210.121.190.254,0.0.0.0,eth1[null]
S-->0.0.0.0,210.121.190.254,0.0.0.0,eth1
key:192.168.0.0,0.0.0.0,255.255.0.0,eth0[null]
S-->192.168.0.0,0.0.0.0,255.255.0.0,eth0
key:210.121.190.0,0.0.0.0,255.255.255.0,eth1[null]
S-->210.121.190.0,0.0.0.0,255.255.255.0,eth1
key:169.254.0.0,0.0.0.0,255.255.0.0,eth2[null]
S-->169.254.0.0,0.0.0.0,255.255.0.0,eth2
key:1.1.1.0,0.0.0.0,255.255.255.252,eth2[null]
S-->1.1.1.0,0.0.0.0,255.255.255.252,eth2
key:17.1.1.2,22.22.22.22,22.22.22.11,eth1[null]
D-->17.1.1.2,22.22.22.22,22.22.22.11,eth1
5
str=>D
str=>17.1.1.2
str=>-net
str=>22.22.22.11
str=>22.22.22.22
str=>eth1
str=>1
str=>S
str=>0.0.0.0
str=>-net
str=>0.0.0.0
str=>210.121.190.254
str=>eth1
str=>
str=>S
str=>192.168.0.0
str=>-net
str=>255.255.0.0
str=>0.0.0.0
str=>eth0
str=>
str=>S
str=>210.121.190.0
str=>-net
str=>255.255.255.0
str=>0.0.0.0
str=>eth1
str=>
str=>S
str=>169.254.0.0
str=>-net
str=>255.255.0.0
str=>0.0.0.0
str=>eth2
str=>
str=>S
str=>1.1.1.0
str=>-net
str=>255.255.255.252
str=>0.0.0.0
str=>eth2
str=>



db 에 등록이 되어있으면 체크박스 true  Apply to server 켜짐
체크박스 false 인것은 리눅스 서버의 route 정보



 <cell>
<%
	if(existYn.equals("D")){
		out.println("<![CDATA[Apply to server^javascript:applyToServer("+func.f_NullCheck(dto.getIdx())+","+server_idx+");^_self]]>");
	}
%>
</cell>


[오후 4:19:50] kubugi@msn.com:  mygrid = new dhtmlXGridObject("groupGrid");
 mygrid.setImagePath("sys/common/dhtmlxGrid/codebase/imgs/");
 mygrid.setInitWidths("30,30,0,0,0,0,0,0,*,60,60,60,60,60,60,60,60,200,0");
 mygrid.setHeader(    ",No,default_yn,startHour,startMin,endHour,endMin,alldayYN,Ment,Mon,Tue,Wed,Thu,Fri,Sat,Sun,Holiday,Time,aa_ment_index");
 mygrid.setColumnIds( ",index,default_yn,startHour,startMin,endHour,endMin,alldayYN,ment_name,day_mon,day_tue,day_wed,day_thu,day_fri,day_sat,day_sun,day_holiday,Time,aa_ment_index");
 mygrid.setColAlign(  "center,center,center,center,center,center,center,center,center,center,center,center,center,center,center,center,center,center,center");
 mygrid.setColTypes(  "ch,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro");
 mygrid.setColSorting("na,na,na,na,na,na,na,na,na,na,na,na,na,na,na,na,na,na,na,na");
 mygrid.setColumnHidden(mygrid.getColIndexById('defaultYN'),true);
 mygrid.setColumnHidden(mygrid.getColIndexById('startHour'),true);
 mygrid.setColumnHidden(mygrid.getColIndexById('startMin'),true);
 mygrid.setColumnHidden(mygrid.getColIndexById('endHour'),true);
 mygrid.setColumnHidden(mygrid.getColIndexById('endMin'),true);
 mygrid.setColumnHidden(mygrid.getColIndexById('alldayYN'),true);
 mygrid.init();

 int maxSize = 20 * 1024* 1024; // 최대 업로드 파일 크기 10MB로 제한
boolean flag = false;

	try{
		File dir = new File(savePath);
		if(!dir.exists()){
			dir.mkdirs();
		}else{
		    MultipartRequest multi = new MultipartRequest(request,savePath, maxSize, "UTF-8" );		    		     
		    Enumeration files = multi.getFileNames();
		    String file = (String)files.nextElement();
		    String fileName = multi.getFilesystemName(file);
		    String origFileName = multi.getOriginalFileName(file);	      
		    System.out.println("fileName : " + fileName);
		    System.out.println("origFileName : " + origFileName);
		    str = "업로드가 성공하였습니다.";
		    flag = true;
		}	
		
	    	    
	}catch (Exception e) {
		str = "업로드가 실패하였습니다.";
		e.printStackTrace();
	}
	out.println(func.showAlert(str));


	/usr/local/skycom/var/tone

SELECT column1 FROM t1 WHERE EXISTS (SELECT * FROM t2);

t2가 존재한다면 t1을 SELECT 하게 된다..



globaldir
192.168.0.243:8020 


웹페이지 nx -> 국내 사이트 페이지로 변경시 수정작업
1. /usr/local/tomcat/webapps/SkyProxy/loginFailed.jsp -> login.jsp 를  loginK.jsp 로 변경
2. /usr/local/tomcat/webapps/SkyProxy/sys/include/includeFile.jsp ->
	<link rel="stylesheet" type="text/css" href="<%=cp%>/css/style.css"></link> - > styleK.css 로 변경
3. /usr/local/tomcat/webapps/SkyProxy/WEB-INF/decorators.xml -> <decorator name="layout" page="layout.jsp"> -> layoutK.jsp 변경
4. /usr/local/tomcat/webapps/SkyProxy/WEB-INF/classes/login.xml ->login.jsp 를 loginK.jsp 변경

nx 페이지 원복은 반대로 하시면 됩니다.


Connect Skyweb
[2013-05-15 11:33:43,320] INFO  skycom.common.TCPCommIPTable.getMakeXmlMsg(TCPCommIPTable.java:37)  =>###################################
log4j: /usr/local/tomcat/logs/skysbc/skysbc.log -> /usr/local/tomcat/logs/skysbc/skysbc.log.2013-05-14
log4j: setFile called: /usr/local/tomcat/logs/skysbc/skysbc.log, false
log4j: setFile ended
[2013-05-15 11:33:43,321] INFO  skycom.common.TCPCommIPTable.getMakeXmlMsg(TCPCommIPTable.java:38)  =>
<PACKET><FUNCTION TYPE="SKYFIREWALL" COMMAND="REQUEST"></FUNCTION></PACKET>
[2013-05-15 11:33:43,321] INFO  skycom.common.TCPCommIPTable.getMakeXmlMsg(TCPCommIPTable.java:39)  =>###################################
[2013-05-15 11:33:43,417] INFO  skycom.common.TCPCommAbs.sendToServer(TCPCommAbs.java:86)  =>#########RESULT########
[2013-05-15 11:33:43,418] INFO  skycom.common.TCPCommAbs.sendToServer(TCPCommAbs.java:87)  =>
<?xml version="1.0" standalone="no"?>
<PACKET>
        <FUNCTION TYPE="SKYFIREWALL" COMMAND="RESPONSE" RESULT="SUCCESS">
		<MESSAGE>Success</MESSAGE>      
	</FUNCTION>
</PACKET>


<PACKET><FUNCTION TYPE="PUBLISH_DIR_ADD" COMMAND="REQUEST">
<DIR_INFO><LOCAL>/usr/local/skycom/var/test/test1</LOCAL><LINK>media1/test/test1</LINK></DIR_INFO></FUNCTION></PACKET>
[2013-05-16 09:44:00,312] INFO  skycom.common.TCPCommGlobalDirectory.getMakeXmlMsg(TCPCommGlobalDirectory.java:48)  =>###################################
[2013-05-16 09:44:00,328] INFO  skycom.common.TCPCommAbs.sendToServer(TCPCommAbs.java:86)  =>#########RESULT########
[2013-05-16 09:44:00,328] INFO  skycom.common.TCPCommAbs.sendToServer(TCPCommAbs.java:87)  =>Success


<?xml version="1.0" standalone="no"?>
<PACKET>
  <FUNCTION TYPE="PUBLISH_DIR_LIST" COMMAND="RESPONSE">
    <DIR_INFO>/usr/local/skycom/var/record</DIR_INFO>
    <DIR_INFO>/usr/local/skycom/var/record/data1</DIR_INFO>
    <DIR_INFO>/usr/local/skycom/var/record/data2</DIR_INFO>
    <DIR_INFO>/usr/local/skycom/var/record/data4</DIR_INFO>
  </FUNCTION>
</PACKET>


 <?xml version="1.0" standalone="no"?>
<PACKET>
  <FUNCTION TYPE="GLOBAL_DIR_LIST" COMMAND="RESPONSE">
    <PUBLISH>
        <DIR_INFO>/sky_gdir/server1/dir2</DIR_INFO>
    </PUBLISH>
    <PUBLISH>
        <DIR_INFO>/sky_gdir/server1/dir1</DIR_INFO>
    </PUBLISH>
    <GLOBAL>
        <DIR_INFO>/server2/out   192.168.0.2:/usr/local/skycom/var/dir3</DIR_INFO>
    </GLOBAL>
    <GLOBAL>
        <DIR_INFO>/server2/ilbe  192.168.0.2:/usr/local/skycom/var/dir4</DIR_INFO>
    </GLOBAL>
  </FUNCTION>
</PACKET>

	//parse
/*
Document doc = builder.build(new InputSource(new StringReader(parameter)));
Element formData = doc.getRootElement(); 
List field = formData.getChildren("var");			
for(int i=0 ; i<field.size();i++){
	Element var = (Element)field.get(i);
	hMap.put(var.getAttributeValue("name"), var.getAttributeValue("value"));
}
	

String f_type = (String)hMap.get("forward_type");
e164 = (String)hMap.get("e164");
fno = (String)hMap.get("fno");
type = (String)hMap.get("type");
work_type = (String)hMap.get("work_type");
forward_type = Integer.parseInt(f_type);
dial_no = (String)hMap.get("dial_no");
from_server = (String)hMap.get("from_server");
hashdata = (String)hMap.get("hashdata");
*/			 
//parse end	



   SELECT idx    ,f_key    ,ip    ,user_name    ,user_pw    ,path    ,auth    ,type    ,port    ,date_folder    ,bDelete    FROM t_record_policy_group    ORDER BY IDX    LIMIT ? OFFSET ?   
[16:45:30] DEBUG [http-8000-11] -{pstm-100374} Executing Statement:   SELECT idx    ,f_key    ,ip    ,user_name    ,user_pw    ,path    ,auth    ,type    ,port    ,date_folder    ,bDelete    FROM t_record_policy_group    ORDER BY IDX    LIMIT ? OFFSET ?   
[16:45:30] DEBUG [http-8000-11] -{pstm-100374} Parameters: [15, 0]
[16:45:30] DEBUG [http-8000-11] -{pstm-100374} Types: [java.lang.Integer, java.lang.Integer]
[16:45:30] DEBUG [http-8000-11] -{rset-100375} ResultSet
[16:45:30] DEBUG [http-8000-11] -{rset-100375} Header: [idx, f_key, ip, user_name, user_pw, path, auth, type, port, date_folder, bDelete]
[16:45:30] DEBUG [http-8000-11] -{rset-100375} Result: [10005, 9999, 210.121.190.210, sshdbwj, tjqjqjsgh@!)sshdbwj, /home/sshdbwj/KDG, 1, 1, 62200, null, null]
[16:45:30] DEBUG [http-8000-11] -{rset-100375} Result: [10006, 1, 211.192.139.139, root, tjqjqjsgh@!)sshdbwj, /var/www/html/network/_upload/update/epnph, 2, 1, null, 1, 0]








>>
<PACKET><FUNCTION TYPE="PUBLISH_DIR_LIST" COMMAND="REQUEST"></FUNCTION></PACKET>

<<
<?xml version="1.0" standalone="no"?>
<PACKET>
  <FUNCTION TYPE="PUBLISH_DIR_LIST" COMMAND="RESPONSE">
    <DIR_INFO>/usr/local/skycom/var/record</DIR_INFO>
    <DIR_INFO>/usr/local/skycom/var/record/data1</DIR_INFO>
    <DIR_INFO>/usr/local/skycom/var/record/data2</DIR_INFO>
    <DIR_INFO>/usr/local/skycom/var/record/data4</DIR_INFO>
  </FUNCTION>
</PACKET>


>>
<PACKET><FUNCTION TYPE="GLOBAL_DIR_LIST" SERVER="server1" COMMAND="REQUEST"></FUNCTION></PACKET>

<<
<?xml version="1.0" standalone="no"?>
<PACKET>
    <FUNCTION TYPE="GLOBAL_DIR_LIST" COMMAND="RESPONSE">
        <PUBLISH>
		<LOCAL>/usr/local/skycom/var/record</LOCAL>
		<LINK>server1/record</LINK>

		<LOCAL>/usr/local/skycom/var/record//data1</LOCAL>
		<LINK>server1/record//data1</LINK>
        </PUBLISH>
        <GLOBAL>
            <DIR_INFO>
                <LOCAL>/server2/out</LOCAL>
                <REMOTE>192.168.0.2:/usr/local/skycom/var/dir3</REMOTE>
            </DIR_INFO>
            <DIR_INFO>
                <LOCAL>/server2/ilbe</LOCAL>
                <REMOTE>192.168.0.2:/usr/local/skycom/var/dir4</REMOTE>
            </DIR_INFO>
        </GLOBAL>
    </FUNCTION>
</PACKET>

//parse
			/*
			Document doc = builder.build(new InputSource(new StringReader(parameter)));
			Element formData = doc.getRootElement(); 
			List field = formData.getChildren("var");			
			for(int i=0 ; i<field.size();i++){
				Element var = (Element)field.get(i);
				hMap.put(var.getAttributeValue("name"), var.getAttributeValue("value"));
			}
				
			
			String f_type = (String)hMap.get("forward_type");
			e164 = (String)hMap.get("e164");
			fno = (String)hMap.get("fno");
			type = (String)hMap.get("type");
			work_type = (String)hMap.get("work_type");
			forward_type = Integer.parseInt(f_type);
			dial_no = (String)hMap.get("dial_no");
			from_server = (String)hMap.get("from_server");
			hashdata = (String)hMap.get("hashdata");
			*/			 




<?xml version="1.0" standalone="no"?> <PACKET> <FUNCTION TYPE="PUBLISH_DIR_ADD" 
COMMAND="RESPONSE" RESULT="Success"> <MESSAGE>SUCCESS</MESSAGE> </FUNCTION> 
</PACKET>

<?xml version="1.0" standalone="no"?>
<PACKET>
	<FUNCTION TYPE="PUBLISH_DIR_ADD" COMMAND="RESPONSE" RESULT="ExistLink">
		<MESSAGE>FAIL</MESSAGE>
	</FUNCTION>
</PACKET>


 exportfs -ra


 mount -t nfs 192.168.0.233:/usr/local/skycom/var/park1 /sky_gdir/server1/park2



 192.168.0.218 / SKYIVR / t_ivr_monitor
[오전 9:16:25] 광효 남: 값 의미는 대충 아실듯한디..elg랑은 좀 달라여 tenant도 없고  service_type도 없어요
[오전 9:16:35] 광효 남: elg 하면서 추가된거라..기존꺼엔 없어요

<%@ page contentType = "text/html;charset=UTF-8" %><%@ taglib prefix="s"uri="/struts-tags" %><s:property value = "returnMsg"/>
<%@ page trimDirectiveWhitespaces="true" %> 공백제거 엔터제거

vmsMonitoring.countAll


  insert into t_ringingset (       set_code,set_value,set_div,src_id,description,from_day,from_hour, 
  from_min,to_day,to_hour,to_min,update_id,update_date)    values(    (
  select c.set_code from t_group_ringingset c,t_user b  
  where b.user_id = 'root' and b.group_id = c.group_id),'20130521', '06','12013042913373043','000000000','20130521',lpad('00',2,'0'),lpad('00',2,'0'),   
  '20130521',lpad('23',2,'0'),lpad('59',2,'0'),'root',    date_format(now(),'%Y%m%d%H%i%s'))      
3Dhttp-8000-8> [2013-05-21 =14:26:42] [PreparedStatement] [27] [DEBUG] {pstm-100676} Executing Statement:       
insert into t_ringingset (      
set_code,
set_value,
set_div,
src_id,description,from_day,from_hour,       from_min,to_day,to_hour,to_min,update_id,update_date)  
values(    (
select c.set_code from t_group_ringingset c,t_user b     where b.user_id = 'root' and b.group_id = c.group_id),'20130521',    '06','12013042913373043','000000000','20130521',lpad('00',2,'0'),lpad('00',2,'0'),    '20130521',lpad('23',2,'0'),lpad('59',2,'0'),'root',    date_format(now(),'%Y%m%d%H%i%s'))      


3Dhttp-8000-8> [2013-05-21 =14:34:23] [Connection] [27] [DEBUG] {conn-100680} Connection 
3Dhttp-8000-8> [2013-05-21 =14:34:23] [Connection] [27] [DEBUG] {conn-100680} Preparing Statement:                
select seq,set_code,(concat(concat(from_day, '-'), to_day) )AS set_value,a.description,a.src_id,w.src_name,from_day,from_hour,from_min,          to_day,to_hour,to_min,          (concat(concat(concat(concat(concat(concat(from_hour, ':'), from_min), '-'), to_hour), ':'), to_min) )AS set_time    from t_ringingset a    LEFT OUTER JOIN t_mellodysrc w  ON a.src_id = w.src_id    where set_code = (select c.set_code from t_group_ringingset c,t_user b             where b.user_id = 'root'             and b.group_id = c.group_id)    and set_div='06'    and set_value like concat('201305', '%')    order by set_value,from_hour,from_min,to_hour,to_min          
3Dhttp-8000-8> [2013-05-21 =14:34:23] [PreparedStatement] [27] [DEBUG] {pstm-100681} Executing Statement:                    select seq,set_code,(concat(concat(from_day, '-'), to_day) )AS set_value,a.description,a.src_id,w.src_name,from_day,from_hour,from_min,          to_day,to_hour,to_min,          (concat(concat(concat(concat(concat(concat(from_hour, ':'), from_min), '-'), to_hour), ':'), to_min) )AS set_time    from t_ringingset a    LEFT OUTER JOIN t_mellodysrc w  ON a.src_id = w.src_id    where set_code = (select c.set_code from t_group_ringingset c,t_user b             where b.user_id = 'root'             and b.group_id = c.group_id)    and set_div='06'    and set_value like concat('201305', '%')    order by set_value,from_hour,from_min,to_hour,to_min          
3Dhttp-8000-8> [2013-05-21 =14:34:23] [PreparedStatement] [27] [DEBUG] {pstm-100681} Parameters: [] 
3Dhttp-8000-8> [2013-05-21 =14:34:23] [PreparedStatement] [27] [DEBUG] {pstm-100681} Types: [] 
3Dhttp-8000-8> [2013-05-21 =14:34:23] [ResultSet] [27] [DEBUG] {rset-100682} ResultSet 


<div class="basicBox"><img src="<%=imagePath%>/point.gif" /><b class="blackb">고객오더관리</b></div>
<div class="searchBox">
	<table>
		<tr>
			<td><img src="<%=imagePath%>/img01.gif" /></td>
			<td><img src="<%=imagePath%>/point2.gif" /></td>
			<td>요청시간</td>
			<td><s:textfield name="sdate" id="sdate"  cssStyle="width: 90px"/> ~ 
			    <s:textfield name="edate" id="edate"  cssStyle="width: 90px"/></td>
			<td><img src="<%=imagePath%>/point2.gif" /></td>
			<td>객실구분</td>
			<td><s:select name="room_type"
						id="room_type"
						list="roomTypeList"
						listKey="id"
						listValue="name"
						disabled='false'
						cssStyle="width:100px"
						headerKey=""
						headerValue="전체"
					/></td>
			<td><img src="<%=imagePath%>/point2.gif" /></td>
			<td><s:select name="searchGubun"
						id="searchGubun"
						list="searchGubunList"
						listKey="id"
						listValue="name"
						disabled='false'
						cssStyle="width:100px"
					/></td>
			<td><s:textfield id="searchTxt" name="searchTxt" cssStyle="width:100px"/></td>
			<td><img src="<%=imagePath%>/point2.gif" /></td>
			<td>처리상태</td>
			<td>
				<s:if test="jobStateList != null">
					<s:select name="jobState"
						id="jobState"
						list="jobStateList"
						listKey="id"
						listValue="name"
						disabled='false'
						cssStyle="width:80px"
						headerKey=""
						headerValue="-- 전체 --"
					/>
				</s:if>
			</td>
			<td><div id="gBtn17"><a href="javascript: search()"><span>조회</span></a></div></td>
			<td></td>	
		</tr>
	</table>
</div>
WHERE process_idx = 1 AND inbound<>1 해비치
WHERE process_idx = 3 AND inbound<>1 회사

해비치 

select * from t_menu;
--insert into t_menu values('020','001','2','IVR Monitoring','monitoring.action',null,null,null,4);
select * from t_auth_menu;
--insert into t_auth_menu values('1','020',null,'admin','20130523131214','1','0');



/*+ ALL_ROWS */ 
explicitly chooses the cost-based approach to optimize a statement 
block with a goal of best throughput (that is, minimum 
total resource consumption) 
가장 좋은 단위 처리량의 목표로 문 블록을 최적화하기 위해 cost-based 
접근 방법을 선택합니다. (즉, 전체적인 최소의 자원 소비) 


/*+ CHOOSE */ 
causes the optimizer to choose between the rule-based 
approach and the cost-based approach for a SQL statement 
based on the presence of statistics for the tables accessed by 
the statement 
최적자(optimizer)가 그 문에 의해 접근된 테이블을 위해 통계의 존재에 
근거를 두는 SQL 문을 위해 rule-based 접근 방법과 cot-based 접근 방법 
사이에 선택하게 합니다. 

/*+ FIRST_ROWS */ 
explicitly chooses the cost-based approach to optimize a statement 
block with a goal of best response time (minimum 
resource usage to return first row) 
가장 좋은 응답 시간의 목표로 문 블록을 최적화하기 위해 cost-based 접근 
방법을 선택합니다. (첫번째 행을 되돌려 주는 최소의 자원 사용) 

/*+ RULE */ 
explicitly chooses rule-based optimization for a statement 
block 
문 블록을 위하여, rule-based 최적화를 고르는 

/*+ AND_EQUAL(table index) */ 
explicitly chooses an execution plan that uses an access path 
that merges the scans on several single-column indexes 
그만큼 실행 계획을 선택합니다. 그리고 여럿의 single-column 색인에 
그 scan을 합병하는 접근 경로를 사용합니다. 

/*+ CLUSTER(table) */ 
explicitly chooses a cluster scan to access the specified table 
선택합니다. 그리고, 클러스터는 그 명시된 테이블을 접근하기 위해 살핍니다. 

/*+ FULL(table) */ 
explicitly chooses a full table scan for the specified table 
그 명시된 테이블을 위하여, 전체 테이블 scan을 고르는 

/*+ HASH(table) */ 
explicitly chooses a hash scan to access the specified table 
선택합니다. 그리고, 해쉬는 그 명시된 테이블을 접근하기 위해 운율을 살핍니다. 

/*+ HASH_AJ(table) */ 
transforms a NOT IN subquery into a hash antijoin to access 
the specified table 
변환, 그 명시된 테이블을 접근하는 해쉬 antijoin으로의 NOT IN 부속 조회 

/*+ HASH_SJ (table) */ 
transforms a NOT IN subquery into a hash anti-join to access 
the specified table 
변환, 그 명시된 테이블을 접근하는 해쉬 anti-join으로의 NOT IN 부속 조회 

/*+ INDEX(table index) */ 
explicitly chooses an index scan for the specified table 
그 명시된 테이블을 위하여, 색인 scan을 고르는 

/*+ INDEX_ASC(table index) */ 
explicitly chooses an ascending-range index scan for the specified 
table 
그 명시된 테이블을 위하여, ascending-range 색인 scan을 고르는 

/*+ INDEX_COMBINE(table index) */ 
If no indexes are given as arguments for the INDEX_COMBINE 
hint, the optimizer uses whatever Boolean combination 
of bitmap indexes has the best cost estimate. If particular 
indexes are given as arguments, the optimizer tries to use 
some Boolean combination of those particular bitmap indexes. 
어떤 색인도 INDEX_COMBINE 암시를 위해 인수로서 주어지지 않는다면, 
bitmap 색인의 결합이 어떤 부울의를 가장 좋은 수행 난이도 평가를 가지고 
있든지 최적자는 이용합니다. 
특별한 색인이 인수로서 주어진다면, 최적자는 그 특별한 bitmap 색인의 
몇몇의 부울의 결합을 사용하려고 노력합니다. 

/*+ INDEX_DESC(table index) */ 
explicitly chooses a descending-range index scan for the specified 
table 
그 명시된 테이블을 위하여, descending-range 색인 scan을 고르는 

/*+ INDEX_FFS(table index) */ 
causes a fast full index scan to be performed rather than a full 
table scan 
빠른 전체 색인 scan이 전체 테이블 scan이라기보다는 수행되게 합니다. 

/*+ MERGE_AJ (table) */ 
transforms a NOT IN subquery into a merge anti-join to access 
the specified table 
변환, NOT IN 부속 조회, 그 명시된 테이블을 접근하기 위해 anti-join을 
합병합니다. 

/*+ MERGE_SJ (table) */ 
transforms a correlated EXISTS subquery into a merge semi-join 
to access the specified table 
변환, 관련된 EXISTS 부속 조회, 접근으로 semi-join을 합병합니다, 
그 명시된 테이블 

/*+ ROWID(table) */ 
explicitly chooses a table scan by ROWID for the specified 
table 
그 명시된 테이블을 위하여, ROWID에 의해 테이블 scan을 고르는 

/*+ USE_CONCAT */ 
forces combined OR conditions in the WHERE clause of a 
query to be transformed into a compound query using the 
UNION ALL set operator 
힘은 질의의 WHERE 문절에 있는 UNION ALL 집합 연산자를 사용하는 합성의 
질의로 변형되는 OR 조건을 합쳤습니다. 

/*+ ORDERED */ 
causes Oracle to join tables in the order in which they appear 
in the FROM clause 
오라클이 어느 것에 순서로 테이블을 결합시키게 합니다. 

/*+ STAR */ 
forces the large table to be joined last using a nested-loops join 
on the index 
큰 있는 테이블이 최종 사용/회전율에 nested-loops를 결합시킨 힘은 
그 색인에 결합합니다. 

/*+ DRIVING_SITE (table) */ 
forces query execution to be done at a different site from that 
selected by Oracle 
힘은 그것과 다른 오라클에 의해 선택된 사이트에 되는 실행을 질의합니다. 

/*+ USE_HASH (table) */ 
causes Oracle to join each specified table with another row 
source with a hash join 
오라클이 테이블이 다른 행 자원으로 해쉬 접합으로 명시되면서 각자와 
합치게 합니다. 

/*+ USE_MERGE (table) */ 
causes Oracle to join each specified table with another row 
source with a sort-merge join 
오라클이 테이블이 다른 행 자원으로 sort-merge 접합으로 명시되면서 각자와 
합치게 합니다. 

/*+ USE_NL (table) */ 
causes Oracle to join each specified table to another row 
source with a nested-loops join using the specified table as the 
inner table 
오라클이 그 명시된 테이블을 그 안의 테이블로 사용하는 nested-loops 접합과 
각자와 다른 행 자원에 대한 명시된 테이블을 합치게 합니다. 

/*+ APPEND */ , /*+ NOAPPEND */ 
specifies that data is simply appended (or not) to a table; existing 
free space is not used. Use these hints only following the 
INSERT keyword. 
데이타가 테이블로 단순히 덧붙여진다는 (or not)것 명시합니다; 무료인 
현존하는 영역은 사용되지 않습니다. 
단지 그 삽입 키 핵심어를 따르는 이 암시를 사용하시오. 

/*+ NOPARALLEL(table) */ 
disables parallel scanning of a table, even if the table was created 
with a PARALLEL clause 
그 테이블이 PARALLEL 문절로 새로 만들어졌다면 테이블의 평행의 순차 검색을 
무능하게 만듭니다. 

/*+ PARALLEL(table, instances) */ 
allows you to specify the desired number of concurrent slave 
processes that can be used for the operation. 
DELETE, INSERT, and UPDATE operations are considered for 
parallelization only if the session is in a PARALLEL DML 
enabled mode. (Use ALTER SESSION PARALLEL DML to 
enter this mode.) 
당신이 그 연산을 위해 사용될 수 있는 동시의 슬레이브(slave) 프로세스의 
요구된 수를 명시하는 것을 허락합니다. 
그 세션이 가능하게 된 PARALLEL DML에 모드를 있다면, DELETE, INSERT, UPDATE 
연산은 단지 parallelization에 대해 고려됩니다. (사용은 이 모드에 들어가기 
위해 평행의 세션 DML을 변경합니다.) 

/*+ PARALLEL_INDEX 
allows you to parallelize fast full index scan for partitioned 
and nonpartitioned indexes that have the PARALLEL attribute 
parallelize에 당신에게 빠른 가득한 색인 scan을 허락합니다. 그런데, 
그것은 PARALLEL 속성을 가지고 있는 색인을 분할했고 nonpartitioned했습니다. 

/*+ NOPARALLEL_INDEX */ 
overrides a PARALLEL attribute setting on an index 
병렬이 색인을 나아가는 것을 속하게 하는 대체 

/*+ CACHE */ 
specifies that the blocks retrieved for the table in the hint are 
placed at the most recently used end of the LRU list in the 
buffer cache when a full table scan is performed 
그 블록이 찾아서 가져왔다는 것을 명시합니다. 그리고 그 테이블을 위해 
그 암시에 놓여집니다. 그런데, 그것은 가장 요즈음 사용된 언제 그 버퍼 캐쉬, 
가득한 테이블 scan에 있는 LRU 리스트의 끝입니다. 수행됩니다. 

/*+ NOCACHE */ 
specifies that the blocks retrieved for this table are placed at 
the least recently used end of the LRU list in the buffer cache 
when a full table scan is performed 
그 명시합니다. 그리고, 그 블록은 이 테이블을 위해 검색되면서 요즈음 사용된 
언제 그 버퍼 캐쉬, 가득한 테이블 scan에 있는 LRU 리스트의 가장 작은 끝에 
놓여집니다. 수행됩니다. 

/*+ MERGE (table) */ 
causes Oracle to evaluate complex views or subqueries before 
the surrounding query 
오라클이 그 둘러싸는 질의 전에 복잡한 뷰나 부속 조회를 평가하게 합니다. 

/*+ NO_MERGE (table) */ 
causes Oracle not to merge mergeable views 
오라클이 mergeable 뷰를 합병하지 않게 하지 않습니다 

/*+ PUSH_JOIN_PRED (table) */ 
causes the optimizer to evaluate, on a cost basis, whether or 
not to push individual join predicates into the view 
개개 접합을 미는 것이 그 뷰 안으로 단정 하든 간에 비용 방식으로 최적자가 
평가하게 합니다. 

/*+ NO_PUSH_JOIN_PRED (table) */ 
Prevents pushing of a join predicate into the view 
접합 술부 중에서 그 뷰로 밀면서, 막는 

/*+ PUSH_SUBQ */ 
causes nonmerged subqueries to be evaluated at the earliest 
possible place in the execution plan 
원인은 그 실행 계획에서의 가장 이른 가능한 장소에 평가되는 부속 조회를 
nonmerged했습니다. 

/*+ STAR_TRANSFORMATION */ 
makes the optimizer use the best plan in which the transformation 
has been used. 
최적자가 그 변형이 사용된 가장 좋은 계획을 사용하는 제작 
출처 : Tong - bassdot님의 오라클통



(주)대한항공-국제선	(주)대한항공-국제선	000000000	201301
(주)대한항공-국제선	(주)대한항공-국제선	000000000	201303
(주)대한항공-국제선	dept테스트	        000000001	201304
(주)대한항공-국제선	test2	                000000002	201302

201302  201301
201303  201302
	201303
	201304
	201305




[오전 10:19:52] 현섭 양: nohup /usr/local/skycom/bin/skyservice.sh start &


File _file = new File(serverFullPath);
				if(_file.exists()){
					String str = "000";
					GetCodec getCodec = new GetCodec();
					String a = basePath+"/"+fileName;
					if((str = getCodec.getCodec(a, a)).equals("000")){
						flag = true;
					}else{
						returnMessage = str;
						return false;
					}
				}else{
					returnMessage = "Wave format only support";
					return false;
				}
				
				if(flag){
					for(int i = 0; i<3; i++){
						
						if(g711u == i){
							upFile = fileName+".g711u";
						}else if(g711a == i){
							upFile = fileName+".g711a";
						}else{
							upFile = fileName+".g729a";
						}
						
						//File dstfile = new File(basePath+upFile);
						
						System.out.println();
						file = new File(basePath+"/"+upFile);
						if(!file.exists()){
							returnMessage = "error";
							flag = false;
							break;
						}
					}
				}




skyweb 실행
[오후 5:28:54] 현섭 양: /usr/local/skycom/bin/skyservice start & 


function selectDisabled(value){
	if(value == '0'){
		$("#group_idx").removeAttr("disabled");
	}else{
		$("#group_idx").attr("disabled", "disabled");	
	}
	
}




요청 
<?xml version="1.0" standalone="yes"?>
<PACKET>
	<FUNCTION TYPE="PROCESS_STATE_CHANGE" COMMAND="REQUEST"></FUNCTION>
</PACKET>
응답 
<?xml version="1.0" standalone="yes"?>
	<PACKET>
		<FUNCTION TYPE="PROCESS_STATE_CHANGE" COMMAND="RESPONSE">
			<RESULT>SUCCESS or FAIL</RESULT>
		</FUNCTION>
	</PACKET>

#########RESULT########
[2013-06-15 16:05:03,087] INFO  skycom.common.TCPCommAbs.sendToServer(TCPCommAbs.java:87)  =>
<?xml version="1.0" standalone="no"?>
<PACKET>
	<FUNCTION TYPE="LIST" COMMAND="RESPONSE" ADDR="210.121.190.217" HOSTN="localhost.localdomain">
		<PROCESS>
			<NAME>skylog</NAME>
			<PID>31437</PID>
			<STATUS>RUN</STATUS>
		</PROCESS>
		<PROCESS>
			<NAME>skyweb</NAME>
			<PID>7945</PID>
			<STATUS>RUN</STATUS>
		</PROCESS>
		<PROCESS>
			<NAME>skysignal</NAME>
			<PID>15542</PID>
			<STATUS>RUN</STATUS>
		</PROCESS>
		<PROCESS>
			<NAME>skycall</NAME>
			<PID>23283</PID>
			<STATUS>RUN</STATUS>
		</PROCESS>
		<PROCESS>
			<NAME>skyagentsignal</NAME>
			<PID>582</PID>
			<STATUS>RUN</STATUS>
		</PROCESS>
		<PROCESS>
			<NAME>skyagentcall</NAME>
			<PID>30545</PID>
			<STATUS>RUN</STATUS>
		</PROCESS>
		<PROCESS>
			<NAME>skymedia</NAME>
			<PID>10775</PID>
			<STATUS>RUN</STATUS>
		</PROCESS>
		<PROCESS>
			<NAME>skymedia</NAME>
			<PID>10960</PID>
			<STATUS>RUN</STATUS>
		</PROCESS>
		<PROCESS>
			<NAME>skytonesignal</NAME>
			<PID>2949</PID>
			<STATUS>RUN</STATUS>
		</PROCESS>
		<PROCESS>
			<NAME>skytonecall</NAME>
			<PID>22089</PID>
			<STATUS>RUN</STATUS>
		</PROCESS>
		<PROCESS>
			<NAME>skytonemedia</NAME>
			<PID>2997</PID>
			<STATUS>RUN</STATUS>
		</PROCESS>
		<PROCESS>
			<NAME>skyresc</NAME>
			<PID>23047</PID>
			<STATUS>RUN</STATUS>
		</PROCESS>
		<PROCESS>
			<NAME>skyrescmanager</NAME>
			<PID>23053</PID>
			<STATUS>RUN</STATUS>
		</PROCESS>
	</FUNCTION>
</PACKET>





-startup
plugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar
--launcher.library
plugins/org.eclipse.equinox.launcher.win32.win32.x86_64_1.1.200.v20120522-1813
-product
org.eclipse.epp.package.jee.product
--launcher.defaultAction
openFile
--launcher.XXMaxPermSize
256M
-showsplash
org.eclipse.platform
--launcher.XXMaxPermSize
256m
--launcher.defaultAction
openFile
-vmargs
-Dosgi.requiredJavaVersion=1.5
-Dhelp.lucene.tokenizer=standard
-Xverify:none
-XX:PermSize=256M
-XX:MaxPermSize=512M
-Xms512m
-Xmx1024m


[오후 2:27:20] 동건 김: 
<PACKET>
	<FUNCTION TYPE="END" COMMAND=\"REQUEST\">	
		<PROCESS>
			<NAME>skyclientmng</NAME>
			<CMD>command_idx</CMD>
		</PROCESS>
	</FUNCTION>
</PACKET>
[오후 2:29:15] 동건 김: 
<PACKET><FUNCTION TYPE="PROCESS_STATE_CHANGE" COMMAND="REQUEST"></FUNCTION></PACKET>

=======================================
<PROCESS>
	<NAME>1919</NAME>
	<CMD>1</CMD>
	<PID>0</PID>
	<STATUS>STOP</STATUS>
</PROCESS>

http://mainia.tistory.com/606 트리거

DROP TRIGGER IF EXISTS `SKYRECORD`.`tr_t_record_file`;
CREATE DEFINER=`root`@`%` TRIGGER `SKYRECORD`.`tr_t_record_file` AFTER INSERT ON SKYRECORD.t_record_file FOR EACH ROW
BEGIN
    insert into SKYRECORD.t_counsel_record_file(
      idx, 
      record_idx, 
      group_idx, 
      team_idx, 
      user_idx
    )values(
      null,
      new.idx,
      (select group_idx from SKYRECORD.t_counsel_user where e164 = new.caller),
      (select team_idx from SKYRECORD.t_counsel_user where e164 = new.caller),
      (select user_idx from SKYRECORD.t_counsel_user where e164 = new.caller)
    );
END;

<isNotEmpty property="s_call_time">  
	            <isNotEmpty property="e_call_time">
	                and UNIX_TIMESTAMP(endtime)-UNIX_TIMESTAMP(starttime) BETWEEN #s_call_time# and #e_call_time#                
	            </isNotEmpty>	        	
	        </isNotEmpty>


skycall 0x03ea   1002 + command
skymedia 0x07d0   2000  
skysignal 0x0fa0  4000
skyagentsginal 0x03f2  1010
skyagentcall 0x03f3  1011

skyivrcall 0x0460  1120
skyivrsignal 0x044c  1100
skyivrvxml 0x0474  1140




넥서스 VRS 로그인 접속정보
nexus.host=61.97.146.52
nexus.port=8080
nexus.sslFlag=0
nexus.authFlag=0
nexus.user=
nexus.pwd=
nexus.url=/CCC2/record/login.tbu

apache lib이용한 post 방식으로 로그인 정보를  위에 url로 전송
return data는 json 형식으로 로그인한 정보를 받습니다.

	 <!-- 녹취조회 -->
   
   <select id="RecodeList" resultClass="recordDTO" parameterClass="searchDTO">
		  	<![CDATA[
			  SELECT  
					 a.idx
					,b.agent
					,a.caller             
					,a.callee          
					,a.starttime          
					,a.endtime          
					,a.filename          
					,a.filedirectory          
					,if( a.starttime > a.endtime,'00:00:00', SEC_TO_TIME(unix_timestamp(a.endtime)-unix_timestamp(a.starttime)))as calltime          
					,a.memo
					,c.descr as calltype
			  FROM t_record_file a, t_record_callcenter b, t_basic_code c
			 WHERE 1=1
			   AND c.group_code = 1
			   AND a.callcenterseq = b.callcenterseq
			   AND b.calltype = c.basic_code
			 ]]>
			  <dynamic>
			  	<isNotEmpty property="counseler" prepend="AND">
			   		b.agent in ( $counseler$ )
				</isNotEmpty>
			  	<isNotEmpty property="callTypeStr" prepend="AND">
			   		b.calltype in ($callTypeStr$)
				</isNotEmpty>
			  	<isEmpty property="callTypeStr" prepend="AND">
			   		b.calltype in ('')
				</isEmpty>
				<isNotEmpty property="line" prepend="AND">
			   		a.caller = $line$
				</isNotEmpty>
				<isNotEmpty property='custTel' prepend="AND">
	             	callee like '$custTel$%'
	             </isNotEmpty>
	            <isNotEmpty property="sdate" >
		            <isNotEmpty property="edate" prepend="AND">
		                starttime BETWEEN concat(#sdate#,#shour#,#smin#,'00') AND concat(#edate#,#ehour#,#emin#,'00')
		            </isNotEmpty>
		            <isEmpty property="edate" prepend="AND">
		                starttime like concat(#sdate#,#shour#,#smin#,'%') 
		            </isEmpty>
	            </isNotEmpty>
           		<isGreaterThan property="eterm" compareValue="0" prepend="AND"> 
           			(unix_timestamp(endtime)-unix_timestamp(starttime)) BETWEEN #sterm# and #eterm#
           		</isGreaterThan>
	             <isNotEmpty property="start">
						LIMIT #start#, #numPerPage#
		  	   		</isNotEmpty>
		  	   		
		 	</dynamic>
    </select> 

  <EMBED id="player" name="player" src="../2049540_257_01085099137_QnqAslgYcF.wav"
			width="300" height="60"
			autostart = false 
			volume = 50
			balance = 0
			loop = false
			showtracker = true
			showcontrols = true
			showaudiocontrols = true
			showpositioncontrols = false
			showstatusbar = true
			>			
		</EMBED>


<isNotEmpty property="s_call_time">  
	            <isNotEmpty property="e_call_time">
	                and UNIX_TIMESTAMP(endtime)-UNIX_TIMESTAMP(starttime) BETWEEN #s_call_time# and #e_call_time#                
	            </isNotEmpty>	        	
	        </isNotEmpty>        



String ss_user = (String)session.getAttribute("ss_user_id");
String ss_auth = (String)session.getAttribute("ss_group_idx");
(String)session.getAttribute("ss_admin_type");



안녕하세요 스카이컴 박정우 입니다
 
웹페이지 nx -> 국내 사이트 페이지로 변경시 수정작업
1. /usr/local/tomcat/webapps/SkyProxy/loginFailed.jsp -> login.jsp 를  loginK.jsp 로 변경
2. /usr/local/tomcat/webapps/SkyProxy/sys/include/includeFile.jsp ->
           <link rel="stylesheet" type="text/css" href="<%=cp%>/css/style.css"></link> - > styleK.css 로 변경
3. /usr/local/tomcat/webapps/SkyProxy/WEB-INF/decorators.xml -> <decorator name="layout" page="layout.jsp"> -> layoutK.jsp 변경
4. /usr/local/tomcat/webapps/SkyProxy/WEB-INF/classes/login.xml ->login.jsp 를 모두 loginK.jsp 변경
 
nx 페이지 원복은 반대로 하시면 됩니다.
 
Expected object while converting data for skycom.sbc.dto.CounselDTO in ParameterProperty[method=team_SelectBox_Idx,p#=0]. Passed: f0




/usr/local/skycom/var/ivr/ment/ext/
force_yn = 1, 0; true/false

diskinfo import  만 call_list.jsp, etc.jsp


CpuInfo.java -> sbc.jsp
DiskInfo.java
linuxSysinfo.java -> access_list.jsp(FireWall), ip_routing.jsp(RouteTable), sbc.jsp
MemoryInfo.java
NetInfo.java
NetworkInfo.java











 t_record_file_201306 r , t_counsel_record_file_201306


 http://211.44.51.216/recplayer/mem_list.asp?phone_no=025417314&mobile_no=0116857314&study_regdate=2013-06-03&company=cnt

 open codec : {05187161-5C36-4324-A734-22BF37509F2D}

 <script>window.googleJavaScriptRedirect=1</script><body style="display: none"><a href="http://buseo.jeongeup.go.kr/cms/board/Download.jsp?fileId=95511" id=link target=_parent><textarea id="frm"></textarea></body><script>var m={navigateTo:function(b,a,d){if(b!=a&&b.google){if(b.google.r){b.google.r=0;
a.document.getElementById("link").click();}}else{try{var f=a.location.search.match(/[\?&]ccnt=([^&]*)/);if(f){var g=f[1],h=a.sessionStorage,k=h.rds,l=h.rdcnt;"b"==k&&l==g?(a.sessionStorage.rds="f",a.history.back(1)):(a.sessionStorage.rds="b",a.sessionStorage.rdcnt=g.substr(0,5),a.document.getElementById("link").click())}else a.location.search.match("[?&]frm=")?
a.setTimeout(function(){var b=a.document.getElementById("frm");b.value?(b.value="",a.history.back(1)):(b.value="b",a.document.getElementById("link").click())},0):a.document.getElementById("link").click()}catch(p){a.document.getElementById("link").click()}}}};m.navigateTo(window.parent,window,"http://buseo.jeongeup.go.kr/cms/board/Download.jsp?fileId\x3d95511");
</script><noscript><META http-equiv="refresh" content="0;URL='http://buseo.jeongeup.go.kr/cms/board/Download.jsp?fileId=95511'"></noscript>

자바 스크립트로 레지스트리를 제어 할수는 있습니다.

방법은 분명히 존재 하는데요...

문제는 MS에서 보안을 강화 해놔서.. 보안 옵션을 좀 풀어야 제대로 동작한다는 거겠죠?

만약 사용자에게 동의를 구할 수 있다면...

해당 서버에서 설명을 좀 해주고 사용하게 하는 방법도 있을것 같습니다.

방법은 일단.. 해당 사이트가 신뢰할수 있는 사이트로 등록되도록 하고.. 해당 사이트에 대해서(신뢰할수 있는 사이트의 보안등급..) Activex와 스크립트를 모두 허용해야 합니다.

그래도 안될 경우  에러메세지는 아마도 "자동화 객체는 어쩌구... " 이런 에러가 날겁니다.

이 경우에는 클라이언트에 첨부한 파일(VM과 스크립트를 예전 버전으로 돌려주는 역패치 입니다. MS에서 배포 한거구요..)을 클라이언트 PC측에 설치 하셔야 합니다.(재부팅 되니 주의 하세요..)

 

레지스트리 조작 방법은.. 아래와 같습니다.

자바스크립트 내에서 사용하면 되구요..

 

var RegWrite;

var RegRead;

 

 RegWrite=WshShell.RegWrite("HKCU\\Software\\KOEI\\GV Online Kr\\GameFoler","C:\Netmarble\GV Online Kr","REG_SG");  //문자형으로 값을 저장합니다. 레지스트리에 해당경로가 없으면 만들면서 넣습니다.
RegWrite=WshShell.RegWrite("HKCU\\Software\\KOEI\\GV Online Kr\\Login\\login_account",0X00000000,"REG_DWORD"); //숫자형(16진수)로 레지스트리 값을 넣습니다. 0X00000000부분을 10진수 숫자로 넣으면 10진수로 입력됩니다.


  RegRead=WshShell.RegRead("HKCU\\Software\\KOEI\\GV Online Kr\\GameFoler"); //해당 경로의 값을 반환 합니다. 이 경우에는 C:\Netmarble\GV Online Kr << 이값을 반환 하겠죠...

 

자바스크립트에서 사용되는 소스입니다. Activex 없이도 되구요... 문제는 보안을 좀 풀어야 한다는....


SELECT FROM_UNIXTIME(insert_time,'%Y%m%d') FROM `t_record_file_201306`;



struts 다국어처리
http://valley.egloos.com/viewer/?url=http://iris2380.egloos.com/425927



미시간 policy
+---------+-------------+-----------+---------------+---------------+
| idx     | caller      | callee    | caller_policy | callee_policy |
+---------+-------------+-----------+---------------+---------------+
| 4501391 | 07080155210 | 025417314 |          5000 |          9999 |
| 4689115 | 07080155210 | 025417314 |          5000 |          9999 |
| 4737019 | 07080155210 | 025417314 |          5000 |          9999 |
+---------+-------------+-----------+---------------+---------------+
02-541-7314 무선전화번호 011-685-7314 
이플 레코드파일

mysql> desc t_record_file;
+-----------------+------------------+------+-----+---------+----------------+
| Field           | Type             | Null | Key | Default | Extra          |
+-----------------+------------------+------+-----+---------+----------------+
| idx             | int(10) unsigned | NO   | PRI | NULL    | auto_increment |
| caller          | varchar(40)      | YES  |     | NULL    |                |
| callee          | varchar(40)      | YES  |     | NULL    |                |
| starttime       | varchar(40)      | YES  |     | NULL    |                |
| endtime         | varchar(40)      | YES  |     | NULL    |                |
| filename        | varchar(250)     | NO   | MUL | NULL    |                |
| filedirectory   | varchar(250)     | YES  |     | NULL    |                |
| path            | varchar(250)     | YES  |     | NULL    |                |
| memo            | varchar(500)     | YES  |     | NULL    |                |
| callcenterseq   | varchar(11)      | YES  |     | NULL    |                |
| callerAddr      | varchar(40)      | YES  |     | NULL    |                |
| calleeAddr      | varchar(40)      | YES  |     | NULL    |                |
| caller_id       | varchar(32)      | YES  |     | NULL    |                |
| callee_id       | varchar(32)      | YES  |     | NULL    |                |
| ftp             | char(1)          | YES  |     | NULL    |                |
| owner           | char(1)          | YES  |     | NULL    |                |
| caller_ext      | varchar(5)       | YES  |     | NULL    |                |
| callee_ext      | varchar(5)       | YES  |     | NULL    |                |
| caller_policy   | int(10) unsigned | YES  |     | 0       |                |
| callee_policy   | int(10) unsigned | YES  |     | 0       |                |
| insert_time     | int(10) unsigned | YES  |     | 0       |                |
| ftp_complete    | char(1)          | YES  |     | N       |                |
| file_identifier | varchar(10)      | YES  |     | NULL    |                |
+-----------------+------------------+------+-----+---------+----------------+
23 rows in set (0.00 sec)
http://localhost:8080/ExclusiveRecPage.action?caller=100&callee=200&company_code=EPLE_T_TALK&regDate=20130601
http://localhost:8080/ExclusiveRecPage.action?callee=200&regDate=20130601&company_code=EPLE_T_TALK
http://211.237.76.81/ExclusiveRecPage.action?caller=100&callee=200&company_code=EPLE_T_TALK&regDate=20130601
http://211.237.76.81:8090/eplerecord/ExclusiveRecPage.action?callee=200&regDate=20130601&company_code=EPLE_T_TALK
http://211.237.76.81:8090/eplerecord//ExclusiveRecPage.action?callee=0226595113&company_code=EPLE_T_TALK&regDate=20130701
   private Integer idx;
  private Integer numPerPage;
  private Integer start;
  private String e164;
  private String caller;
  private String callee;
  private String starttime;
  private String endtime;
  private String calltype;
  private String filename;
  private String path;
  private String filedirectory;

  
      1 path.upload_file=/usr/local/nfs_mount_list
      2 path.convert_file=/mount/record_mount
      3 path.play_file=/mount/record_wav
~
/usr/local/nfs_mount_list/mount/record_wav

#이플 spx 파일을 wav로 변환 # 아래 위치에 wav파일 재생
/usr/local/nfs_mount_list/mount/record_mount/Server1/20130703 spx 파일 저장ㅅ
/usr/local/nfs_mount_list/mount/record_wav/20130703  wav로 변환

/mount/record_wav/20130703  wav로 변환


KBS - SKYRBTK - 음원파일업로드 파일 위치
struts-menu.xml
 <action name="AsrcFileUpload" class="skycom.process.menu.srcFileUploadA" method="onLoad">
	            <result name="SESSIONOUT" type="redirectAction">
	            	<param name="actionName">sessionout</param>	        	
	            </result>
	            <result name="DEFAULT">process/menu/srcFileUpload.jsp</result>
	            <result name="EXCEPTION" type="redirectAction">
	            	<param name="actionName">sessionout</param>	        	
	            </result>
	    </action>
<action name="AsrcFileUploadFileSave" class="skycom.process.menu.srcFileUploadA" method="doSave">
	     		<result name="SESSIONOUT" type="redirectAction">
	            	<param name="actionName">sessionout</param>	        	
	            </result> 	
	            <result name="EXCEPTION">process/menu/srcFileUpload.jsp</result>
	            <result name="SUCCESS">process/menu/srcFileUpload.jsp</result>
	    </action>

이더넷정보

/etc/sysconfig/network-scripts





<PACKET>
 <FUNCTION TYPE=\"ETHERNET_LIST\" COMMAND=\"REQUEST\"></FUNCTION>
</PACKET>
김아름

<?xml version=\"1.0\" standalone=\"no\"?>
<PACKET>
 <FUNCTION TYPE=\"ETHERNET_LIST\" COMMAND=\"RESPONSE\">
  <ETHERNET_INFO>eth0</ETHERNET_INFO>
  <ETHERNET_INFO>eth1</ETHERNET_INFO>
 </FUNCTION>
</PACKET>
<?xml version="1.0" standalone="no"?><PACKET>
<FUNCTION TYPE="RELOAD" COMMAND="RESPONSE" TABLE="T_SIGNAL_CONFIG" RESULT="SUCCESS">
<MESSAGE>Success</MESSAGE>
</FUNCTION></PACKET>

hashdata=84084914a649c3360be23ad9c8132467




Web Send Message call-id[gSBc9g69z0ac07], Msg[POST //GetIvrCheck.action HTTP/1.1\
r\nHost: 211.38.95.168:80\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 108\r\n\r\n
?type=01&work_type=02&forward_type=0&from_server=4&e164=07076887451&hashdata=84084914a649c3360be23ad9c8132467

http://211.38.95.168/GetIvrCheck.action?type=01&work_type=02&forward_type=0&from_server=4&e164=07076887451&hashdata=84084914a649c3360be23ad9c8132467





[오후 1:32:45] kubugi@msn.com: JavaScript 

var encodeAbcd = encodeURIComponent(abcd);
[오후 1:33:53] kubugi@msn.com: 아니면...
encodeURI(name, "UTF-8");
[오후 1:37:23] kubugi@msn.com: 또는...  tomcat server.xml 에...
<Connector URIEncoding="UTF-8" .... >

<s:if test='%{check1 == "1"}'>

skysbc_lg

<param-value>jdbc:mysql://192.168.0.217:3306/SKYENV?useUnicode=true</param-value>
<param-value>jdbc:mysql://192.168.0.217:3306/SKYMEDIA?useUnicode=true</param-value>

#관리자 계정 설정
INSERT INTO SKYENV.t_web_user (user_id, user_pwd, user_name, auth)VALUES('admin','admin','admin','admin');
# web interface 통신을 위한 기본 서버 설정
INSERT INTO SKYENV.t_server_list(idx, ip_addr, ivr_flag, sbc_flag, media_flag, PORT, NAME) VALUES(NULL, '127.0.0.1', 0,1,1,8020,'DEFAULT SERVER');
#skysbc_lg 사용 데이터베이스
SKYCOM, SKYAGENT, SKYENV, SKYMEDIA



public String team_Table_Insert(CounselDTO dto){
		Func func = new Func();
		String returnMsg = "success";
		boolean flag = false;
		Connection conn = null;
		Connection conn2 = null;
		ArrayList params = new ArrayList();
		List list = new ArrayList();
		String querySrcName = "";
		try {
			conn = dbconnect.getConnection();
			conn2 = dbconnect.getConnection();
			conn.setAutoCommit(false);
			
			int idx = dao.getIntValue(conn, "getMaxTeam");				
			dto.setIdx(idx);
			if(!team_dup_Chk(dto)){	
				/*달력 - 제거*/
				if(dto.getChange_date().indexOf("-") > -1){
					String replcaeDate = dto.getChange_date().replaceAll("-", "");
					dto.setChange_date(replcaeDate);
				}				
				
				params.add(dto.getIdx());
				params.add(dto.getGroup_idx());
				params.add(dto.getName());			

				if(func.f_NullCheck(dto.getChange_date()).equals("")){
					querySrcName = "team_Table_Insert";
				}else{						
					params.add(dto.getChange_date());
					querySrcName = "team_Table_Insert2";
				}				
				
				if(dao.insert(conn, params,querySrcName)>0){
					returnMsg = "success:"+dto.getIdx();
				}else{
					returnMsg = "It has been failed";
				}
				conn.commit();
				if(!func.f_NullCheck(dto.getChange_date()).equals("")){
					if(returnMsg.indexOf("success") > -1){					
						RecordMgr recordMgr = new RecordMgr();
						
						String whereInStr = "and idx = '"+dto.getIdx()+"' ";
						CounselDTO cDTO = new CounselDTO();
						list = dao.selectStringParam(conn2, whereInStr, "team_Table_List_Idx");
						cDTO = (CounselDTO)list.get(0);
						
						dto.setGroup_name(cDTO.getGroup_name());					
						dto.setTemp_name(dto.getName());
						
						String record_return_message = recordMgr.team_Record_Table_Update(dto);
						System.out.println("record_return_message :"+record_return_message);
					}
				}
			}else{
				returnMsg = "Duplicate name.";
			}
		}catch (Exception e) {
			returnMsg = "It has been failed";
			System.err.println("team_Table_Insert()"+e);
			e.printStackTrace();
			try {
				conn.rollback();
			} catch (Exception e2) {
				e2.printStackTrace();
			}
		}finally{
			DBClose.close(conn);
			DBClose.close(conn2);
		}
		return returnMsg;
	}


# unique key 삭제 및 생성

drop index 유니크키명 on 테이블명;
create unique index  유니크키명 on 테이블명 (컬럼명, 컬럼명);


# type이 innodb일 경우에는 unique key 삭제 하기전에 foreign key를 삭제해야 한다.

alter table 테이블명 drop foreign key 포린키명;
drop index 유니크키명 on 테이블명;



# innodb 타입 foreing key 재생성

alter table 테이블명 add CONSTRAINT 포린키명  foreign key (컬럼명) references 디비명 (컬럼명) on delete cascade;

생성> CREATE UNIQUE INDEX "유니크키명" ON "테이블명" ("컬럼명","컬럼명");


삭제> DROP INDEX "유니크키명" ON "테이블명";


alter table t_counsel_group add unique (name);


http://www.zetswing.com/bbs/board.php?bo_table=MySQL_LEC&wr_id=19&sca=&sfl=wr_subject%7C%7Cwr_content&stx=uni






#이플업데이트#
Record.xml

<!-- 미시간영어 단독 녹취 쿼리 테이블 월별조회(X)(이플) -->
<select id="ExclusiveRecPage" parameterClass="java.util.Map" resultClass="skycom.pbx.record.RecordFileBean">
SELECT 
idx            
,caller         
,callee         
,FROM_UNIXTIME(UNIX_TIMESTAMP(starttime), '%Y-%m-%d %H:%i:%s') as starttime
,FROM_UNIXTIME(UNIX_TIMESTAMP(endtime), '%Y-%m-%d %H:%i:%s') as endtime 			       
,filename       
,filedirectory  
,path           
,memo           
,callcenterseq  
,callerAddr     
,calleeAddr     
,caller_id      
,callee_id      
,ftp            
,owner          
,caller_ext     
,callee_ext     
,caller_policy  
,callee_policy  
,insert_time    
,ftp_complete   
,file_identifier			
,UNIX_TIMESTAMP(endtime)-UNIX_TIMESTAMP(starttime) as calltype		
FROM t_record_file
WHERE 1=1         
<dynamic>
<isNotEmpty property="caller" prepend="AND">
caller = #caller#	
</isNotEmpty>
<isNotEmpty property="callee" prepend="AND">
callee = #callee#	
</isNotEmpty>		     	        		            
<isNotEmpty property="caller_policy" prepend="AND">
caller_policy = #caller_policy#	
</isNotEmpty>
<isNotEmpty property="callee_policy" prepend="AND">
callee_policy = #callee_policy#	
</isNotEmpty>
<!---->     
<isNotEmpty property="regDate" prepend="AND">
FROM_UNIXTIME(insert_time,'%Y%m%d') = 	#regDate#
</isNotEmpty>     
</dynamic>
</select>
record.xml

<!-- /URL 접속하는 Action -->
		<!-- 단독 녹취페이지 (미시간어학원 이플) -->
		<action name="ExclusiveRecPage" class="skycom.pbx.record.ExclusiveRecPage">
		    <result name="success">/jsp/record/exclusive_Rec_Page.jsp</result>		    
		</action>				

decorator.xml

<pattern>*ExclusiveRecPage.action*</pattern>



*sktccc SKYRECORD 데이터 베이스 테이블*

CREATE TABLE `t_counsel_group` (
  `idx` int(11) NOT NULL,
  `name` varchar(30) NOT NULL,
  `change_date` varchar(14) default NULL,
  PRIMARY KEY  (`idx`),
  UNIQUE KEY `name` (`name`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8;

CREATE TABLE `t_counsel_account` (
  `idx` int(11) NOT NULL,
  `login_id` varchar(30) NOT NULL,
  `password` varchar(45) default NULL,
  `group_idx` int(11) default NULL,
  `team_idx` int(11) default NULL,
  `admin_type` varchar(1) default NULL COMMENT '1 : 관리자 2 : 그룹 3: team',
  PRIMARY KEY  (`idx`,`login_id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8;



CREATE TABLE `t_counsel_team` (
  `idx` int(11) NOT NULL,
  `group_idx` int(11) default NULL,
  `name` varchar(30) default NULL,
  `change_date` varchar(14) default NULL COMMENT 'YYYYMMDDHH',
  PRIMARY KEY  (`idx`),
  UNIQUE KEY `name` (`name`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8;

CREATE TABLE `t_counsel_user` (
  `idx` int(11) NOT NULL,
  `group_idx` int(11) default NULL,
  `team_idx` int(11) default NULL,
  `name` varchar(30) default NULL,
  `change_date` varchar(14) default NULL,
  `e164` varchar(10) NOT NULL,
  PRIMARY KEY  (`idx`,`e164`),
  UNIQUE KEY `e164` (`e164`),
  UNIQUE KEY `name` (`name`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8;



select * from t_record_file where caller_policy = 5000                   AND         callee_policy = 9999 and starttime like '201307%' limit 1,3 

http://211.237.76.81/ExclusiveRecPage.action?caller=09020001515&callee=0226595113&company_code=EPLE_T_TALK&regDate=20130701

path.upload_file=/usr/local/nfs_mount_list
path.convert_file=/mount/record_mount
path.play_file=/mount/record_wav



/usr/local/nfs_mount_list/mount/record_wav/


<!-- 미시간영어 단독 녹취 쿼리 테이블 월별조회(X)(이플) -->
	<select id="ExclusiveRecPage" parameterClass="java.util.Map" resultClass="skycom.pbx.record.RecordFileBean">
		SELECT 
			idx            
			,caller         
			,callee         
			,FROM_UNIXTIME(UNIX_TIMESTAMP(starttime), '%Y-%m-%d %H:%i:%s') as starttime
			,FROM_UNIXTIME(UNIX_TIMESTAMP(endtime), '%Y-%m-%d %H:%i:%s') as endtime 			       
			,filename       
			,filedirectory  
			,path           
			,memo           
			,callcenterseq  
			,callerAddr     
			,calleeAddr     
			,caller_id      
			,callee_id      
			,ftp            
			,owner          
			,caller_ext     
			,callee_ext     
			,caller_policy  
			,callee_policy  
			,insert_time    
			,ftp_complete   
			,file_identifier			
			,UNIX_TIMESTAMP(endtime)-UNIX_TIMESTAMP(starttime) as calltype		
		  FROM t_record_file
         WHERE 1=1         
           <dynamic>
           <isNotEmpty property="caller" prepend="AND">
	             caller = #caller#	
            </isNotEmpty>
            <isNotEmpty property="callee" prepend="AND">
	             callee = #callee#	
            </isNotEmpty>		     	        		            
            <isNotEmpty property="caller_policy" prepend="AND">
	             caller_policy = #caller_policy#	
            </isNotEmpty>
            <isNotEmpty property="callee_policy" prepend="AND">
	             callee_policy = #callee_policy#	
            </isNotEmpty>
            <!---->     
            <isNotEmpty property="regDate" prepend="AND">
	             FROM_UNIXTIME(insert_time,'%Y%m%d') = 	#regDate#
            </isNotEmpty>
                     
		 </dynamic>
	</select>

mysql index 생성

index 확인 
- show index from {table_name}; 

show index from t_record_file;
index 삭제
- alter table {table_name} drop index index_name;
index 추가
- alter table {table_name} add index index_name (column_name);


http://192.168.0.216:8000/skysbc
http://192.168.0.216:8000/skysbc_lg
http://192.168.0.216:8080/sktccc

톰켓성능 업
http://icoon22.tistory.com/280

struts locale 다국어

http://blog.naver.com/wellto?Redirect=Log&logNo=113252894


var encodeAbcd = encodeURIComponent(abcd);
[2013-07-09 오후 1:33:53] kubugi@msn.com: 아니면...
encodeURI(name, "UTF-8");
[2013-07-09 오후 1:37:23] kubugi@msn.com: 또는...  tomcat server.xml 에...
<Connector URIEncoding="UTF-8" .... >
[2013-07-09 오후 4:10:30] kubugi@msn.com: 이플(미시간어학원) 작업한 부분.. tomcat restart되어야 하는 부분이죠?

callee2 가 추가되었습니다
http://211.237.76.81:8090/eplerecord/ExclusiveRecPage.action?callee=0226595113&callee2=0226595113&company_code=EPLE_T_TALK&regDate=20130701

/tstorage/vol3/record/


<?xml version="1.0" encoding="UTF-8"?>
<Context path="/record" docBase="/tstorage/vol3/record" debug="0" reloadable="true" />

+-----------------+------------------+------+-----+---------+----------------+
| Field           | Type             | Null | Key | Default | Extra          |
+-----------------+------------------+------+-----+---------+----------------+
| idx             | int(10) unsigned | NO   | PRI | NULL    | auto_increment |
| caller          | varchar(40)      | YES  |     | NULL    |                |
| callee          | varchar(40)      | YES  |     | NULL    |                |
| starttime       | varchar(40)      | YES  |     | NULL    |                |
| endtime         | varchar(40)      | YES  |     | NULL    |                |
| filename        | varchar(250)     | NO   | MUL | NULL    |                |
| filedirectory   | varchar(250)     | YES  |     | NULL    |                |
| path            | varchar(250)     | YES  |     | NULL    |                |
| memo            | varchar(500)     | YES  |     | NULL    |                |
| callcenterseq   | varchar(11)      | YES  |     | NULL    |                |
| callerAddr      | varchar(40)      | YES  |     | NULL    |                |
| calleeAddr      | varchar(40)      | YES  |     | NULL    |                |
| caller_id       | varchar(32)      | YES  |     | NULL    |                |
| callee_id       | varchar(32)      | YES  |     | NULL    |                |
| ftp             | char(1)          | YES  |     | NULL    |                |
| owner           | char(1)          | YES  |     | NULL    |                |
| caller_ext      | varchar(5)       | YES  |     | NULL    |                |
| callee_ext      | varchar(5)       | YES  |     | NULL    |                |
| caller_policy   | int(10) unsigned | YES  |     | 0       |                |
| callee_policy   | int(10) unsigned | YES  |     | 0       |                |
| insert_time     | int(10) unsigned | YES  |     | 0       |                |
| ftp_complete    | char(1)          | YES  |     | N       |                |
| file_identifier | varchar(10)      | YES  |     | NULL    |                |
+-----------------+------------------+------+-----+---------+----------------+

SHOW INDEX FROM t_record_file;

ALTER TABLE t_record_file DROP INDEX idx_recod_file_test;

ALTER TABLE t_record_file ADD INDEX idx_recod_file_ccse (caller,callee,starttime,endtime);

ALTER TABLE t_record_file ADD INDEX idx_recod_file_ccp (callee,caller_policy);



public static void testFileZipComplex() throws IOException
 {
  String szInputFile1 = "C:\\Documents and Settings\\bluejames\\My Documents\\문건들\\POI관련";
  String szGZipTemp = "C:\\Documents and Settings\\bluejames\\My Documents\\문건들\\POI관련\\POI.zip";
  
  File inFile1 = new File ( szInputFile1);
  File inDirectory ;
  if (inFile1.isDirectory())
  {
  inDirectory = new File ( szInputFile1);
  }
  else
  {
  inDirectory = new File ( inFile1.getParent());   
  }
  
  File[] inFile = inDirectory.listFiles();
  FileInputStream fis = null;
  

  File gzipFile = new File ( szGZipTemp);
  FileOutputStream fos = new FileOutputStream ( gzipFile);  
  net.sf.jazzlib.ZipOutputStream zos = new net.sf.jazzlib.ZipOutputStream( fos);
  
  net.sf.jazzlib.ZipEntry ze = null;
//  ZipEntry ze = null;
  
  byte[] buffer = new byte[1024 * 8];  
  int nRead;
  
  try {
  for ( int i=0; i < inFile.length ; i++)
  {
   fis = new FileInputStream( inFile[i]);

   ze = new net.sf.jazzlib.ZipEntry ( inFile[i].getName()); 
   //ze = new ZipEntry ( inFile[i].getName());
   
   System.out.println( "압축할 파일명 : " + inFile[i].getName() + ", 파일사이즈 : " + fis.available());   
   zos.putNextEntry(ze);
// 압축 레벨을 정하는것인데 9는 가장 높은 압축률을 나타냅니다.

// 그 대신 속도는 젤 느리죠. 디폴트는 8입니다.

   zos.setLevel(9); 
   buffer = new byte[1024 * 8];
   nRead = 0;
   while ( (nRead = fis.read( buffer)) != -1)
   {
    zos.write( buffer, 0, nRead);
   }
   fis.close();
   zos.closeEntry();
  }
   zos.close();
   fos.close();
  }
  catch (IOException e)
  {
   e.printStackTrace();
  }
  finally 
  {
   try { fis.close(); } catch ( Exception e) {}
   try { zos.close(); } catch ( Exception e) {}
   try { fos.close(); } catch ( Exception e) {}
  }
 }

excel poi & jxl
http://misnomer.blog.me/60039255358

SELECT * FROM t_record_file_201307 WHERE caller_e164 = '01063329710';

SELECT * FROM (
	SELECT caller_e164, call_seq, COUNT(call_seq) cnt FROM t_record_file_201307 WHERE start_time LIKE '20130722%'  GROUP BY caller_e164, call_seq 
) aa WHERE aa.cnt > 1;

	SELECT call_seq, start_time, caller_e164, COUNT(call_seq) cnt FROM t_record_file_201307 WHERE start_time LIKE '20130722%'  
	GROUP BY call_seq, start_time, caller_e164
	HAVING COUNT(*) > 1;

SELECT b.*
FROM (
	SELECT call_seq, start_time, caller_e164, COUNT(call_seq) cnt FROM t_record_file_201307 WHERE start_time LIKE '20130722%'  
	GROUP BY call_seq, start_time, caller_e164
	HAVING COUNT(*) > 1
) a, t_record_file_201307 b
WHERE a.call_seq = b.call_seq
AND a.start_time = b.start_time
AND a.caller_e164 = a.caller_e164
ORDER BY b.call_seq, b.start_time, b.caller_e164
;

SELECT a.*
FROM t_record_file_201307 a,
(
	SELECT b.call_seq, b.start_time, b.caller_e164, MIN(b.idx) min_idx
	FROM (
		SELECT call_seq, start_time, caller_e164, COUNT(call_seq) cnt FROM t_record_file_201307 WHERE start_time LIKE '20130722%'  
		GROUP BY call_seq, start_time, caller_e164
		HAVING COUNT(*) > 1
	) a, t_record_file_201307 b
	WHERE a.call_seq = b.call_seq
	AND a.start_time = b.start_time
	AND a.caller_e164 = a.caller_e164
	GROUP BY b.call_seq, b.start_time, b.caller_e164
) b
WHERE a.call_seq = b.call_seq
AND a.start_time = b.start_time
AND a.caller_e164 = a.caller_e164
AND a.idx <> b.min_idx
;

DELETE FROM t_record_file_201307 WHERE idx IN (
SELECT a.idx
FROM t_record_file_201307 a,
(
	SELECT b.call_seq, b.start_time, b.caller_e164, MIN(b.idx) min_idx
	FROM (
		SELECT call_seq, start_time, caller_e164, COUNT(call_seq) cnt FROM t_record_file_201307 WHERE start_time LIKE '2013072%'  
		GROUP BY call_seq, start_time, caller_e164
		HAVING COUNT(*) > 1
	) a, t_record_file_201307 b
	WHERE a.call_seq = b.call_seq
	AND a.start_time = b.start_time
	AND a.caller_e164 = a.caller_e164
	GROUP BY b.start_time, b.call_seq, b.caller_e164
) b
WHERE a.call_seq = b.call_seq
AND a.start_time = b.start_time
AND a.caller_e164 = a.caller_e164
AND a.idx <> b.min_idx




http://222.231.59.95:8000/GetPolicy.action&from_server=2&prg_status=ADD&admin_type=3&admin_key=53&admin_value=7000000090&use_default_policy=1&hashdata=71a602d83104fc3a77d56d6c7af79a8d



mygrid1.attachHeader(["#rspan", "#rspan", "#rspan", "( ㅡ:미설정, N:제한없음, Y:제한있음 )", "#cspan", "#cspan", "#rspan"]);





ELANG="ko_KR.UTF-8"
#LANG="ko_KR.eucKR"
LANG="en_US.UTF-8"
SYSFONT="latarcyrheb-sun16"



삭제
truncate table table_name

교직원나라




UPDATE t_counsel_record_file_201203
SET group_name = '교직원나라'
WHERE record_idx IN
(
SELECT idx FROM  t_record_file_201203 WHERE start_time < '20130719210000' 
AND (caller_e164 IN ('4205', '4204', '4225', '4210', '4212', '4223', '4220', '4202', '4206', '4216', '4211', '4213', '4209', '4224', '4219', '4217', '4215', '4218', '4222')
OR callee_e164 IN ('4205', '4204', '4225', '4210', '4212', '4223', '4220', '4202', '4206', '4216', '4211', '4213', '4209', '4224', '4219', '4217', '4215', '4218', '4222'))
)
;

2013-07-31 call_owner 1개만 들어간것

SELECT a.* FROM (
	SELECT idx, caller_e164, callee_e164, start_time, call_owner, COUNT(1) cnt FROM t_record_file_201307,t_counsel_record_file_201307 
	WHERE idx = record_idx AND start_time LIKE '201307%' 
	AND call_type = 'E' 	
	GROUP BY caller_e164, callee_e164, start_time
	ORDER BY idx
)a WHERE a.cnt = 1 
;

SELECT 
*
FROM t_record_file_201307,t_counsel_record_file_201307 
WHERE idx = record_idx
AND caller_e164 = '4218'  AND start_time LIKE '20130729%'
;

<dynamic>
     		<isNotEmpty property="sh_ddd" prepend="AND">
		  		ddd LIKE '$sh_ddd$%'
  	 		</isNotEmpty>
  	 		<isNotEmpty property="sh_ddd_id" prepend="AND">
		  		ddd_id LIKE '$sh_ddd_id$%'
  	 		</isNotEmpty>
  	 		<isNotEmpty property="sh_ddd_name" prepend="AND">
		  		ddd_name LIKE '$sh_ddd_name$%'
  	 		</isNotEmpty>
  	   </dynamic>


/*left_menu*/
  SELECT 
     top_menu_id common_page_menu_key
     , left_menu_id common_left_menu_id
    , menu_url||'?top_menu_key='||top_menu_id common_menu_url
    , menu_name common_menu_name
    , create_type common_create_type
    , update_type common_update_type
    , delete_type common_delete_type
    , execute_type common_execute_type    
    FROM r_menu m, r_auth a
   WHERE m.menu_id = a.menu_id
     AND m.top_menu_id = 2
     AND m.menu_level = 2  
     AND a.user_id = 'admin'            
     AND a.execute_type = 'Y'     
   ORDER BY m.menu_id
;
/*left_menu_sub*/
SELECT 
     top_menu_id common_page_menu_key
     , a.menu_id common_menu_id
     , left_menu_id common_left_menu_id    
    , menu_url||'?top_menu_key='||top_menu_id common_menu_url
    , menu_name common_menu_name
    , create_type common_create_type
    , update_type common_update_type
    , delete_type common_delete_type
    , execute_type common_execute_type    
    FROM r_menu m, r_auth a
   WHERE m.menu_id = a.menu_id
     AND a.user_id = 'admin'
     AND m.menu_level = '3'          
     AND a.execute_type = 'Y'
     AND m.left_menu_id = '200'
   ORDER BY m.menu_id
   ;

select     top_menu_id common_page_menu_key   , menu_url||'?top_menu_key='||top_menu_id common_menu_url   , menu_name common_menu_name   , create_type common_create_type   , update_type common_update_type   , delete_type common_delete_type   , execute_type common_execute_type   FROM r_menu m, r_auth a   WHERE m.menu_id = a.menu_id  AND a.user_id = 'admin'  AND m.menu_level = 1  
AND a.execute_type = 'Y'  
order by sort
;

select distinct(ddd_id), ddd_name from r_ddd order by ddd_id;
select * from r_ddd order by ddd_id;
select * from r_ddd_band;
select distinct(ddd_name) from r_ddd where ddD_id = 03198;


select 
  to_ddd_id, 
  (select distinct(ddd_name) from r_ddd d where d.ddd_id = to_ddd_id) ,
  ddd_band
from r_ddd_band

;
select * from r_menu;
select * from r_auth;
select * from r_menu where menu_level = 1 order by sort;
select * from r_menu where menu_level = 2 and top_menu_id = 2 order by sort;
select * from r_menu where menu_level = 3 and top_menu_id = 2 and left_menu_id = 200 order by sort;



/*헤더*/
select 
 top_menu_id common_page_menu_key
, menu_url||'?top_menu_key='||top_menu_id common_menu_url
, menu_name common_menu_name
, create_type common_create_type
, update_type common_update_type
, delete_type common_delete_type
, execute_type common_execute_type
FROM r_menu m, r_auth a 
   WHERE m.menu_id = a.menu_id
     AND a.user_id = 'admin'
     AND m.menu_level = 1
     AND a.execute_type = 'Y'
;     
/*left_menu*/
  SELECT 
     top_menu_id common_page_menu_key
     , left_menu_id common_left_menu_id
    , menu_url||'?top_menu_key='||top_menu_id common_menu_url
    , menu_name common_menu_name
    , create_type common_create_type
    , update_type common_update_type
    , delete_type common_delete_type
    , execute_type common_execute_type    
    FROM r_menu m, r_auth a
   WHERE m.menu_id = a.menu_id
     AND m.top_menu_id = 2
     AND m.menu_level = 2  
     AND a.user_id = 'admin'            
     AND a.execute_type = 'Y'     
   ORDER BY m.menu_id
;
/*left_menu_sub*/
SELECT 
     top_menu_id common_page_menu_key
     , a.menu_id common_menu_id
     , left_menu_id common_left_menu_id    
    , menu_url||'?top_menu_key='||top_menu_id common_menu_url
    , menu_name common_menu_name
    , create_type common_create_type
    , update_type common_update_type
    , delete_type common_delete_type
    , execute_type common_execute_type    
    FROM r_menu m, r_auth a
   WHERE m.menu_id = a.menu_id
     AND a.user_id = 'admin'
     AND m.menu_level = '3'          
     AND a.execute_type = 'Y'
     AND m.left_menu_id = '200'
   ORDER BY m.menu_id
   ;



select 
*
FROM r_menu m, r_auth a 
   WHERE m.menu_id = a.menu_id
     AND a.user_id = 'admin'
     AND m.menu_level = 1;

SELECT count(user_id)    FROM r_web_user   WHERE user_id = '11'     AND user_pwd = '11';

 SELECT        top_menu_id common_page_menu_key       , left_menu_id common_left_menu_id       , menu_url||'?top_menu_key='||top_menu_id common_menu_url     
 , menu_name common_menu_name      , create_type common_create_type      , update_type common_update_type    
 , delete_type common_delete_type      , execute_type common_execute_type         FROM r_menu m, r_auth a   
 WHERE m.menu_id = a.menu_id      AND m.top_menu_id = 2      AND m.menu_level = 2        AND a.user_id = 'admin'
 AND a.execute_type = 'Y'         ORDER BY m.menu_id  ; 











7월

 idx	call_seq	caller_e164	caller_type	callee_e164	callee_type	call_owner	start_time	end_time	file_identifier	file_name	path	cnt
282779	959	4166	0	4168	0	2	20130720112140	20130720112217	\N	0959_4166_0_4168_0_2_20130720112140_20130720112217.mp3	/tstorage/vol3/record/Server1/20130720/0959_4166_0_4168_0_2_20130720112140_20130720112217.mp3	1
283174	788	4166	0	4161	0	2	20130720135221	20130720135223	\N	0788_4166_0_4161_0_2_20130720135221_20130720135223.mp3	/tstorage/vol3/record/Server1/20130720/0788_4166_0_4161_0_2_20130720135221_20130720135223.mp3	1
283173	790	4166	0	4161	0	1	20130720135222	20130720135223	\N	0790_4166_0_4161_0_1_20130720135222_20130720135223.mp3	/tstorage/vol3/record/Server1/20130720/0790_4166_0_4161_0_1_20130720135222_20130720135223.mp3	1
288161	600	4166	0	4163	0	2	20130722140911	20130722140951	\N	0600_4166_0_4163_0_2_20130722140911_20130722140951.mp3	/tstorage/vol3/record/Server1/20130722/0600_4166_0_4163_0_2_20130722140911_20130722140951.mp3	1
288162	602	4166	0	4163	0	1	20130722140912	20130722140951	\N	0602_4166_0_4163_0_1_20130722140912_20130722140951.mp3	/tstorage/vol3/record/Server1/20130722/0602_4166_0_4163_0_1_20130722140912_20130722140951.mp3	1
290381	306	4504	0	5505	0	2	20130722160655	20130722160655	\N	0306_4504_0_5505_0_2_20130722160655_20130722160655.mp3	/tstorage/vol3/record/Server1/20130722/0306_4504_0_5505_0_2_20130722160655_20130722160655.mp3	1
300056	196	4102	0	4105	0	2	20130723174949	20130723174957	\N	0196_4102_0_4105_0_2_20130723174949_20130723174957.mp3	/tstorage/vol3/record/Server1/20130723/0196_4102_0_4105_0_2_20130723174949_20130723174957.mp3	1
300063	198	4102	0	4105	0	1	20130723174950	20130723175026	\N	0198_4102_0_4105_0_1_20130723174950_20130723175026.mp3	/tstorage/vol3/record/Server1/20130723/0198_4102_0_4105_0_1_20130723174950_20130723175026.mp3	1
300124	494	4163	0	4166	0	2	20130723181056	20130723181126	\N	0494_4163_0_4166_0_2_20130723181056_20130723181126.mp3	/tstorage/vol3/record/Server1/20130723/0494_4163_0_4166_0_2_20130723181056_20130723181126.mp3	1
300123	496	4163	0	4166	0	1	20130723181057	20130723181126	\N	0496_4163_0_4166_0_1_20130723181057_20130723181126.mp3	/tstorage/vol3/record/Server1/20130723/0496_4163_0_4166_0_1_20130723181057_20130723181126.mp3	1
300259	988	4704	0	4710	0	1	20130723190734	20130723193326	\N	0988_4704_0_4710_0_1_20130723190734_20130723193326.mp3	/tstorage/vol3/record/Server1/20130723/0988_4704_0_4710_0_1_20130723190734_20130723193326.mp3	1
300258	986	4704	0	*425*4710	0	2	20130723190734	20130723193326	\N	0986_4704_0_*425*4710_0_2_20130723190734_20130723193326.mp3	/tstorage/vol3/record/Server1/20130723/0986_4704_0_*425*4710_0_2_20130723190734_20130723193326.mp3	1
302873	220	4704	0	4718	0	1	20130724120939	20130724121917	\N	0220_4704_0_4718_0_1_20130724120939_20130724121917.mp3	/tstorage/vol3/record/Server1/20130724/0220_4704_0_4718_0_1_20130724120939_20130724121917.mp3	1
302874	218	4704	0	*425*4718	0	2	20130724120939	20130724121917	\N	0218_4704_0_*425*4718_0_2_20130724120939_20130724121917.mp3	/tstorage/vol3/record/Server1/20130724/0218_4704_0_*425*4718_0_2_20130724120939_20130724121917.mp3	1
303098	478	4166	0	4161	0	2	20130724125901	20130724125921	\N	0478_4166_0_4161_0_2_20130724125901_20130724125921.mp3	/tstorage/vol3/record/Server1/20130724/0478_4166_0_4161_0_2_20130724125901_20130724125921.mp3	1
303097	480	4166	0	4161	0	1	20130724125902	20130724125921	\N	0480_4166_0_4161_0_1_20130724125902_20130724125921.mp3	/tstorage/vol3/record/Server1/20130724/0480_4166_0_4161_0_1_20130724125902_20130724125921.mp3	1
304584	388	4704	0	*425*4709	0	2	20130724143229	20130724143339	\N	0388_4704_0_*425*4709_0_2_20130724143229_20130724143339.mp3	/tstorage/vol3/record/Server1/20130724/0388_4704_0_*425*4709_0_2_20130724143229_20130724143339.mp3	1
304583	392	4704	0	4709	0	1	20130724143229	20130724143339	\N	0392_4704_0_4709_0_1_20130724143229_20130724143339.mp3	/tstorage/vol3/record/Server1/20130724/0392_4704_0_4709_0_1_20130724143229_20130724143339.mp3	1
307104	616	4704	0	4709	0	1	20130724163828	20130724164913	\N	0616_4704_0_4709_0_1_20130724163828_20130724164913.mp3	/tstorage/vol3/record/Server1/20130724/0616_4704_0_4709_0_1_20130724163828_20130724164913.mp3	1
307105	614	4704	0	*425*4709	0	2	20130724163828	20130724164913	\N	0614_4704_0_*425*4709_0_2_20130724163828_20130724164913.mp3	/tstorage/vol3/record/Server1/20130724/0614_4704_0_*425*4709_0_2_20130724163828_20130724164913.mp3	1
312479	632	4704	0	*425*4721	0	2	20130725131454	20130725141730	\N	0632_4704_0_*425*4721_0_2_20130725131454_20130725141730.mp3	/tstorage/vol3/record/Server1/20130725/0632_4704_0_*425*4721_0_2_20130725131454_20130725141730.mp3	1
312473	634	4704	0	4721	0	1	20130725131454	20130725141730	\N	0634_4704_0_4721_0_1_20130725131454_20130725141730.mp3	/tstorage/vol3/record/Server1/20130725/0634_4704_0_4721_0_1_20130725131454_20130725141730.mp3	1
317230	740	4010	0	4005	0	2	20130726103753	20130726103800	\N	0740_4010_0_4005_0_2_20130726103753_20130726103800.mp3	/tstorage/vol3/record/Server1/20130726/0740_4010_0_4005_0_2_20130726103753_20130726103800.mp3	1
317258	742	4010	0	4005	0	1	20130726103754	20130726103908	\N	0742_4010_0_4005_0_1_20130726103754_20130726103908.mp3	/tstorage/vol3/record/Server1/20130726/0742_4010_0_4005_0_1_20130726103754_20130726103908.mp3	1
319413	402	4704	0	*425*4721	0	2	20130726132147	20130726132824	\N	0402_4704_0_*425*4721_0_2_20130726132147_20130726132824.mp3	/tstorage/vol3/record/Server1/20130726/0402_4704_0_*425*4721_0_2_20130726132147_20130726132824.mp3	1
319416	404	4704	0	4721	0	1	20130726132147	20130726132824	\N	0404_4704_0_4721_0_1_20130726132147_20130726132824.mp3	/tstorage/vol3/record/Server1/20130726/0404_4704_0_4721_0_1_20130726132147_20130726132824.mp3	1
320782	353	4166	0	4169	0	2	20130726144414	20130726144438	\N	0353_4166_0_4169_0_2_20130726144414_20130726144438.mp3	/tstorage/vol3/record/Server1/20130726/0353_4166_0_4169_0_2_20130726144414_20130726144438.mp3	1
324284	30	4704	0	4709	0	1	20130726184009	20130726195213	\N	0030_4704_0_4709_0_1_20130726184009_20130726195213.mp3	/tstorage/vol3/record/Server1/20130726/0030_4704_0_4709_0_1_20130726184009_20130726195213.mp3	1
324285	28	4704	0	*425*4709	0	2	20130726184009	20130726195213	\N	0028_4704_0_*425*4709_0_2_20130726184009_20130726195213.mp3	/tstorage/vol3/record/Server1/20130726/0028_4704_0_*425*4709_0_2_20130726184009_20130726195213.mp3	1
324219	222	4161	0	4166	0	2	20130726185054	20130726185055	\N	0222_4161_0_4166_0_2_20130726185054_20130726185055.mp3	/tstorage/vol3/record/Server1/20130726/0222_4161_0_4166_0_2_20130726185054_20130726185055.mp3	1
324220	224	4161	0	4166	0	1	20130726185055	20130726185055	\N	0224_4161_0_4166_0_1_20130726185055_20130726185055.mp3	/tstorage/vol3/record/Server1/20130726/0224_4161_0_4166_0_1_20130726185055_20130726185055.mp3	1
324279	374	4702	0	4721	0	1	20130726190442	20130726193832	\N	0374_4702_0_4721_0_1_20130726190442_20130726193832.mp3	/tstorage/vol3/record/Server1/20130726/0374_4702_0_4721_0_1_20130726190442_20130726193832.mp3	1
324280	372	4702	0	*425*4721	0	2	20130726190442	20130726193832	\N	0372_4702_0_*425*4721_0_2_20130726190442_20130726193832.mp3	/tstorage/vol3/record/Server1/20130726/0372_4702_0_*425*4721_0_2_20130726190442_20130726193832.mp3	1
329290	54	4166	0	4162	0	2	20130729115231	20130729115231	\N	0054_4166_0_4162_0_2_20130729115231_20130729115231.mp3	/tstorage/vol3/record/Server1/20130729/0054_4166_0_4162_0_2_20130729115231_20130729115231.mp3	1
330695	796	4218	0	7792	0	2	20130729140022	20130729140055	\N	0796_4218_0_7792_0_2_20130729140022_20130729140055.mp3	/tstorage/vol3/record/Server1/20130729/0796_4218_0_7792_0_2_20130729140022_20130729140055.mp3	1
342198	278	4161	0	4116	0	2	20130730161241	20130730161241	\N	0278_4161_0_4116_0_2_20130730161241_20130730161241.mp3	/tstorage/vol3/record/Server1/20130730/0278_4161_0_4116_0_2_20130730161241_20130730161241.mp3	1
343658	856	4166	0	4168	0	2	20130730174042	20130730174113	\N	0856_4166_0_4168_0_2_20130730174042_20130730174113.mp3	/tstorage/vol3/record/Server1/20130730/0856_4166_0_4168_0_2_20130730174042_20130730174113.mp3	1
343659	858	4166	0	4168	0	1	20130730174043	20130730174113	\N	0858_4166_0_4168_0_1_20130730174043_20130730174113.mp3	/tstorage/vol3/record/Server1/20130730/0858_4166_0_4168_0_1_20130730174043_20130730174113.mp3	1
345546	996	5051	0	5502	0	2	20130731105150	20130731105150	\N	0996_5051_0_5502_0_2_20130731105150_20130731105150.mp3	/tstorage/vol3/record/Server1/20130731/0996_5051_0_5502_0_2_20130731105150_20130731105150.mp3	1
345549	2	5051	0	5502	0	2	20130731105200	20130731105200	\N	0002_5051_0_5502_0_2_20130731105200_20130731105200.mp3	/tstorage/vol3/record/Server1/20130731/0002_5051_0_5502_0_2_20130731105200_20130731105200.mp3	1
345551	10	5051	0	5502	0	2	20130731105207	20130731105207	\N	0010_5051_0_5502_0_2_20130731105207_20130731105207.mp3	/tstorage/vol3/record/Server1/20130731/0010_5051_0_5502_0_2_20130731105207_20130731105207.mp3	1
347632	478	4022	0	7569	0	2	20130731133839	20130731133839	\N	0478_4022_0_7569_0_2_20130731133839_20130731133839.mp3	/tstorage/vol3/record/Server1/20130731/0478_4022_0_7569_0_2_20130731133839_20130731133839.mp3	1
347655	562	4022	0	7569	0	2	20130731134025	20130731134026	\N	0562_4022_0_7569_0_2_20130731134025_20130731134026.mp3	/tstorage/vol3/record/Server1/20130731/0562_4022_0_7569_0_2_20130731134025_20130731134026.mp3	1
347664	616	4022	0	7569	0	2	20130731134101	20130731134102	\N	0616_4022_0_7569_0_2_20130731134101_20130731134102.mp3	/tstorage/vol3/record/Server1/20130731/0616_4022_0_7569_0_2_20130731134101_20130731134102.mp3	1
347674	652	4022	0	7569	0	2	20130731134133	20130731134133	\N	0652_4022_0_7569_0_2_20130731134133_20130731134133.mp3	/tstorage/vol3/record/Server1/20130731/0652_4022_0_7569_0_2_20130731134133_20130731134133.mp3	1
348140	696	4022	0	7700	0	2	20130731140720	20130731140732	\N	0696_4022_0_7700_0_2_20130731140720_20130731140732.mp3	/tstorage/vol3/record/Server1/20130731/0696_4022_0_7700_0_2_20130731140720_20130731140732.mp3	1
348185	866	4022	0	7700	0	2	20130731141001	20130731141012	\N	0866_4022_0_7700_0_2_20130731141001_20130731141012.mp3	/tstorage/vol3/record/Server1/20130731/0866_4022_0_7700_0_2_20130731141001_20130731141012.mp3	1


8월
idx	call_seq	caller_e164	caller_type	callee_e164	callee_type	call_owner	start_time	end_time	file_identifier	file_name	path	cnt
4599	676	4021	0	7701	0	2	20130801080924	20130801080924	\N	0676_4021_0_7701_0_2_20130801080924_20130801080924.mp3	/tstorage/vol3/record/Server1/20130801/0676_4021_0_7701_0_2_20130801080924_20130801080924.mp3	1
4620	800	4021	0	7701	0	2	20130801083039	20130801083039	\N	0800_4021_0_7701_0_2_20130801083039_20130801083039.mp3	/tstorage/vol3/record/Server1/20130801/0800_4021_0_7701_0_2_20130801083039_20130801083039.mp3	1
4622	802	4021	0	7700	0	2	20130801083112	20130801083112	\N	0802_4021_0_7700_0_2_20130801083112_20130801083112.mp3	/tstorage/vol3/record/Server1/20130801/0802_4021_0_7700_0_2_20130801083112_20130801083112.mp3	1
6625	508	5052	0	3003	0	2	20130801112656	20130801112656	\N	0508_5052_0_3003_0_2_20130801112656_20130801112656.mp3	/tstorage/vol3/record/Server1/20130801/0508_5052_0_3003_0_2_20130801112656_20130801112656.mp3	1
11905	604	5053	0	5021	0	2	20130801181625	20130801181625	\N	0604_5053_0_5021_0_2_20130801181625_20130801181625.mp3	/tstorage/vol3/record/Server1/20130801/0604_5053_0_5021_0_2_20130801181625_20130801181625.mp3	1
11906	610	5053	0	5021	0	2	20130801181628	20130801181628	\N	0610_5053_0_5021_0_2_20130801181628_20130801181628.mp3	/tstorage/vol3/record/Server1/20130801/0610_5053_0_5021_0_2_20130801181628_20130801181628.mp3	1
11910	618	5053	0	5021	0	2	20130801181632	20130801181632	\N	0618_5053_0_5021_0_2_20130801181632_20130801181632.mp3	/tstorage/vol3/record/Server1/20130801/0618_5053_0_5021_0_2_20130801181632_20130801181632.mp3	1
11932	708	5053	0	5021	0	2	20130801182123	20130801182123	\N	0708_5053_0_5021_0_2_20130801182123_20130801182123.mp3	/tstorage/vol3/record/Server1/20130801/0708_5053_0_5021_0_2_20130801182123_20130801182123.mp3	1
11935	710	5053	0	5029	0	2	20130801182130	20130801182130	\N	0710_5053_0_5029_0_2_20130801182130_20130801182130.mp3	/tstorage/vol3/record/Server1/20130801/0710_5053_0_5029_0_2_20130801182130_20130801182130.mp3	1
2532	754	4161	0	4116	0	2	20130802155246	20130802155246	\N	0754_4161_0_4116_0_2_20130802155246_20130802155246.mp3	/tstorage/vol3/record/Server1/20130802/0754_4161_0_4116_0_2_20130802155246_20130802155246.mp3	1
2878	412	5022	0	5033	0	2	20130802161108	20130802161109	\N	0412_5022_0_5033_0_2_20130802161108_20130802161109.mp3	/tstorage/vol3/record/Server1/20130802/0412_5022_0_5033_0_2_20130802161108_20130802161109.mp3	1
2879	414	5022	0	5033	0	1	20130802161109	20130802161109	\N	0414_5022_0_5033_0_1_20130802161109_20130802161109.mp3	/tstorage/vol3/record/Server1/20130802/0414_5022_0_5033_0_1_20130802161109_20130802161109.mp3	1
4112	338	5053	0	5021	0	2	20130802172202	20130802172202	\N	0338_5053_0_5021_0_2_20130802172202_20130802172202.mp3	/tstorage/vol3/record/Server1/20130802/0338_5053_0_5021_0_2_20130802172202_20130802172202.mp3	1
4114	356	5053	0	5021	0	2	20130802172214	20130802172214	\N	0356_5053_0_5021_0_2_20130802172214_20130802172214.mp3	/tstorage/vol3/record/Server1/20130802/0356_5053_0_5021_0_2_20130802172214_20130802172214.mp3	1
4428	752	5053	0	5052	0	2	20130802180723	20130802180723	\N	0752_5053_0_5052_0_2_20130802180723_20130802180723.mp3	/tstorage/vol3/record/Server1/20130802/0752_5053_0_5052_0_2_20130802180723_20130802180723.mp3	1
4429	756	5053	0	5052	0	2	20130802180728	20130802180728	\N	0756_5053_0_5052_0_2_20130802180728_20130802180728.mp3	/tstorage/vol3/record/Server1/20130802/0756_5053_0_5052_0_2_20130802180728_20130802180728.mp3	1
4432	764	5053	0	5052	0	2	20130802180738	20130802180738	\N	0764_5053_0_5052_0_2_20130802180738_20130802180738.mp3	/tstorage/vol3/record/Server1/20130802/0764_5053_0_5052_0_2_20130802180738_20130802180738.mp3	1
15698	522	5052	0	5001	0	2	20130803144219	20130803144219	\N	0522_5052_0_5001_0_2_20130803144219_20130803144219.mp3	/tstorage/vol3/record/Server1/20130803/0522_5052_0_5001_0_2_20130803144219_20130803144219.mp3	1
16451	900	4501	0	5303	0	2	20130805092902	20130805092902	\N	0900_4501_0_5303_0_2_20130805092902_20130805092902.mp3	/tstorage/vol3/record/Server1/20130805/0900_4501_0_5303_0_2_20130805092902_20130805092902.mp3	1
16452	910	4501	0	5303	0	2	20130805092904	20130805092905	\N	0910_4501_0_5303_0_2_20130805092904_20130805092905.mp3	/tstorage/vol3/record/Server1/20130805/0910_4501_0_5303_0_2_20130805092904_20130805092905.mp3	1
20615	750	5053	0	5025	0	2	20130805140137	20130805140137	\N	0750_5053_0_5025_0_2_20130805140137_20130805140137.mp3	/tstorage/vol3/record/Server1/20130805/0750_5053_0_5025_0_2_20130805140137_20130805140137.mp3	1
20861	858	4218	0	7835	0	2	20130805141233	20130805141251	\N	0858_4218_0_7835_0_2_20130805141233_20130805141251.mp3	/tstorage/vol3/record/Server1/20130805/0858_4218_0_7835_0_2_20130805141233_20130805141251.mp3	1
21040	566	4218	0	7835	0	2	20130805141935	20130805142132	\N	0566_4218_0_7835_0_2_20130805141935_20130805142132.mp3	/tstorage/vol3/record/Server1/20130805/0566_4218_0_7835_0_2_20130805141935_20130805142132.mp3	1
23539	522	4166	0	4163	0	2	20130805162334	20130805162358	\N	0522_4166_0_4163_0_2_20130805162334_20130805162358.mp3	/tstorage/vol3/record/Server1/20130805/0522_4166_0_4163_0_2_20130805162334_20130805162358.mp3	1
23540	524	4166	0	4163	0	1	20130805162335	20130805162358	\N	0524_4166_0_4163_0_1_20130805162335_20130805162358.mp3	/tstorage/vol3/record/Server1/20130805/0524_4166_0_4163_0_1_20130805162335_20130805162358.mp3	1
24589	374	4218	0	7848	0	2	20130805172428	20130805172455	\N	0374_4218_0_7848_0_2_20130805172428_20130805172455.mp3	/tstorage/vol3/record/Server1/20130805/0374_4218_0_7848_0_2_20130805172428_20130805172455.mp3	1




jquery class 접근

$(".classname").val();

name 접근

$("input[name=user_id]").val();	

File.separator


인천공항 메뉴
insert into r_auth(
  user_id,
  menu_id
) select 'admin', menu_id from r_menu where menu_level = '2'order by menu_id
;

insert into t_auth(
	user_id, menu_id
	) select 'admin1', menu_id from t_menu where menu_level in('2','3')

delete from r_auth;






과금관리
 > 기간사업자 관리
	> 기간사업자 데이터 수동생성
	> 기간사업자 데이터 생성 이력조회
 > 전번별
	> 전번별 통화 내역 조회
	> 전번별 통화집계내역 조회 
 > 년월일별
	> 년월일별 통화 내역 조회
	> 년월일별 통화 집계내역 조회
 > Prefix별
	> Prefix별 통화 내역 조회
	> 발신, 착신 Prefix별 통화 상세내역 조회
 > 가입자별
	> 가입자별 통화 내역 조회
	> 가입자별 통화 집계내역 조회
> 기타 
	> 통신사 영업별 통화 내역 조회
	> 과금 에러자료 조회
	> MB 가입자 미등록 자료 조회
> 원시자료 
	> 6.7.1.	년월일별 원시자료 조회
	> 6.7.2.	전번, PREIFX별 원시자료 조회
> 6.8.	과금Upload
	> 6.8.1.	수동 Upload
	> 6.8.2.	과금 Upload 이력조회
> 6.9.	CDR 수집파일
	> 6.9.1.	CDR 수집파일 조회

통계관리
>7.1.	통화통계
	>7.1.1.	전번별 3개월 통화통계 조회
	>7.1.2.	전번별 통화호 집계 조회
	>7.1.3.	가입자별 통화호 집계 조회
	>7.1.4.	가입자, 전번별 통화호 집계 조회

이력관리
> 이력관리
	> 8.1.1.	프로세스 상태이력 조회
	> 8.1.2.	프로세스별 재기동회수 조회
	>8.1.3.	자원 상태이력 조회
	>8.1.4.	네트워크 정보이력 조회
	>8.1.5.	네트워크별 Down회수 조회
	>8.1.6.	일괄작업 처리 이력조회
시스템관리
> 실시간
	> 9.1.1.	장애현황 조회
>  9.2.	환경
	> 9.2.1.	시스템 Config 환경 조회
	> 9.2.2.	시스템 Config 조회
> 9.3.	프로세스 환경 설정
	> 9.3.1.	네트웍 세션정보 조회
	> 9.3.5.	OLTP 그룹정보 조회
	> 9.3.9.	그룹별 프로세서정보 조회
	> 9.3.13.	Route 정보 조회
> 9.4.	자원관리
	> 9.4.1.	프로세스ID 조회
	> 9.4.4.	네트웍 정보 조회
	> 9.4.7.	자원정보 조회
> 9.5.	사용자 관리
	> 9.5.1.	사용자정보 조회
	> 사용자 비밀번호 변경
	> 사용자 권한 관리
> 9.5.	코드관리
	> 에러코드 조회
	> 프로그램 ID 관리
> 9.5.	장애관리
	> 9.6.1.	장애 발생 및 처리 정보 조회
	> 9.6.2.	에러코드별 장애건수
	> 9.6.3.	등급별 장애건수
	> 9.6.4.	장애별 음악조회
	> 9.6.8.	장애별 음악삭제 조회
복구
10.1.	과금관리
	> 원시-과금데이터 수동복구
	> PKT 에러자료 조회 및 수정
	> PKT 에러자료 복구
	> RAT 에러자료 조회

CAMA관리
    11.1.CAMA전송
	>11.1.1.	 CAMA 수동생성 및 전송
	>11.1.2.	 CAMA 생성 이력조회
	>11.1.3.	CAMA 전송 이력조회
	>11.1.4.	CAMA 에러 이력조회
    11.2.CAMA 관리
	> CAMA 환경관리
	> CAMA 전송주기관리

메일빌링연동
코드관리
	>코드변환정보관리 조회

1.234.12.43:8080

넥서스skb ##((







[오전 10:52:06] miran pyon: 인보이스 인쇄물 금액에 숫자 , 가 없음

납부내역 조회 사용기간 가운데 정렬 및 사이즈 조정, 청구금액 우측정렬



SELECT * FROM t_record_file_201308 WHERE caller_e164 = '78%' AND start_time <= '2013081420%'

화요일까지 월요일날 작업
8월 14일 20시 이전
김기호입니다.

아래 내용은 Nexus에서 SKB-CCC 녹취관련 내용으로

SBC에서 내선인지 외부번호인지에 대한 판단을 내선 SBC의 Numbering Plan으로 판단을 합니다.

기존에는 7XXX에 대해 모든 호는 내선으로 판단하여 처리되고 있었으며,

Nexus에서 요청으로 77XX, 79XX에 대한 부분은 외부 호로 설정해 달라는 요청입니다.

금일 19시 40분경에 SBC에서 Numbering 설정을 진행하여 해당 시간부터는 외부호로 Database에 기록될 것입니다.

해당 시간 이전의 Data를 외부 호로 설정해 주시기 바랍니다.


t_record_file_201308 ,t_counsel_record_file_201308 -> 77%
25098,4599,25099,4620,25100,4622
callee_type 0->1로 변경

DELETE FROM t_record_file_201308 WHERE  idx IN (4599,4620,4622);

UPDATE t_record_file_201308 SET callee_type = '1' WHERE idx IN (25098,25099,25100);

DELETE FROM t_counsel_record_file_201308 WHERE  record_idx IN (4599,4620,4622);

UPDATE t_counsel_record_file_201308 SET call_type = 'O' WHERE record_idx IN (25098,25099,25100);


t_record_file_201307 ,t_counsel_record_file_201307 -> 77% 330695,352022,348140,352033,348185,352034;


DELETE FROM t_record_file_201307 WHERE  idx IN (330695,348140,348185);

UPDATE t_record_file_201307 SET callee_type = '1' WHERE idx IN (352022,352033,352034);

DELETE FROM t_counsel_record_file_201307 WHERE  record_idx IN (330695,348140,348185);

UPDATE t_counsel_record_file_201307 SET call_type = 'O' WHERE record_idx IN (352022,352033,352034);


SELECT * FROM t_counsel_record_file_201308
WHERE record_idx IN (52426,57222,58109);
#UPDATE t_record_file_201308 SET callee_type = '1' WHERE idx IN (52426,57222,58109);
#UPDATE t_counsel_record_file_201308 SET call_type = 'O' WHERE record_idx IN (52426,57222,58109);


SELECT * FROM t_counsel_record_file_201308
WHERE record_idx IN (20861,21040,24589);
DELETE FROM t_record_file_201308 WHERE  idx IN (20861,21040,24589);
DELETE FROM t_counsel_record_file_201308 WHERE  record_idx IN (20861,21040,24589);

SELECT * FROM t_counsel_record_file_201308
WHERE record_idx IN (25119,25120,25123);

UPDATE t_record_file_201308 SET callee_type = '1' WHERE idx IN (25119,25120,25123);
UPDATE t_counsel_record_file_201308 SET call_type = 'O' WHERE record_idx IN (25119,25120,25123);


122
123

insert into t_auth(
  user_id,
  menu_id
) select 'admin', menu_id from t_menu where menu_level = '3'order by menu_id
;

delete from t_auth;


R00	0		일반요율
R00	1		시외대역요율
R00	2		시외코드요율
R00	3		국제대역요율
R00	4		국제코드요율

일반 Prefix 요율        NORMALRATEPrefix.action?rate_type=0
시외 지역별 Prefix 요율 NORMALRATEPrefix.action?rate_type=2 < DDDRATEAREAPrefix.action?rate_type=2
국제 지역별 Prefix 요율	NORMALRATEPrefix.action?rate_type=4 < IDDRATEAREAPrefix.action?rate_type=4
시외 대역별 Prefix 요율 NORMALRATEPrefix.action?rate_type=1 < DDDRATEBANDPrefix.action?rate_type=1
국제 대역별 Prefix 요율 NORMALRATEPrefix.action?rate_type=3 < IDDRATEBANDPrefix.action?rate_type=3


SELECT * FROM t_record_file_201308
WHERE callee_e164 = '4225'
AND start_time LIKE '2013081315%'

;


시스템에 오류가 생겼을때, 시스템 사용자들에게 상황을 공지할 때 사용되는 문구들입니다. 유용한 문구들만 작성했던 메일내용들에서 발췌하고 해석을 달아놓았습니다. 일부 시스템 이름들은 임의의 단어 A, B등으로 수정했습니다. 


* 시스템 오류 상황시 사용되는 문구들 예시 
The EAI system is not available at the moment. Please stop sending data to the legacy system. 
지금 EAI 시스템이 작동하지 않습니다. 레거시 시스템으로 데이터 전송하는걸 중지해주세요. 

The EAI system was updated, however we didn’t receive any notice for this matter from Head office. 
Before we figure out the situation, do not send data and wait for our further instruction. 
We keep you posted as soon as we get an updated news. 
EAI시스템이 업데이트 되었지만, 우리는 본사에서 이것과 관련된 공지를 받지 못했습니다. 
상황 파악이 되기 전엔 데이터를 전송하지 말고 지시가 있을 때까지 기다려 주세요. 
새로운 소식이 생기면 바로 알려드리겠습니다. 



* 프로그램 적용시점에 많이 사용되는 문구들. 

Please complete change source and test until today in order to reflect it on our system next Monday. 
다음주 월요일 운영시스템 반영을 위해서 오늘까지 프로그램 변경과 테스트를 끝내주세요. 

The ERP system will be normal as from Monday 10:00 AM KST(GMT+9). 
월요일 오전 10시부터 ERP 시스템이 정상적으로 작동 될 것입니다. 

We have an alternative to run the system. Thus, please guide users to send data as usual. 
시스템을 운영할 대안을 가지고 있으니까 사용자들에게 평소와 같이 데이터를 전송하라고 안내해 주세요. 

We will give further notice when the system completely updated 
시스템 업데이트가 완료되면 추가 안내 드리겠습니다. 


* 프로그램 적용 되었다고 알릴 때, 많이 사용되는 문구들. 

Pls be informed that the revised version has been reflected in live version. 
If you find any trouble, pls let us know it. 
수정 버전이 운영에 반영되었습니다. 
문제 있으시면, 저희에게 알려주세요. 

Revised version will be reflected today afternoon. 
pls transmit the data. Then it will be working properly. 
오늘 오후에 수정버전이 반영 될 겁니다. 
데이터 전송해주세요. 정상적으로 작동할 거예요. 


* 시스템 장애시 공문. 
Dear All, 

We are experiencing an Event Processing Delay which started on May 23, 2013 at 10:29:00 AM GMT and is ongoing. 
2013년 5월 23일 10시 29분에 이벤트 처리 지연이 발생했고, 아직 계속되고 있습니다. 

A and B search visibility is being delayed via our portal. 
Portal을 통해서 A, B검색을 보여주는것이 지연되고 있습니다. 

Inbound and outbound transaction flow is NOT impacted by this event. 
Inbound, Outbound 트랜잭션 흐름은 이번일로 영향을 받고 있지 않습니다. 

The maximum delay for As is 1 hour and 55 minutes and for B transactions, the maximum delay is 1hour 14 minutes. 
A업무에 대해서는 최고 1시간 55분 지연되고 B 트랜잭션에 대해서는 최고 14분이 지연됩니다. 

Our technology team has been engaged and we will provide an update once the issue has been resolved. 
우리 기술팀에서 처리하고 있고 문제가 해결되면 새로운 소식을 알려드리겠습니다




리눅스명령어만들기
현섭아 ls -l 명령어를 ll 로 쓰고 싶어 어떡해함
[오전 9:41:57] 현섭 양: alias ll='ls -l'
[오전 9:42:00] 현섭 양: 이렇게 치시면 돼요
[오전 9:42:07] 정우 박: 그래 전에는 파일에다 추가했잔어
[오전 9:42:30] 현섭 양: home 디렉토리에 .bash_profile 열고
[오전 9:42:33] 현섭 양: 거기다가 넣으심 돼여




encodeURI(name, "UTF-8");
<Connector URIEncoding="UTF-8">

freemaker

http://hongsgo.egloos.com/2234441

인천공항 로그
/app/weblog/tomcat
/app/weblog/apache





log4j 로그 로테이트

http://mirror.apache-kr.org/tomcat/tomcat-6/v6.0.37/bin/extras/

참조 : http://interwater.tistory.com/104

log4j.rootLogger=INFO, CATALINA, LOCALHOST

# Define all the appenders
log4j.appender.CATALINA=org.apache.log4j.DailyRollingFileAppender
log4j.appender.CATALINA.File=${catalina.base}/logs/catalina.out
log4j.appender.CATALINA.Append=true
log4j.appender.CATALINA.Encoding=UTF-8
# Roll-over the log once per day
log4j.appender.CATALINA.DatePattern='.'yyyy-MM-dd'.log'
log4j.appender.CATALINA.layout = org.apache.log4j.PatternLayout
log4j.appender.CATALINA.layout.ConversionPattern = %d [%t] %-5p %c- %m%n

log4j.appender.LOCALHOST=org.apache.log4j.DailyRollingFileAppender
log4j.appender.LOCALHOST.File=${catalina.base}/logs/localhost.
log4j.appender.LOCALHOST.Append=true
log4j.appender.LOCALHOST.Encoding=UTF-8
log4j.appender.LOCALHOST.DatePattern='.'yyyy-MM-dd'.log'
log4j.appender.LOCALHOST.layout = org.apache.log4j.PatternLayout
log4j.appender.LOCALHOST.layout.ConversionPattern = %d [%t] %-5p %c- %m%n

#log4j.appender.MANAGER=org.apache.log4j.DailyRollingFileAppender
#log4j.appender.MANAGER.File=${catalina.base}/logs/manager.
#log4j.appender.MANAGER.Append=true
#log4j.appender.MANAGER.Encoding=UTF-8
#log4j.appender.MANAGER.DatePattern='.'yyyy-MM-dd'.log'
#log4j.appender.MANAGER.layout = org.apache.log4j.PatternLayout
#log4j.appender.MANAGER.layout.ConversionPattern = %d [%t] %-5p %c- %m%n

#log4j.appender.HOST-MANAGER=org.apache.log4j.DailyRollingFileAppender
#log4j.appender.HOST-MANAGER.File=${catalina.base}/logs/host-manager.
#log4j.appender.HOST-MANAGER.Append=true
#log4j.appender.HOST-MANAGER.Encoding=UTF-8
#log4j.appender.HOST-MANAGER.DatePattern='.'yyyy-MM-dd'.log'
#log4j.appender.HOST-MANAGER.layout = org.apache.log4j.PatternLayout
#log4j.appender.HOST-MANAGER.layout.ConversionPattern = %d [%t] %-5p %c- %m%n

log4j.appender.CONSOLE=org.apache.log4j.ConsoleAppender
log4j.appender.CONSOLE.Encoding=UTF-8
log4j.appender.CONSOLE.layout = org.apache.log4j.PatternLayout
log4j.appender.CONSOLE.layout.ConversionPattern = %d [%t] %-5p %c- %m%n

# Configure which loggers log to which appenders
log4j.logger.org.apache.catalina.core.ContainerBase.[Catalina].[localhost]=DEBUG, LOCALHOST
#log4j.logger.org.apache.catalina.core.ContainerBase.[Catalina].[localhost].[/manager]=\INFO, MANAGER
#log4j.logger.org.apache.catalina.core.ContainerBase.[Catalina].[localhost].[/host-manager]=\INFO, HOST-MANAGER




폴더별로 정리 하면,

$CATALINA_HOME/lib -> log4j.properties, tomcat-juli-adapters.jar, log4j-1.2.17.jar

$CATALINA_HOME/bin -> tomcat-juli.jar

$CATALINA_HOME/conf -> logging.properties(삭제)











#####################################
SkyProxy 오라클 빌링 접속 안될시 : basic_type 99 인값을 1로 변경
#####################################

billFlag = new Integer(map.get(99));//0
recordFlag = new Integer(map.get(96));//0
msgFlag = new Integer(map.get(97));//0
vendorFlag = new Integer(map.get(94));//4


<select id="selectByConfig2" resultClass="BasicCodeDTO">
	 SELECT basic_type,basic_key,basic_value
	   FROM t_basiccode
	  WHERE basic_type IN(99,98,97,96,95,94)		   
</select>




<tr id="trProcNote" style="display:;">
				<th class="cell1" style="width:107px;"><img src="http://image.hyundaihmall.com/static/2008img/common/customer/th_text02_21.gif" alt="내용"></th>
				<td colspan="3">
				<table>
					<tr>
						<td>
						<span class="gray_02">질문하시는 내용을  구체적으로 적어주세요 정확하고 빠른 답변에 도움이 됩니다.<br>
						내용은 영문 1000자(한글 500자 이내)로 입력하세요.</span>
						</td>
						<td>
  							  <strong>&nbsp;글자수  체크 :<span id="textlimit">&nbsp;&nbsp;0</span></strong>
						</td>
					</tr>
					<tr>
						<textarea name='proc_note' class="sc_01" onkeyup="javascript:onkeylengthMax(this, 1000, this.name);"></textarea>
					</tr>		
				</table>
				</td>
			</tr>
function onkeylengthMax(formobj, maxlength, objname)
{
	var li_byte = 0;
	var li_len = 0;
	
	for(var i=0; i<formobj.value.length; i++)
	{
		if(escape(formobj.value.charAt(i)).length>4){
			li_byte += 2;
		}else{
			li_byte++;
		}
		if(li_byte <= maxlength){
			li_len = i + 1;
		}
	}	
	
//	obj = document.getElementById("content_byte");
//	obj.innerText = li_byte + "/300byte";
	
	if(li_byte > maxlength){
		alert("최대 글자 입력수를 초과하였습니다.");
		formobj.value = formobj.value.substr(0,li_len);
		li_byte = maxlength;
	//	obj.innerText = "300/300byte";
	}
	textlimit.innerText = li_byte;
	formobj.focus();
}		



http://211.237.76.81:8090/eplerecord/ExclusiveRecPage.action?callee=01026641971&callee2=01024126550&company_code=EPLE_T_TALK&regDate=20131005


srcFile:/usr/local/nfs_mount_list/mount/record_mount//Server1/20131004/130130066_07080159324_07080159324_0_01026641971_17_0_20131004221218_20131004221223_Ov04Puhd2c.spx
srcFile:/usr/local/nfs_mount_list/mount/record_mount//Server1/20131004/130130066_07080159324_07080159324_0_01026641971_17_0_20131004221218_20131004221223_Ov04Puhd2c.spx
destFile:/usr/local/nfs_mount_list/mount/record_wav/20131005/130130066_07080159324_07080159324_0_01026641971_17_0_20131004221218_20131004221223_Ov04Puhd2c.wav
filename:130130066_07080159324_07080159324_0_01026641971_17_0_20131004221218_20131004221223_Ov04Puhd2c.wav
file_directory:/record/Server1/20131004/130130066_07080159324_07080159324_0_01026641971_17_0_20131004221218_20131004221223_Ov04Puhd2c.spx
a:/record/Server1/20131004/130130066_07080159324_07080159324_0_01026641971_17_0_20131004221218_20131004221223_Ov04Puhd2c.spx
b:false



http://211.237.76.81:8090/eplerecord/ExclusiveRecPage.action?callee=01026641971&callee2=028903399&company_code=EPLE_T_TALK&regDate=20131004 = spx



http://211.237.76.81:8090/eplerecord/ExclusiveRecPage.action?callee=01026641971&callee2=028903399&company_code=EPLE_T_TALK&regDate=20131005 wav







#ALTER TABLE EMSPLUS.t_web_user CHECKSUM = 1, ADD auth_level INT(11) NOT NULL DEFAULT '-1' AFTER auth;

ALTER TABLE EMSPLUS.t_web_user CHECKSUM = 1, ADD auth_level INT(11) DEFAULT '-1' AFTER auth;
ALTER TABLE EMSPLUS.t_web_user CHECKSUM = 1, ADD policy_group varchar(30) DEFAULT NULL AFTER write_grant_sum;
ALTER TABLE EMSPLUS.t_web_user CHECKSUM = 1, ADD e164 varchar(8000) DEFAULT '-1' AFTER policy_group;


ALTER TABLE EMSPLUS.t_web_user CHECKSUM = 1, DROP auth_level;
ALTER TABLE EMSPLUS.t_web_user CHECKSUM = 1, DROP policy_group;
ALTER TABLE EMSPLUS.t_web_user CHECKSUM = 1, DROP e164;





ALTER TABLE SKYIVREXT.t_ivr_ext_scenario 
CHECKSUM = 1, ADD only_dial varchar(1) DEFAULT '0' AFTER callback;

톰켓튜닝

http://bcho.tistory.com/788

유지년월(최종적인 보험료 납입월 또는 대체보험료 충당월)

정상 무)탑클래스변액유니버설종신
정상 무)스마트업100세변액연금





r_basic_code 추가 옵션값

insert into r_basic_code values('OPT', 'TCO', '', '통신사 사업자 종류');
insert into r_basic_code values('TCO', 'LG', 'LGU+', 'LGU+');
insert into r_basic_code values('TCO', 'KT', 'KT', 'KT');

insert into r_basic_code values('OPT', 'CTY', '', 'CAMA 환경 종류');
insert into r_basic_code values('CTY', 'CAMA', 'CAMA', 'CAMA');
insert into r_basic_code values('CTY', 'LIST', 'LIST', 'LIST');

insert into r_basic_code values('OPT', 'CRF', '', '재전송 처리 여부');
insert into r_basic_code values('CRF', 'N', 'N', '미처리');
insert into r_basic_code values('CRF', 'W', 'W', '작업중');
insert into r_basic_code values('CRF', 'Y', 'Y', '처리완료');
insert into r_basic_code values('CRF', 'F', 'F', '처리실패');


192.168.0.3 DB 서버의 prebill 계정에 T_CAMA_MANUAL_REQ 생성했습니다.
CAMA 수동생성 및 전송 에 사용될 테이블입니다.

그리고, T_CAMA_HISTORY에 BILL_DATE를 VARCHAR(15)에서 VARCHAR(8) 로 변경했습니다.

그리고, 다음 테이블들은 QRY 동기화를 하지 않습니다.
. T_WATCH_NETWORK
. T_WATCH_PROCESS
. T_WATCH_RESOURCE


그리고, 오늘 추가한 '요율 적용'  중메뉴의 '요율 즉시 적용' 메뉴를 누른 경우에는
T_MEMDB_SYNC의 내용 중 TBL_UPDATED=1 AND SYNC_CMD_YN = 'N' 인 내용을 표시해 주면 됩니다.

즉시 '요율 즉시 적용' 버튼을  누르면 위의 조건인 RECORD를 TBL_UDATE = 1, SYNC_CMD_YN 를 'Y'로 Update하면 됩니다. (QRY 동기화함)

이상입니다.


SimpleDateFormat formatter = new SimpleDateFormat ( "yyyyMMddHHmmssSSS", Locale.KOREA );


VRS 설치 순서

1. tomcat 설치 
  - 경로 : /usr/local/tomcat
2. war 파일 /usr/local/tomcat/webapps 로 파일 복사
3. db 설정
  - ${tomcat}/webapps/VRS/WEB-INF/classes/skycom/common/dbcp/db.properties
    db 계정 및 ip 셋팅
4. 큐브 ip 셋팅
  - ${tomcat}/webapps/VRS/WEB-INF/classes/skycom/lgn/loginAction.properties 
    ${tomcat}/webapps/VRS/WEB-INF/classes/skycom/rec/RecordAction.properties
    nexus.host <- ip 설정
5.     



인덱스태우기
http://www.datguri.net/B_88/111126 
대용량페이징
http://blog.daum.net/readyok/6813550

오라클 인덱스 생성

--- 재생성 alter index 인덱스명 rebuild
--- 삭제 drop index 인덱스명
--- 생성 create index 인덱스명 on 테이블명(컬럼명 asc, 컬럼명2 desc )



jQuery(function($){

        // Create img dom element and insert it into our document

        var loading = $('<img alt="loading" src="/images/loading.gif" />')

        .appendTo(document.body).hide();

        // Make the image appear during ajax calls

        $(window).ajaxStart(loading.show);

        $(window).ajaxStop(loading.hide);

});


전번,PREFIX별 원시자료를 조회와 전번구분, 일자구간, PREFIX, 전번구간 등으로 검색 가능한 화면이다.





t_cama_config
COMPANY	VARCHAR2(5 BYTE)	No		1	통신사구분
CAMA_IP	VARCHAR2(15 BYTE)	Yes		2	CAMA 서버 IP
CAMA_PORT	NUMBER(38,0)	Yes		3	CAMA 서버 PORT
USER_ID	VARCHAR2(20 BYTE)	Yes		4	접속 USER ID (LG)
PWD	VARCHAR2(20 BYTE)	Yes		5	접속 PWD (LG)
FAREA	VARCHAR2(2 BYTE)	Yes		6	지역코드 (KT)
SVCCD	VARCHAR2(3 BYTE)	Yes		7	서비스 코드 (KT)
FOFFICE	VARCHAR2(4 BYTE)	Yes		8	전화국코드 (KT)
FSYSNO1	NUMBER(38,0)	Yes		9	시스템 일련번호 (KT)
FSYSNO2	NUMBER(38,0)	Yes		10	이너텔 일련번호 (KT)
HCID	VARCHAR2(8 BYTE)	Yes		11	호스트 아이디 (KT)
TRUMAN_CODE	VARCHAR2(12 BYTE)	Yes		12	트루맨 코드 (KT)
SWITCH_VER	VARCHAR2(4 BYTE)	Yes		13	스위치 버젼 (KT)
FCLASS	VARCHAR2(1 BYTE)	Yes		14	전화국 분류 (KT)
FTDCD	VARCHAR2(1 BYTE)	Yes		15	전송장치 코드 (KT)
FMCODE	VARCHAR2(1 BYTE)	Yes		16	교환기종 코드 (KT)

접속정보 1~5 lg, kt
환경정보 6~ kt
추가정보 11, 12, 13, 14




네트워크 정보이력 조회를 컴퓨터명과 ‘검색일자’에 따라 조회 할 수 있는 화면이다.

집중과금방식(CAMA : Centralized Automatic Message Accounting System 전자교환기에서
발생하는 요금부과 데이터를 전산국의 요금부과 수집장치까지 실시간으로 신뢰성을 유지하며
온라인 자동 전송하여 요금처리업무의 자동화 및 일일 단위의 요금처리를 가능하게 하는 방식)에
의한 과금계획을 수립한다.


CAMA 전송주기 관리 조회화면입니다. 차수, 
CAMA시작시간, CAMA종료시간 CAMA 처리 개시 시간 등으로 검색조회 할 수 있습니다.

-. 1그룹: 조민수,곽동규,채재후,김기호,고준협,박정우,김동건,남광효,은종훈,양현섭,곽진석,정상록,유종진
-. 2그룹: 이용기,채수욱,이영규,정상호,편미란,박미일
Ex) 정상록사원의 주간보고 공유 시
받는사람: 1그룹인원 모두 기록/ 참조: 사장님, 소장님, 강소영
	기타: 외근 또는 출장으로 인하여 공유가 불가피할 시에는 문자로 공유하셔도 됩니다. (단, 토요일까지

조 민수; Donggyu Kwak; 채재후; 김기호; jelda99@skycom.ne.kr; '김동건님'; hyo_cnsl@skycom.ne.kr; happy21day@skycom.ne.kr; 양현섭 님; kjs@skycom.ne.kr; vbwilson@skycom.ne.kr; 'jjyoo@skycom.ne.kr'
'김대한사장님'; 남기원; 강소영 부장님



2013-10-25

CREATE INDEX "PREBILL"."IDX_T_CALL_HISTORY" ON "PREBILL"."T_CALL_HISTORY" ("START_TIME") 
PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT)
TABLESPACE "PREBILL_CDR_IDX" ;


update r_basic_code set descr='NOTIFY' where group_code = 'ALV' and basic_code = '0';
update r_basic_code set descr='MINOR' where group_code = 'ALV' and basic_code = '1';
update r_basic_code set descr='MAJOR' where group_code = 'ALV' and basic_code = '2';
update r_basic_code set descr='CRITICAL' where group_code = 'ALV' and basic_code = '3';


<select id="listCall" resultClass="ExtensionCallBean" parameterClass="ExtensionCallBean">
  select tb.* from
  (
      select 
      		/*+index_desc(T_CALL_HISTORY IDX_T_CALL_HISTORY)+*/
      		rownum as rnum
             ,collect_date
            ,pbx_type
            ,file_name
            ,call_index
            ,branch
            ,dn_no
            ,start_time
            ,end_time
            ,duration
            ,dosu
            ,call_type
            ,dial_no
            ,charge
            ,cmy_id
            ,dial_name
            ,call_mm
          from T_CALL_HISTORY
          where start_time between '$in_start_time$' and '$out_start_time$'
          and <![CDATA[ rownum <= #endPage#	]]>		
          <dynamic>                    
            <isNotEmpty property="collect_date" prepend="AND">
		  		collect_date = #collect_date#
  	 		</isNotEmpty>	  
          	<isNotEmpty property="branch" prepend="AND">
		  		branch = $branch$
  	 		</isNotEmpty>
  	 		<isNotEmpty property="in_dn_no">
  	 			<isNotEmpty property="out_dn_no" prepend="AND">
  	 				dn_no  between #in_dn_no# and #out_dn_no#
  	 			</isNotEmpty>
  	 			<isEmpty property="out_dn_no" prepend="AND">
  	 				<isNotEmpty property="in_dn_no">
  	 				<![CDATA[ dn_no >=#in_dn_no#]]>		  			
  	 				</isNotEmpty>  	 				
  	 			</isEmpty>  	 					  	
  	 		</isNotEmpty>  	 	
  	 		<isEmpty property="in_dn_no">
  	 			<isNotEmpty property="out_dn_no" prepend="AND">
  	 				<![CDATA[ dn_no <= #out_dn_no#]]>		
  	 			</isNotEmpty>
  	 		</isEmpty>  	 	  	 		
  	 		<isNotEmpty property="dn_no" prepend="AND">
		  		dn_no = $dn_no$
  	 		</isNotEmpty>	 		  	 				  	
  	 		<isNotEmpty property="call_type" prepend="AND">
		  		call_type = #call_type#
  	 		</isNotEmpty>  	 		
  	 		<isNotEmpty property="dial_no" prepend="AND">
		  		dial_no Like '$dial_no$%'
  	 		</isNotEmpty>
  	 		<isNotEmpty property="cmy_id" prepend="AND">
		  		cmy_id = #cmy_id#
  	 		</isNotEmpty>  	 		
  	 		<isNotEmpty property="duration" prepend="AND">
  					<![CDATA[  				 			   	
		  			duration >= #duration#
		  			]]>		  		
  	 		</isNotEmpty>  	 		  	
  	     </dynamic>  	     
    )tb  
    where <![CDATA[tb.rnum >= #startPage#]]>		
  </select>
  <select id="countCall" resultClass="int" parameterClass="ExtensionCallBean">  
      select 
      		/*+index(T_CALL_HISTORY IDX_T_CALL_HISTORY)+*/
      		count(1)
          from T_CALL_HISTORY
          where start_time between '$in_start_time$' and '$out_start_time$'          
          <dynamic>                    
            <isNotEmpty property="collect_date" prepend="AND">
		  		collect_date = #collect_date#
  	 		</isNotEmpty>	  
          	<isNotEmpty property="branch" prepend="AND">
		  		branch = $branch$
  	 		</isNotEmpty>
  	 		<isNotEmpty property="in_dn_no">
  	 			<isNotEmpty property="out_dn_no" prepend="AND">
  	 				dn_no  between #in_dn_no# and #out_dn_no#
  	 			</isNotEmpty>
  	 			<isEmpty property="out_dn_no" prepend="AND">
  	 				<isNotEmpty property="in_dn_no">
  	 				<![CDATA[ dn_no >=#in_dn_no#]]>		  			
  	 				</isNotEmpty>  	 				
  	 			</isEmpty>  	 					  	
  	 		</isNotEmpty>  	 	
  	 		<isEmpty property="in_dn_no">
  	 			<isNotEmpty property="out_dn_no" prepend="AND">
  	 				<![CDATA[ dn_no <= #out_dn_no#]]>		
  	 			</isNotEmpty>
  	 		</isEmpty>  	 	  	 		
  	 		<isNotEmpty property="dn_no" prepend="AND">
		  		dn_no = $dn_no$
  	 		</isNotEmpty>	 		  	 				  	
  	 		<isNotEmpty property="call_type" prepend="AND">
		  		call_type = #call_type#
  	 		</isNotEmpty>  	 		
  	 		<isNotEmpty property="dial_no" prepend="AND">
		  		dial_no Like '$dial_no$%'
  	 		</isNotEmpty>
  	 		<isNotEmpty property="cmy_id" prepend="AND">
		  		cmy_id = #cmy_id#
  	 		</isNotEmpty>  	 		
  	 		<isNotEmpty property="duration" prepend="AND">
  					<![CDATA[  				 			   	
		  			duration >= #duration#
		  			]]>		  		
  	 		</isNotEmpty>  	 		  	
  	     </dynamic>  	 
  </select>    









  에러코드별 장애건수 쿼리

  select * from(      
  select rownum rnum, tb.* from   (   
  SELECT       (
		  select 
			alarm_info 
		from t_alarm a where a.alarm_code = ac.alarm_code) alarm_info,  
		ALARM_code,    
		count(1) cnt  
  FROM T_ALARM_HISTORY ac  where alarm_date is not null          
  AND release_date between 20130701000000 and 20130701235959           
  group by ALARM_code         )tb      
  order by rnum asc   )   where rnum between 1 and 20


  등급별 장애건수 쿼리

   select * from(       select rownum rnum, tb.* from   (  
   SELECT     
	ALARM_LEVEL,   
	count(1) cnt  
	FROM T_ALARM_HISTORY   where alarm_date is not null           
	AND      release_date between 20130701000000 and 20130701235959              
	group by ALARM_LEVEL        
	)tb       order by rnum asc   )  
	where rnum between 1 and 20

프로세스별 재기동 횟수 조회

select * from(       select rownum rnum, tb.* from   (   
select       
	process_name     ,
	(select process_desc from  T_WATCH_PROCESS wp WHERE wp.PROCESS_NAME = p.process_name) process_desc     , 
	count(1) re_cnt   from T_PROCESS_STATE_HISTORY p            
	where collect_date is not null                                
	AND       collect_date between 20130801000000 and 20131028235959
	group by process_name     )tb       order by rnum asc   )   where rnum between 1 and 20

네트워크별 다운횟수 조회

select * from(       select rownum rnum, tb.* from   (    
select item, count(1) down_cnt from t_NETWORK_STATE_HISTORY                 
where collect_date is not null                                
AND       collect_date between 20131028000000 and 20131028235959                    
AND       alarm_yn = Y                                                 
group by item     )tb       order by rnum asc   )   where rnum between 1 and 20





[오전 9:05:24] miran pyon:  
http://211.192.139.139/GetRegisterInfo.action&from_server=2&e164=07076838304&hashdata=92c8d61f68c0c575f41eb30445e00a1a

&from_server=2&e164=07076838304&hashdata=92c8d61f68c0c575f41eb30445e00a1a


ibatis 설정설명
http://a07274.tistory.com/entry/Spring-iBatis-%EC%97%B0%EB%8F%99%EC%8B%9C-orgapachecommonsdbcpBasicDataSource-%EC%84%A4%EC%A0%95

startTransaction() 메소드를 통해 트랜잭션을 시작한 경우, 명시적으로
commitTransaction() 메소드를 통해 commit을 수행하지 않는다면 
endTransaction() 메소드는 실제로 rollback작업을 수행합니다. 


http://192.168.0.216:8000/SkyRBT_Post/AsrcFileUploadFileSave.action

만약 힌트를 여러개 걸고 싶다면?
select /*+ index(테이블명 인덱스명)  index(테이블명 인덱스명) */ count(idx) idx from 테이블

위와같은 형태로 하면 된다. 


PREBILL	PK_T_CAMA_HISTORY	PREBILL	T_CAMA_HISTORY	COMPANY	1	5	5	ASC
PREBILL	PK_T_CAMA_HISTORY	PREBILL	T_CAMA_HISTORY	BILL_DATE	2	8	8	ASC
PREBILL	PK_T_CAMA_HISTORY	PREBILL	T_CAMA_HISTORY	FSEQNO	3	22	0	ASC
PREBILL	PK_T_CAMA_HISTORY	PREBILL	T_CAMA_HISTORY	KIND	4	4	4	ASC
PREBILL	PK_T_CAMA_HISTORY	PREBILL	T_CAMA_HISTORY	SSEQNO	5	22	0	ASC


insert into r_basic_code values('OPT', 'PTC', null, 'PBX_TYPE 리스트');
insert into r_basic_code values('PRC', '5ESS','0' , '5ESS');

2013-11-05

전번별 통화내역 조회 상세 조회 / 엑셀 추가

통화별
- 통화합계시간 순위 조회 상세 조회 / 엑셀
- 통화합계요금 순위 조회 상세 조회 / 엑셀 


ivrMsg.xml
<action name="GetIvrNotBilling" class="skycom.pbx.ivrMsg.GetIVRNotBillingAction" method="start">
                        <result name="success">/returnMsg.jsp</result>
                </action>



$("div[id^='btnCancel']").click(function() {

// 니가 할 일

}

 

$("span[id^='btnCancel']").click(function() {

// 니가 할 일

}

 

$("button[id^='btnCancel']").click(function() {

// 니가 할 일

}



자원상태이력조회, 자원정보관리

감시항목 : HDD, TBLSPACE 일 경우 t_watch_resource 검색
t_watch_resource
나머지는 감시종류 히든처리




 /app/weblog/tomcat/%Y%m/catalina.out.%Y%m%d
export JAVA_OPTS="-Xms1024m -Xmx2048m"

인천공항 PREBILL2


2013-11-08

요율계산기

seq 만들어서 nextval insert 하고

그걸로 찾아서 표시하는걸로

Options Indexes FollowSymLinks

<VirtualHost *:80>
	
</VirtualHost>

안녕하세요 스카이컴 박정우 입니다

서버 주소 : 1. http://5.255.104.11
            2. http://5.255.104.12
수정할 파일 : /home/tomcat_itland/webapps/NHPR_Mobile/PdfView.jsp 2개의 서버다 경로는 똑같습니다.

PdfView.jsp 수정할 위치(빨간색부분을 참조하시면 됩니다)
파일 상단에
<%@ page import = "nhPR.Common.*" %> 혹시 없으면 추가해주시기 바랍니다.
<meta http-equiv="Content-Type" content="text/html; charset=EUC-KR"> 이소스 밑에
<%
Utility utility = new Utility();
%>
<form name=”ItMagagineForm” method=”Pose”> 이 소스 밑에
<input type="hidden" id="PdfFile" name="PdfFile" value="<%=utility.MakeValidString((String)session.getAttribute("PdfFile"))%>" />
<%
           String sPDFFileName =  utility.MakeValidString(request.getParameter("PdfFile"));
%>



위에 jsp 파일을 11번 서번과 12번 서버에 적용해주시면 됩니다 jsp 파일이 수정되어서 tomcat은 재실행 할 필요 없습니다.
원본파일은 꼭 백업해주시기 바랍니다.

2013-11-08

안녕하세요 스카이컴 박정우 입니다

아래 빨간색 부분을 추가해주시면 됩니다 수정해야할 파일은
11번 12번 서버 동일한 경로입니다 

1./home/tomcat_itland/webapps/NHPR_Mobile/WEB-INF/web.xml vi로열어서 빨간색부분만 추가해주세요

<display-name>NHPR_Mobile</display-name>
  <welcome-file-list>
    <welcome-file>index.jsp</welcome-file>
  </welcome-file-list>
  <error-page>
    <exception-type>java.lang.Exception</exception-type>
    <location>/errorPage.jsp</location>
  </error-page>
  <error-page>
    <exception-type>java.io.CharConversionException</exception-type>
    <location>/errorPage.jsp</location>
  </error-page>
  <error-page>
    <error-code>404</error-code>
    <location>/errorPage.jsp</location>
  </error-page>
  <error-page>
    <error-code>500</error-code>
    <location>/errorPage.jsp</location>
  </error-page>

2./home/tomcat_itland/webapps/NHPR_Mobile/Conf/Configuration.properties 를 vi 로열어서
IOS_CHECK= 이 부분을 IOS_CHECK=ON 변경해주시기 바랍니다.





조민수 입니다.

헝가리LGEMK 서비스 중인 nxVRS에  관해 몇 가지 수정 요청 사항이 접수되었습니다.


1. Phone 번호 검색시 조건 변경.
현재 Extension 번호는  Caller 조건으로
Phone 번호는 Callee  조건으로만 검색 where 조건으로 사용됩니다.
--> Caller 'OR' Callee 조건을 이용해 Inbound / Outbound 조건에 사용되게끔 변경 요청

2. 검색 결과 정렬
 - 현재 결과 조회창에는 1페이지에 가장 오래된 데이터부터 조회됩니다.
 --> 가장 최근 데이터가 제일 먼저 출력되게끔 order 조건 변경 요청.

3. 조회 시간 단축 
 - 데이터 건수에 비해 조회 시간이 오래 걸립니다. 테이블 인덱싱 등의 처리가 필요합니다.

-> 1,2,3 인덱스에 맞게끔 전체적으로 쿼리 수정.(약2~3시간 소요)

4. nxVRS 자동 로그아웃 시간 조정
 - 로그인 후에 미사용시 자동 로그 아웃되는 경우가 빈번하여, 무기한 대기 조건으로 수정 요청.
   > 세션을 무제한으로 설정시 사용자가 logout 버튼을 클릭 하지 않고 브라우저를 닫으면 
    -> 세션에 로그인 정보가 사라지지 않기 때문에 아웃오브메모리를 발생시킬수 있습니다





위의 4개의 요청건에 대해, 적용 가능 시점 및 적용 소요시간 알려주세요.





delete from t_menu where menu_id in (5, 7);

목요일 이플 업데이트 



order by endtime desc

recordFileList
		

recordFilePolicyList
			
recordFileUserList

order by endtime desc


2013-11-11

t_record_callcenter -> callcenterseq 랑 calltype 시퀀스 잡기


헝가리
+---------------+------------+-----------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| Table         | Non_unique | Key_name              | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment |
+---------------+------------+-----------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| t_record_file |          0 | PRIMARY               |            1 | idx         | A         |      114120 |     NULL | NULL   |      | BTREE      |         | 
| t_record_file |          1 | idx_t_record_file_ccs |            1 | caller      | A         |      114120 |     NULL | NULL   | YES  | BTREE      |         | 
| t_record_file |          1 | idx_t_record_file_ccs |            2 | callee      | A         |      114120 |     NULL | NULL   | YES  | BTREE      |         | 
| t_record_file |          1 | idx_t_record_file_ccs |            3 | starttime   | A         |      114120 |     NULL | NULL   | YES  | BTREE      |         | 
| t_record_file |          1 | idx_t_record_file_s   |            1 | starttime   | A         |      114120 |     NULL | NULL   | YES  | BTREE      |         | 
+---------------+------------+-----------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+


+---------------------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| Table               | Non_unique | Key_name | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment |
+---------------------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| t_record_callcenter |          0 | PRIMARY  |            1 | idx         | A         |      159893 |     NULL | NULL   |      | BTREE      |         | 
+---------------------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+


----------+--------+------+------------+---------+
| Table        | Non_unique | Key_name | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment |
+--------------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| t_basic_code |          0 | PRIMARY  |            1 | group_code  | A         |        NULL |     NULL | NULL   |      | BTREE      |         | 
| t_basic_code |          0 | PRIMARY  |            2 | basic_code  | A         |           6 |     NULL | NULL   |      | BTREE      |         | 
+--------------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+

alter table t_record_callcenter add index IDX_T_RECORD_CALLCENTER_01 (callcenterseq, calltype);


alter table t_record_callcenter drop index IDX_T_RECORD_CALLCENTER_01;

SELECT  
	a.idx
	,b.agent
	,a.caller             
	,a.callee          
	,a.starttime          
	,a.endtime          
	,a.filename          
	,a.filedirectory          
	,if( a.starttime > a.endtime,'00:00:00', SEC_TO_TIME(unix_timestamp(a.endtime)-unix_timestamp(a.starttime)))as calltime          
	,a.memo
	,c.descr as calltype
FROM t_record_file a, t_record_callcenter b, t_basic_code c
	WHERE 1=1
	AND (a.caller = '100' OR a.callee = '200')
	AND starttime BETWEEN '20130801000000' AND '20130831235959'        
	AND c.group_code = 1
	AND a.callcenterseq = b.callcenterseq
	AND b.calltype = c.basic_code  
	order by endtime desc
	LIMIT 1, 20
;


192.168.44.27
8000


2013-11-13
19, 21, 26, 28 일 중에 농협테스트

config 에 ip 기능 추가 추가시 ios 기능 무시

nhpr_mobile 소스 김성기계장에게 전달 v





테스트 ID	비번은 1111
10039128
10037378
10050173

10040709
10038770 부서별 착신통화집계
IP : 192.168.0.3
PORT : 1521
NAME : orcl
ID : uc_admn
PW : system



아래 내용 적용한 Web war 을 긴급으로 보내주시기 바랍니다.

-- R_PREFIX_CHANGE
 .  MBI_CODE  추가
 ,  REPLAY_YN -> retry_yn
 . PK 생성

 . 아래 R_PREFIX_CHARGE.txt로  Table 재생성 후 R_PREFIX_CHARGE.xls의 데이터 import

- R_PREFIX_RATE
  . STR_PREFIX -> PREFIX
  . END_PREFIX 삭제
  . PREFIX LENGTH 삭제  
  . PK 생성

  . 기존 자료 등록된 것이 많으므로 Table을 Alter해서 작업

R_PREFIX_CHANGE는 화면이 수정될 거니까 상태씨는 메뉴얼 작업 수정해 주세요..
내용 잘 모르면 상태씨에게 문의하세요..







이플
+----------------------+------------+---------------------+--------------+---------------+-----------+-------------+----------+--------+------+------------+---------+
| Table                | Non_unique | Key_name            | Seq_in_index | Column_name   | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment |
+----------------------+------------+---------------------+--------------+---------------+-----------+-------------+----------+--------+------+------------+---------+
| t_record_file_201310 |          0 | PRIMARY             |            1 | idx           | A         |       89671 |     NULL | NULL   |      | BTREE      |         |
| t_record_file_201310 |          1 | filename            |            1 | filename      | A         |       89671 |     NULL | NULL   |      | BTREE      |         |
| t_record_file_201310 |          1 | idx_recod_file_ccse |            1 | caller_e164   | A         |         294 |     NULL | NULL   |      | BTREE      |         |
| t_record_file_201310 |          1 | idx_recod_file_ccse |            2 | callee_e164   | A         |       89671 |     NULL | NULL   |      | BTREE      |         |
| t_record_file_201310 |          1 | idx_recod_file_ccse |            3 | starttime     | A         |       89671 |     NULL | NULL   |      | BTREE      |         |
| t_record_file_201310 |          1 | idx_recod_file_ccse |            4 | endtime       | A         |       89671 |     NULL | NULL   |      | BTREE      |         |
| t_record_file_201310 |          1 | idx_recod_file_ccp  |            1 | callee_e164   | A         |       89671 |     NULL | NULL   |      | BTREE      |         |
| t_record_file_201310 |          1 | idx_recod_file_ccp  |            2 | caller_policy | A         |       89671 |     NULL | NULL   |      | BTREE      |         |
| t_record_file_201310 |          1 | idx_recod_file_s    |            1 | starttime     | A         |       89671 |     NULL | NULL   |      | BTREE      |         |
+----------------------+------------+---------------------+--------------+---------------+-----------+-------------+----------+--------+------+------------+---------+
9 rows in set (0.38 sec)


alter table t_record_callcenter add index idx_recod_file_ccse (caller_e164, callee_e164,starttime,endtime);

alter table t_record_callcenter add index idx_recod_file_ccp (callee_e164, caller_policy);
alter table t_record_callcenter add index idx_recod_file_s (starttime);




plc_list();

public void plc_list(){
		BasicCodeBean codeBean = new BasicCodeBean();
		BasicCodeMgr codeMgr = new BasicCodeMgr();
		select_list = new ArrayList();
		
		codeBean.setGroup_code("PLC"); //페이징
		try {
			select_list = codeMgr.plc_list(codeBean);
		} catch (Exception e) {
			// TODO: handle exception
		}				
	}
<input type="hidden" id="currentPage" name="currentPage" value="1" />
<div id="pageIndexList" style="width:300px; margin:0 auto;padding: 25px 0 0 0"><%-- <img src="<%=request.getContextPath()%>/images/paging.gif" alt="임의 페이징"/> --%></div>
$('#pageIndexList').html(""+str[2]+"");



가입상세내역  
월별요금조회 
월별요금상세조회 
납부내역조회 
부서별착신통화집계 
부서별 최신통화 집계는	



var chk_total_count = $("#total_count_tf").val();
	var chk1Count = "<s:text name='common.excel.count.chk1'/>";
	var chk2Count = "<s:text name='common.excel.count.chk2'/>";
	
	if(Number(chk_total_count) > Number(chk2Count)){
		alert("<s:text name='common.excel.message.chk2'/>");
		return;
	}else{
		if(Number(chk_total_count) > Number(chk1Count)){
			if(!confirm("<s:text name='common.excel.message.chk1'/>")){
				return;
			}
		}
	}



./localhost/_/org/apache/jsp/jsp2/IDDrate/

인천공항 컴파일 경로

find . -type f -name "IDDRate*"

/usr/local/tomcat/work/Catalina/localhost/_/org/apache/jsp/jsp2/IDDrate
<%@ include file="/common/jsp/authPopup.jsp" %>




국제 대역별 Prefix 요율 : Prefix 명칭 변경시 Update 안됨 -완

- 교환기 구분 LSF-3000 -> BW  : R_BASIC_CODE 사용  -완 r_basic_code 값변경

  
- 요율정보->환경등록->국가코드정보에서 제목 및 그리드에 표시되는  - 완  t_menu 데이터변경
  "국가코드"->"국제 PREFIX"로 수정 요청 및 엑셀저장시 제목과 동일하게 화일명 확인요청

  - 기초정보관리 -> 통신사업자 코드정보->엑셀저장시 화일명이 사업자코드정보로 저장되나, 
  제목과동일하게 "통신사업자코드정보"로 화일명 변경 해야됨.

- "지역/시외 대역정보" 엑셀저장시 그리드에 표시되는 내역과 엑셀내용의 제목이 상이함.
  그리드 : 대표번호        지역명   대역  / 엑셀 : 지역코드   대표번호           지역명
  
-요율명칭 팝업 띄울시 선택된 데이터가 선택되게 


- "할인시간정보" 할인시간 정보 수정시 "수정"버튼을 이용하여 수정이 되도록 요청 -완
  현재는 마우스 클릭만으로도 수정이 되며 잘못 클릭하여 변경이될 수 있으니 이부분은 반드시 수정하여야 함.





- 국제 대역별 요율상세 데이터 선택시 코드 보이게 수정 - 완
- 시외 대역별 요율상세 데이터 선택시 코드 보이게 수정 - 완

/*인증팝업*/
    openAuthPopup();
    
    if(common_auth_add_type == "N"){
    	return;
    }    
    closeAuthPopup(b_authCheck);
    /*인증팝업*/



    var g_height = $("#gridbox1").height();
	if(Number(g_height) < 50 ){
		$("#gridbox1").height("58");
	}





.
[09:54:51] ERROR [TP-Processor25] -Could not find action or result
There is no Action mapped for namespace / and action name ABILNetworkDownDetail. - [unknown location]
        at com.opensymphony.xwork2.DefaultActionProxy.prepare(DefaultActionProxy.java:186)
        at org.apache.struts2.impl.StrutsActionProxyFactory.createActionProxy(StrutsActionProxyFactory.java:41)
        at org.apache.struts2.dispatcher.Dispatcher.serviceAction(Dispatcher.java:494)
        at org.apache.struts2.dispatcher.FilterDispatcher.doFilter(FilterDispatcher.java:422)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at com.opensymphony.module.sitemesh.filter.PageFilter.parsePage(PageFilter.java:119)
        at com.opensymphony.module.sitemesh.filter.PageFilter.doFilter(PageFilter.java:55)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at org.apache.struts2.dispatcher.ActionContextCleanUp.doFilter(ActionContextCleanUp.java:99)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
        at org.apache.jk.server.JkCoyoteHandler.invoke(JkCoyoteHandler.java:190)
        at org.apache.jk.common.HandlerRequest.invoke(HandlerRequest.java:311)
        at org.apache.jk.common.ChannelSocket.invoke(ChannelSocket.java:776)
        at org.apache.jk.common.ChannelSocket.processConnection(ChannelSocket.java:705)
        at org.apache.jk.common.ChannelSocket$SocketConnection.runIt(ChannelSocket.java:898)
        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:690)
        at java.lang.Thread.run(Thread.java:662)



총합계
peaktime_monitor.jsp

http://www.dhtmlx.com/docs/products/dhtmlxGrid/samples/11_header_footer/04_pro_grid_footer.html

블랙리스트

dwr.xml

<convert converter="bean" match="skycom.pbx.ivrblacklist.IVRBlackListDTO" javascript="IVRBlackListDTO" />		
		<create creator="new" javascript="IVRBlackListAction" scope="session">
			<param name="class" value="skycom.pbx.ivrblacklist.IVRBlackListAction" />
		</create>
		<convert converter="bean" match="skycom.pbx.ivrblacklist.IVRBlackListDTO" javascript="IVRBlackListDTO" />

struts.xml

<include file="ivrblacklist.xml" />				

sqlMapConfigIVREXT.xml

<sqlMap resource="skycom/pbx/ivrblacklist/IVRBlackList.xml"/>



rhksflwk	rhksfl@02	관리자
97102422	ckdtjr@02	이창석
98102547	dmfrn@02	서을구
04301728	qudtns@02	이병순
12302381	tjdrl@02	김성기

SELECT ADMIN_ID, ADMIN_PWD, ADMIN_NAME FROM T_ADMIN WHERE ADMIN_ID IS NOT NULL
;
select EMP_SABUN , 'nacf1234' as PASS_WORD  from t_member where it_land_manager = '1'  ;


RecodeListCount,RecodeListCount2,RecodeXlsList,RecodeList,


<isNotEmpty property="line" prepend="AND">
			   		(a.caller = $line$ or a.callee = $line$)
				</isNotEmpty>
				<isNotEmpty property='custTel' prepend="AND">
					(a.caller like '$custTel$%' or a.callee like '$custTel$%')
	             </isNotEmpty>



녹취조회 쿼리 변경

경로 : VRS/WEB-INF/classes/skycom/rec/rec.xml 

vi rec.xml  로 열어서

select id 가 RecodeListCount,RecodeListCount2,RecodeXlsList,RecodeList 조건을
아래와 같이 변경

기존조건
a.caller = $line$  ==>  a.caller = $line$ or a.callee = $line$
a.caller like '$custTel$%'  ==> a.caller like '$custTel$%' or a.callee like '$custTel$%'

쿼리변경후 톰켓 리스타트

/usr/local/tomcat/bin/shutdown.sh
/usr/local/tomcat/bin/startup.sh



2013-11-28 농협

nhpr/Common/CategoryDTO.class
nhpr/Common/Utility.class

nhpr/ITLand/WriteListITLand.class

<s:property value="bean.common_menu_url"/>



http://211.237.76.81:8090/eplerecord/ExclusiveRecPage.action?callee=01026641971&callee2=01024126550&company_code=EPLE_T_TALK&regDate=20131005

pdf 바로보기

http://dol82.net/48




[구성]
개발자용 개발환경(Implementation Tool) Full Version은 개발자의 코드 작성을 지원하는 도구로써, eGovFrame기반의 어플리케이션 개발을 지원하는 IDE와 Editor(SourceCode, UML, ERD, DBIO, WebFlow, Code Generation, Code Inspection, 공통컴포넌트 생성, 맞춤형 개발환경, Nexus, SVN)와 Debug(Local, Remote), Mobile IDE, Batch IDE, RDT로 구성되어 있습니다.
[개선 기능]
- 이클립스 버전 업그레이드(Juno SR1 -> Juno SR2)
- 배치 개발환경 영문 메시지 추가
- 배치 운영환경 DDL 수정(FILE_CN : BLOB => CLOB)
- Amateras UML 버전 업그레이드(1.3.2 -> 1.3.4) : JDK 1.7에서 UML 저장 오류 수정
- 표준프레임워크 플러그인 설치시 배치 플러그인 라이선스 미표시 수정
- 템플릿 소스 수정 : 엔터프라이즈 EgovNoticeInqire.jsp
- eGovFrame Mobile Project Example DB 방식 변경 (embedded hsql)
- eGovFrame Web Project example DB 방식 변경 (embedded hsql)
- 공통컴포넌트 / 모바일 공통컴포넌트 마법사 기능 추가 : 마법사 기능을 이용해서 cubrid 생성시 오류 수정
- 개발환경 템플릿 JDK 버전 변경(1.5 -> 1.6)
- splash 이미지 변경(2.5 -> 2.6)
[설치방법]
개발환경을 구성할 디렉토리에 eGovFrameDev-2.6.0-FullVer.zip의 압축을 풀어 eclipse를 실행하면 개발환경 필수요소와 선택요소가 모두 설치되어있는 개발환경을 사용할 수 있습니다.
[추가사항1]eclipse 실행 후 Failed to create the Java Virtual Machine 오류 발생 시, eclipse 설치 경로 > eclipse.ini 파일에 사용자 PC의 JDK 설치 경로를 다음과 같이 추가합니다.
(JDK는 1.6 버전을 권장한다. 1.5버전에서는 JSP Editor가 제대로 동작하지 않을 수 있음)
(예시)
openFile
-vm
C:\Program Files\Java\jdk1.6.0_47\bin\javaw.exe
-vmargs
-Dosgi.requiredJavaVersion=1.6
-Xms40m
-Xmx712m
-Dfile.encoding=UTF-8
[추가사항2]템플릿 생성 위저드를 이용하여 프로젝트 생성시 일부 DML파일의 한글깨짐 현상이 발생 할 수 있습니다. 위와 같은 문제 발생시 해당 DML파일의 encoding형식을 UTF-8에서 EUC-KR로 바꾸게 되면 정상적으로 사용 할 수있습니다.


R언어

네티(Netty)나 스캘딩(Scalding)


자바 튜닝 / 성능모니터링을 위한 체크리스트
본 내용은 자바 성능을 결정짓는 코딩 습관과 튜닝 이야기(이상민 지음, 한빛미디어)을 요약한 내용+a입니다.

Needs에 맞는 패턴 활용
켄트 벡의 구현 패턴 : 가까운 시일내에 읽어볼 예정임

VO패턴이나 Service-Locator패턴은 반드시 사용하자

리팩토링
마틴 파울러의 리팩토링 : 역시 가까운 시일내에 읽어볼 예정임

garbage collection에 대한 이해
메모리(변수, 객체) 할당/해제에 대해 신경을 써야 한다

절대 System.gc()를 써서 명시적으로 gc를 요청하면 안된다

JVM의 gc 관련 옵션으로 상황에 맞는 gc방법을 지정하여 성능 향상을 꾀할 수 있다

gc 모니터링/분석을 위한 Tool과 방법

jvmstat : SUN에서 제공하는 무료 툴, jdk1.4.2이상이면 바로 사용가능, jdk1.4.1이면 -XX:+UsePerfData 옵션을 사용하면 됨 
visualgc : SUN에서 제공하는 무료 툴 
java -verbosegc옵션 
jps : jvm 프로세스를 보여줌 
jstat : jvm 통계수치를 보여줌 
jstatd : 원격으로 jstat을 사용하기 위한 데몬 
[참고]/lib/security/java.policy에 다음을 추가해야 jstatd 사용가능함

grant codebase &quot;file:${java.home}/../lib/tools.jar&quot; {
	permission java.security.AllPermission;
};프로파일링과 APM 툴의 활용
프로파일링 툴(Profiling Tool) : 소스 레벨 분석용, DevPartner for Java, JProbe, TPTP(Eclipse용) 
APM(Application Performance Monitoring or Management) : 애플리케이션 실행 상황 모니터링/문제점 진단용, Jennifer, IntroScope, I3, Vantage Analyzer 
System Class 활용
arraycopy

Property관련 : getProperties, getProperty, setProperties, setProperty

Native Library 관련 : load, loadLibrary

gc관련 : gc, runFinalization

시간 관련  : currentTimeMilis, nanoTime

String, StringBuffer, StringBuilder
String : 짧은 문자열 더할때 
StringBuffer : Thread-Safe가 필요할 때 
StringBuilder : Thread-Safe가 필요없을때 
Collection & Map
적절한 자료구조를 선택해서 사용하라

대용량 데이타가 아닌 경우 성능차이는 그다지 크지 않다, 대용량 데이터의 경우는 간략한 테스트 후 선택한다

Sun의 추천 목록 : HashSet, ArrayList, HashMap, LinkedList

종류

Collection : 최상위 클래스 
Set : 중복불허 집합 
SortedSet : 오름차순 정렬 Set 
List : 순서가 있는 Set 
Queue : FIFO구현, 객체 순차 처리용으로 많이 사용 
Map : 키-값 쌍으로 구성된 객체 Set, 중복키 불허 
SortedMap : 키를 오름차순 정렬하는 Map 
HashSet : 데이타를 Hash Table에 저장, 순서없슴 
TreeSet : red-back 트리에 저장 
LinkedHashSet : 저장된 순서대로 순서가 결정되는 HashSet 
Vector : 크기 지정필요없는 배열 
ArrayList : 동기화 처리 안됨, Vector와 비슷 
LinkedList : ArrayList와 동일 + Queue인터페이스 구현 
HashTable : 데이터를 해쉬테이블에 저장, 동기화됨 
HashMap : null값 허용 + 동기화안됨을 제외하고는 HashTable과 동일 
TreeMap : red-back 트리에 데이터를 저장, TreeSet과 다른 점은 키에 의해 순서가 정해짐 
LinkedHashMap : Double-Linked List방식을 제외하고 HashMap과 동일 
PriorityQueue : 큐에 추가된 순서가 아니라 객체 생성 순서대로 Pop되는 Queue 
LinkedBlockingQueue : FIFO기반의 Linked 노드를 사용하는 Blocking Queue 
ArrayBlockingQueue : 크기 정해짐, FIFO기반 Blocking Queue 
PriorityBlockingQueue : 크기 안 정해짐, 객체 생성 순서대로 Pop되는 Queue 
DelayQueue : 대기시간을 정할 수 있는 Queue 
SynchronousQueue : put()호출하면, 다른 thread에서 take()해줄때까지 대기하는 Queue 
동기화 여부

동기화됨 – Vector, HashTable 
동기화안됨 – HashSet, TreeSet, LinkedHashSet, ArrayList, LinkedList, HashMap, TreeMap, LinkedHashMap 
동기화안된 Collection을 위한 메쏘드 : Collections.synchronizedXXX (XXX = Set, SortedSet, List, Map)

Loop 성능 향상
if나 switch나 성능은 비슷, 가독성 측면만 고려하면 됨

Loop안에서의 쓸데없는 변수/객체 생성, 메쏘드 호출을 최대한 제거

for loop 구현방법 : 속도 : Code #1 < Code #2 < Code #3

Code #1

for(int i = 0; i < arrData.length(); i++)

Code #2

Vector v = …

for(String str : v )

Code #3

int intLength = arrData.length();

for(int i = 0; i < intLength; i++)

static
static 선언된 변수 : 객체가 아니라 클래스에 속함, 모든 객체가 동일한 변수 1개를 참조하게 됨, gc도 이뤄지지 않음

static 블럭 : 생성자와 상관없이 최초 1회 실행됨

자주 사용, 절대 변하지 않는 변수는 final static으로 선언

설정파일정보도 static으로 관리하는 것이 좋다

code성 데이타는 DB에서 1회 읽도록 한다

synchronized
하나의 객체를 여러 Thread에서 사용해야 하는 경우 -> 해당 객체에 접근하는 method에 synchronized 선언

static으로 선언된 객체를 여러 Thread에서 사용해야 하는 경우 -> 해당 객체에 접근하는 method에 static synchronized 선언

java.util.Concurrent 패키지를 이용해서 Thread관리 – Lock, Executors, Concurrent Collection, Atomic 변수

reflection class를 통해 클래스 정보 등을 얻을 수 있다
Class, Method, Field

JMX와 함께 모니터링 부분 구현 가능

IO병목 해결
설정파일 사용시 매번 갱신여부 확인하는 대신에 데몬 쓰레드로 주기적 점검하는 식으로 구현

파일 복사 or 네트워크 작업시 NIO이용

개인적으로는 Netty 이용할 예정

Logging
상용 배포전에 모두 제거하는 게 Best

로깅여부 Flag(final로 선언)를 둬서 Logging

System.out.println대신에 Logger or Log4j를 이용

Exception처리시에도 printStackTrace대신에 Exception에서 필요한 부분만 로깅하도록 구현

DB사용
Connection Pool or Data Source 사용하여 Connection 관리

사용가능할 경우, Statement보다 PreparedStatement를 주로 사용

Connection, Statement, ResultSet 관리 철저 : 생성시 Connection – Statement – ResultSet순, 닫을때는 역순

Connection conn = null;
Statement stmt = null;
ResultSet rs = null;

try {
	...
} catch (Exception e) {
	...
} finally {
	try { rs.close(); rs = null; } catch ( Exception e ) {}
	try { stmt.close(); stmt = null; } catch ( Exception e ) {}
	try { conn.close(); conn = null; } catch ( Exception e ) {}
}ResultSet의 last()는 절대 사용불가 : 차라리 데이터 개수 확인을 위해 쿼리를 날려라 or 배열 대신에 Vector를 사용해서 데이타를 리턴

데이터 조작없이 조회만 하는 경우는 setAutoCommit()를 사용하지 말자

배치성 작업을 위해서는 executeBatch()를 이용하자

setFetchSize()를 이용해서 적당한 개수를 Fetch하도록 직접 지정하자

1건이 필요하면, 1건만 쿼리하라

XML 관련
SAX : 이벤트에 맞춰 순차적으로 처리, 트리 따라다니기기 쉽지 않음, 메모리 사용량은 적음

DOM : 전체 xml 내용을 트리로 만들어 메모리에 적재, 전체를 메모리에 올리므로 메모리 사용량 많음

웹서버 관련
httpd.conf 설정내용

Include conf/extra/httpd-mpm.conf

KeepAlive On

KeepAliveTimeout 15

HostnameLookups는 무조건 off

로그 포맷에 %D(요청처리시간을 마이크로초 단위로 표시), %T(요청처리시간을 초 단위로 표시)

httpd-mpm.conf

<IfModule mpm_worker_module>

StartServers : 최초에 띄울 프로세스의 수

MaxClients : 최대 처리 가능한 클라이언트의 수

MinSpareThreads : 최소 여유 쓰레드 수

MaxSpareThreads : 최대 여유 쓰레드 수

ThreadsPerChild : 프로세스당 쓰레드 수

MaxRequestsPerChild : 프로세스당 최대 요청 수

</IfModule mpm_worker_module>웹로그 분석 : Analog, AWStats, Webalizer

정적인 내용(이미지, 플래시, 자바스크립트 등)이 많을 경우에는 따로 서버를 두어 해결하는 방안도 고려

DB Connection Pool 설정
Thread수는 Connection 개수보다 10개 정도 많게 설정

session timeout을 설정하자
JVM설정
jvm에 메모리 설정 -Xmx는 최대 메모리, -Xms는 최소 메모리

inspection tool
Hammurapii, PMD. CheckStyle

모니터링 API JMX
Jconsole은 JMX 모니터링용 툴(Sun에서 제공)

JMX 원격 모니터링을 위한 VM옵션

-Dcom.sun.management.jmxremote.port=9003

-Dcom.sun.management.jmxremote.password.file=/파일위치

-Dcom.sun.management.jmxremote.access.file=/파일위치

-Dcom.sun.management.jmxremote.ssl=false

문제 진단을 위한 참고사항
http://java.sun.com/javase/6/webnotes/trouble/other/matrix6-Windows.html

http://java.sun.com/javase/6/webnotes/trouble/other/matrix6-Unix.html




slf4j - log4j 설정
필요lib: slf4j-api-1.7.5.jar, slf4j-log4j12-1.7.5.jar, slf4j-simple-1.7.5.jar, log4j-1.2.17.jar





2013-12-03


헝가리 vrs 컬럼

Extension Number = caller 
callee




Extension Number = a.caller
phone = callee

session timeout 6시간

2013-12-04
인천공항 메뉴등록

insert into t_menu values(35, 2, 2, '요율파일', '#', 4)
insert into t_menu values(39, 35, 3, '요율파일 게시판', 'RATEFILE.action', 1)

delete from t_auth;
insert into t_auth(
           user_id, menu_id
           ) select 'admin', menu_id from t_menu where menu_level in('2','3');



xmlBf.append("<cell><![CDATA["+func.f_NullCheck(func.dateChange(bean.getCreate_dt()))+"]]></cell>");
xmlBf.append("<cell><![CDATA["+func.f_NullCheck(func.dateChange(bean.getUpdate_dt()))+"]]></cell>");
,<s:text name="header.create_dt"/>,<s:text name="header.update_dt"/>
,"<s:text name='header.create_dt'/>","<s:text name='header.update_dt'/>"
,create_dt
,update_dt
,create_dt,update_dt
,CREATE_DT,UPDATE_DT
, update_dt = to_char(sysdate,'YYYYMMDDHH24MISS')

할인시간코드 0, 지역코드정보  0, 지역/시외 대역 정보 0, 시외 지역별 요율코드 0, 시외 대역별 요율코드 0, 국제 대역별 요율코드 0, 국제 지역별 요율코드 0
--------------------------------
광대역정보, 시외인접정보,국제 PREFIX 정보,국가/국제 대역 정보, 공휴일 정보,Prefix 변환,일반 요율 상세,시외 대역별 요율상세
시외 지역별 요율상세,국제 대역별 요율상세,국제 지역별 요율상세,Prefix요율정보 (4개화면)
---------------------------------------------
장애코드 관리,CAMA 환경관리,CAMA 전송주기 관리,교환기 전번 관리,MBI 관리,네트워크 정보 관리,자원정보 관리,프로세스 정보 관리


alter table R_DC_TIME add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table R_DC_TIME add(UPDATE_DT varchar2(14) );
alter table R_DC_TIME_CODE add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table R_DC_TIME_CODE add(UPDATE_DT varchar2(14) );
alter table R_DDD add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table R_DDD add(UPDATE_DT varchar2(14) );
alter table R_DDD_BAND add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table R_DDD_BAND add(UPDATE_DT varchar2(14) );
alter table R_DDD_BAND_RATE add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table R_DDD_BAND_RATE add(UPDATE_DT varchar2(14) );
alter table R_RATE_CODE add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table R_RATE_CODE add(UPDATE_DT varchar2(14) );
alter table R_WDD add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table R_WDD add(UPDATE_DT varchar2(14) );
alter table R_LDD add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table R_LDD add(UPDATE_DT varchar2(14) );
alter table R_IDD add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table R_IDD add(UPDATE_DT varchar2(14) );
alter table R_IDD_BAND add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table R_IDD_BAND add(UPDATE_DT varchar2(14) );
alter table R_HOLIDAY_INFO add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table R_HOLIDAY_INFO add(UPDATE_DT varchar2(14) );
alter table R_PREFIX_CHANGE add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table R_PREFIX_CHANGE add(UPDATE_DT varchar2(14) );
alter table R_NORMAL_RATE add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table R_NORMAL_RATE add(UPDATE_DT varchar2(14) );
alter table R_DDD_CODE_RATE add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table R_DDD_CODE_RATE add(UPDATE_DT varchar2(14) );
alter table R_IDD_BAND_RATE add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table R_IDD_BAND_RATE add(UPDATE_DT varchar2(14) );
alter table R_IDD_CODE_RATE add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table R_IDD_CODE_RATE add(UPDATE_DT varchar2(14) );
alter table R_PREFIX_RATE add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table R_PREFIX_RATE add(UPDATE_DT varchar2(14) );
alter table T_ALARM add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table T_ALARM add(UPDATE_DT varchar2(14) );
alter table T_CAMA_CONFIG add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table T_CAMA_CONFIG add(UPDATE_DT varchar2(14) );
alter table T_CAMA_SCHEDULE add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table T_CAMA_SCHEDULE add(UPDATE_DT varchar2(14) );
alter table T_DN_RANGE add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table T_DN_RANGE add(UPDATE_DT varchar2(14) );
alter table T_MBI_CODE add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table T_MBI_CODE add(UPDATE_DT varchar2(14) );
alter table R_RATE_FILE add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table R_RATE_FILE add(UPDATE_DT varchar2(14) );
alter table T_WATCH_NETWORK add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table T_WATCH_NETWORK add(UPDATE_DT varchar2(14) );
alter table T_WATCH_RESOURCE add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table T_WATCH_RESOURCE add(UPDATE_DT varchar2(14) );

alter table T_WATCH_PROCESS add(CREATE_DT varchar2(14) default to_char(sysdate,'YYYYMMDDHH24MISS'));
alter table T_WATCH_PROCESS add(UPDATE_DT varchar2(14) );






  CREATE TABLE "PREBILL2"."R_RATE_FILE" 
   (	"IDX" NUMBER(*,0) NOT NULL ENABLE, 
	"SUBJECT" VARCHAR2(50 BYTE) NOT NULL ENABLE, 
	"DESCRIPTION" VARCHAR2(100 BYTE), 
	"FILE_NAME" VARCHAR2(100 BYTE)
   ) PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT)
  TABLESPACE "PREBILL_RATE_DATA" ;








  http://g2unu.blogspot.kr/2013/02/solaris10-apache2-tomcat6.html
안녕하세요 스카이컴 박정우 입니다
###설치파일은 네이버 메일로 보내 놓겠습니다###
###apache 실행 : /usr/local/apache2/bin/apachectl start /apachectl stop
###tomcat 실행 : /usr/local/tomcat/bin/startup.sh /shutdown.sh

###apache 설치

1.솔라리스 설치시 apache가 설치되어있어서 설치되어있는 아피치 삭제

> pkginfo -i | grep -i apache
> pkgrm 패키지명

2.
> 설치시 root 계정으로 진행 하며 gcc도 설치되어있어야 한다.

3.
> tart xvf httpd-2.2.25.tar

4.
> cd httpd-2.2.16
> ./configure --enable-so --enable-mods-shared=most

5.
> make && make install

6.
> /usr/local/apache2 설치완료

###tomcat 설치

이전 서버에 설치되어있는 /usr/local/tomcat 
tomcat 폴더를 통채로 압축해서
새로운 서버 /usr/local 폴더에 압축을 풀어주면됩니다.


###cronolog 설치 
[cronolog 설치]

1.
> tar xvfz cronolog-1.6.2.tar
2. 
> cd cronolog-1.6.2
3. 
> ./configure --prefix=/usr/local/
4. 
> make;make install

###apache tomcat 연동

1.
> tart xvf tomcat-connectors-1.2.37-src.tar
2.
> cd tomcat-connectors-1.2.37-src
3.
> ./configure --with-apxs=/usr/local/apache2/bin/apxs
4. 
> make && make install
5.
> /usr/local/apache2/modules 에 mod_jk.so 생성되어있는지 확인
6.
> 구서버 /usr/local/apache2/conf 로 이동하여 mod_jk.conf, uri.properties, workers.properties 를 복사해서
  신서버 /usr/local/apache2/conf 복사해서 붙여 넣는다
7.
> /usr/local/apache2/conf/httpd.conf vi로열여서 shift+g 맨아래로 내려가서  
 이줄 추가 해주세요 Include conf/mod_jk.conf

###로그 설정
[tomcat]

1. 구서버에서 tomcat 폴더를 복사했기때문에 설정 할 건 없습니다.
/app/weblog/ 경로에 tomcat 폴더만 생성해주세요

[apache]

1. 구서버에 /usr/local/apache2/conf/httpd.conf vi로열어서 /crono 를 찾아주세요
신서버에 똑같이 설정하시면됩니다.
/app/weblog/ 경로에 apache 폴더를 생성해주세요





  
 톰캣에서 보안설정하는 방법..<login-config>
[출처] 톰캣에서 보안설정하는 방법..<login-config> |작성자 DrKarman



여러가지 방법 중 두가지를 설명한다. FORM과 BASIC방식
아래에서 하려고하는 작업은 tomcat에 있는 test01이라는 application중에서 protected라는 디렉토리 아래에 있는 내용을 클라이언트가 요청을 했을경우 사용자를 확인하려고 하는 것이다.
http://localhost:8080/test01/index.html
을 요청하면 사용자는 아무런 제약없이 
c:tomcatwebappstest01index.html
에 접근할수 있는 것이다. 보안이 지정되지 않은 일반적인 영역이기 때문이다. 하지만
http://localhost:8080/test01/protected/index.html
을 요청한다면 사용자는 올바른 아이디와 암호를 입력해야 할 것이다.
두가지 방식을 테스트하기 전에 먼저 사용자에 관한 내용을 설정해줘야 한다. 이것은 TOMCAT_HOMEconftomcat-users.xml에 설정을 해준다.
[출처] 톰캣에서 보안설정하는 방법..<login-config> |작성자 DrKarman

http://blog.naver.com/PostView.nhn?blogId=deadlines&logNo=150033163033
보안
http://4te.co.kr/572







libintl.so.8






농협 NH_Twitter 업데이트
수정파일 및 경로 컴파일된 파일적용시에는 확장자 class 파일을 적용해주시기 바랍니다.
${TOMCAT_HOME}/webApps/NH_Twitter/WEB-INF/classes/skycom/ws/rest/Service/LoginService/LoginService.java
${TOMCAT_HOME}/webApps/NH_Twitter/WEB-INF/classes/skycom/core/LoginCore.java

${TOMCAT_HOME}/webApps/NH_Twitter/WEB-INF/classes/skycom/query/login.xml
아래 추가해주세요
<select id="get_device_token" resultClass="String" parameterClass="java.util.Map">
	SELECT emp_devicetoken  FROM T_MEMBER
	 WHERE emp_sabun =#user_id#
</select>

${TOMCAT_HOME}/webApps/NH_Twitter/WEB-INF/classes/MessageResource.properties

마지막줄에 추가
LOGIN.FIX.OS_VERSION=7.0.4
LOGIN.FIX.APP_VERSION=2.002
LOGIN.FIX.CONNECT_TYPE=3
LOGIN.FIX.JAILBREAK_FLAG=N

모바일쪽은 properties 가 암호화 되어 있을 수 있습니다 아래는 암호화 된 값입니다
#LOGIN.FIX.OS_VERSION=4EE3D7F079D2E7FB1C41BA207FBC236A
#LOGIN.FIX.APP_VERSION=1BF694E1FF208DF9009F9E296E3AE613
#LOGIN.FIX.CONNECT_TYPE=35116B284CE6E1DBF6EA8B19BBE1F757
#LOGIN.FIX.JAILBREAK_FLAG=7F828427D040755A7EBBD2C07A5508B2



1.전체 소스 한곳으로 보관
2.파일 수정에 관한 history 관리, 개발 요청에 관한 history
3.컴파일 변경 방식..(ant, maven) 사용하여 서버에서 컴파일 할 수 있도록
4.서버 적용시 class 파일 변경으로 적용이 아닌 war파일 적용으로 컴파일
5.




2013-12-17

안녕하세요 스카이컴 박정우 입니다

war 파일 tomcat 경로에 업로드후 
tomcat 리스타트 , ./localhost/_/org/apache/jsp/ 컴파일 경로 삭제를 해주시기 바랍니다.


[인천공항] rate.war_20131217_v1

인천공항 메뉴등록

update t_menu set sort = '1' where menu_id = '120';
insert into t_menu values(43, 45, 3, '데이터 조회', 'OLDEXTENSIONReport.action', 1)
insert into t_menu values(45, 9, 2, '메인빌링 데이터 조회', '#', 2)
insert into t_menu values(46, 44, 3, '(구빌링)전번별 통화 내역 조회', 'REALOLDEXTENSIONReport.action', 3)
delete from t_auth;
insert into t_auth(
           user_id, menu_id
           ) select 'admin', menu_id from t_menu where menu_level in('2','3');



CREATE INDEX IDX_DTCDR_02 ON DTCDR
(CALL_MM,BRANCH,DN_NO,ENDTM,DURATION)
LOGGING
TABLESPACE PREBILL_CDR_DATA
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       2147483645
            PCTINCREASE      0
            FREELISTS        1
            FREELIST GROUPS  1
            BUFFER_POOL      DEFAULT
           )
NOPARALLEL;


http://insomniasoo.com/trac/MyLib/wiki/EclipseDeploy

http://nakanara.tistory.com/65
hudson




tomcat gc
http://www.goldpitcher.co.kr/pages/viewpage.action?pageId=85230276
http://blog.naver.com/PostView.nhn?blogId=goni9071&logNo=130072981315
[20:39:24] DEBUG [http-8000-53] -{rset-1291627} Result: [0]
total_dataCount0
total_RecdataCount0
#
# There is insufficient memory for the Java Runtime Environment to continue.
# Native memory allocation (malloc) failed to allocate 131080 bytes for Chunk::new
# An error report file with more information is saved as:
# /usr/local/tomcat/bin/hs_err_pid13883.log
~
 There is insufficient memory for the Java Runtime Environment to continue.
# Native memory allocation (malloc) failed to allocate 131080 bytes for Chunk::new
# Possible reasons:
#   The system is out of physical RAM or swap space
#   In 32 bit mode, the process size limit was hit
# Possible solutions:
#   Reduce memory load on the system
#   Increase physical memory or swap space
#   Check if swap backing store is full
#   Use 64 bit Java on a 64 bit OS
#   Decrease Java heap size (-Xmx/-Xms)
#   Decrease number of Java threads
#   Decrease Java thread stack sizes (-Xss)
#   Set larger code cache with -XX:ReservedCodeCacheSize=
# This output file may be truncated or incomplete.
#
#  Out of Memory Error (allocation.cpp:317), pid=13883, tid=735898512
#
# JRE version: 6.0_24-b24
# Java VM: OpenJDK Server VM (20.0-b12 mixed mode linux-x86 )
# Derivative: IcedTea6 1.11.11.90
# Distribution: CentOS release 5.9 (Final), package rhel-1.41.1.11.11.90.el5_9-i386

---------------  T H R E A D  ---------------

Current thread (0x08167000):  JavaThread "C2 CompilerThread0" daemon [_thread_in_native, id=13898, stack(0x2bd4e000,0x2bdcf000)]

Stack: [0x2bd4e000,0x2bdcf000],  sp=0x2bdcc610,  free space=505k
Native frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)
V  [libjvm.so+0x6f8137]





~
~MemTotal:     16632324 kB 16기가
MemFree:       7511640 kB 7기가
Buffers:        240260 kB 
Cached:        7598948 kB
SwapCached:          0 kB
Active:        2673132 kB
Inactive:      6203072 kB
HighTotal:    15857936 kB
HighFree:      7203712 kB
LowTotal:       774388 kB
LowFree:        307928 kB
SwapTotal:     5406712 kB
SwapFree:      5406712 kB
Dirty:             384 kB
Writeback:           4 kB
AnonPages:     1037152 kB
Mapped:         109340 kB
Slab:           211068 kB
PageTables:       8356 kB
NFS_Unstable:        0 kB
Bounce:              0 kB
CommitLimit:  13722872 kB
Committed_AS:  2359168 kB
VmallocTotal:   116728 kB
VmallocUsed:      7772 kB
VmallocChunk:   108564 kB
HugePages_Total:     0
HugePages_Free:      0
HugePages_Rsvd:      0
Hugepagesize:     2048 kB
~

find . -type f -name "IDDRate*"


Java Runtime Environment (JRE)를 계속하기위한 메모리가 부족합니다.
# 기본 메모리 할당 (malloc에​​)는 청크에 대한 131,080 바이트 :: 새를 할당하는 데 실패
# 가능한 이유 :
# 시스템은 물리적 RAM 또는 스왑 공간이 부족합니다
중 32 비트 모드에서, 프로세스 크기 한계가 맞았다
# 가능한 솔루션 :
#는 시스템 메모리 부하를 줄이고
# 실제 메모리 또는 스왑 공간을 증가
스왑 백업 저장소가 꽉 찬 경우 # 확인
# 사용 (64)는 64 비트 OS에서 Java 비트
# 감소 자바 힙 크기 (-Xmx/-Xms)
Java 스레드 중 감소 번호
# 감소 자바 스레드 스택 크기 (-XSS)
#와-XX 큰 코드 캐시를 설정 ReservedCodeCacheSize =
#이 출력 파일이 잘 리거나 불완전 할 수 있습니다.
#
# 메모리 부족 오류 (allocation.cpp : 317), PID = 13883, TID = 735,898,512
#
# JRE 버전 : 6.0_24-B24
# 자바 VM : 오픈 JDK 서버 VM (20.0-B12 혼합 모드 리눅스-86)
# 유도체 : IcedTea6 1.11.11.90
# 배포 : CentOS에이 해제 5.9 (최종), 패키지 RHEL-1.41.1.11.11.90.el5_9-I386

CATALINA_OPTS="$CATALINA_OPTS $JPDA_OPTS" -server -XX:PermSize=256m -XX:MaxPermSize=768m -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+PrintHeapAtGC -XX:+UseParallelGC
HOME_DIR=/usr/local/emsmq/emsif
CONFIG_GC="
-Xms256M -Xmx512M 
-verbosegc -Xloggc:${CATALINA_HOME}/gclog.log -XX:+PrintGCTimeStamps -XX:+PrintGCDetails -XX:+PrintHeapAtGC -XX:+HeapDumpOnOutOfMemoryError
"

/usr/local/sbin/cronolog /home/weblog/tomcat/%Y%m/%d/catalina.out.%Y%m%d%H &

2013-12-20
안녕하세요 스카이컴 박정우 입니다

 

war 파일 tomcat 경로에 업로드후 

 

tomcat 리스타트 , ./localhost/_/org/apache/jsp/ 컴파일 경로 삭제를 해주시기 바랍니다.


insert into t_menu values(48, 45, 3, '유실 데이터 조회', 'LOSTOLDEXTENSIONReport.action', 2)
delete from t_auth;
insert into t_auth(
           user_id, menu_id
) select 'admin', menu_id from t_menu where menu_level in('2','3');


  CREATE TABLE "PREBILL"."USAGE_LOST" 
   (	"CUSTOMER_ID" VARCHAR2(14 BYTE), 
	"SUBSCRIBER_ID" VARCHAR2(14 BYTE), 
	"PP_CD" VARCHAR2(8 BYTE), 
	"CALL_STT_TIME" VARCHAR2(30 BYTE), 
	"MARKET_CD" VARCHAR2(4 BYTE), 
	"CARRIER_CD" VARCHAR2(12 BYTE), 
	"RECORD_TYPE" VARCHAR2(6 BYTE), 
	"SWITCH_ID" VARCHAR2(20 BYTE), 
	"CALL_DIRECTION" VARCHAR2(2 BYTE), 
	"CALLING_DN" VARCHAR2(42 BYTE), 
	"CALLING_DN_TYPE" VARCHAR2(4 BYTE), 
	"CHARGING_TYPE" VARCHAR2(4 BYTE), 
	"CALL_TYPE" VARCHAR2(4 BYTE), 
	"CALL_END_TIME" VARCHAR2(30 BYTE), 
	"CALL_DUR_SEC" NUMBER(9,1), 
	"CALL_TERM_TYPE" VARCHAR2(2 BYTE), 
	"VAS_TYPE" VARCHAR2(2 BYTE), 
	"VAS_CD1" VARCHAR2(4 BYTE), 
	"VAS_CD2" VARCHAR2(48 BYTE), 
	"ISDN_CHANNEL_TYPE" VARCHAR2(2 BYTE), 
	"ISDN_PACKET_CNT" NUMBER(22,0), 
	"ISDN_UUS_BYTE" NUMBER(22,0), 
	"INCOMP_CALL_LEVEL" VARCHAR2(2 BYTE), 
	"INCOMP_CALL_TYPE" VARCHAR2(4 BYTE), 
	"OUT_V52_IF_ID" VARCHAR2(12 BYTE), 
	"OUT_V52_LINK_ID" VARCHAR2(4 BYTE), 
	"CID_TYPE" VARCHAR2(8 BYTE), 
	"SPECIAL_INFO1" VARCHAR2(4 BYTE), 
	"SPECIAL_INFO2" VARCHAR2(4 BYTE), 
	"SYS_CREATE_DT" DATE, 
	"SYS_UPDATE_DT" DATE, 
	"CHG_AMOUNT" NUMBER(13,2), 
	"AIS_CHG_AMT" NUMBER(13,2), 
	"CDR_TYPE" VARCHAR2(2 BYTE), 
	"CALLING_CENTREX_GROUP" VARCHAR2(8 BYTE), 
	"PARTY_PREFIX_NO" VARCHAR2(14 BYTE), 
	"DOMASTIC_REGION_GROUP" VARCHAR2(4 BYTE), 
	"PREFIX_NO" VARCHAR2(14 BYTE), 
	"PARTY_NO" VARCHAR2(12 BYTE), 
	"INTL_COUNTRY_GROUP" VARCHAR2(4 BYTE), 
	"UNIT_INI_1" NUMBER(22,0), 
	"UNIT_INI_2" NUMBER(22,0), 
	"RATE_INI_1" NUMBER(6,2), 
	"RATE_INI_2" NUMBER(6,2), 
	"UNIT_PRD_1" NUMBER(22,0), 
	"UNIT_PRD_2" NUMBER(22,0), 
	"UNIT_PRD_3" NUMBER(22,0), 
	"UNIT_PRD_4" NUMBER(22,0), 
	"UNIT_PRD_5" NUMBER(22,0), 
	"UNIT_PRD_6" NUMBER(22,0), 
	"RATE_PRD_1" NUMBER(6,2), 
	"RATE_PRD_2" NUMBER(6,2), 
	"RATE_PRD_3" NUMBER(6,2), 
	"RATE_PRD_4" NUMBER(6,2), 
	"RATE_PRD_5" NUMBER(6,2), 
	"RATE_PRD_6" NUMBER(6,2), 
	"SP_RECORD_TYPE" VARCHAR2(6 BYTE), 
	"CALL_MM" NUMBER(2,0), 
	"CALLED_DN" VARCHAR2(32 BYTE), 
	"CDR_SEQ" VARCHAR2(15 BYTE) NOT NULL ENABLE, 
	"PBX_TYPE" VARCHAR2(10 BYTE) NOT NULL ENABLE, 
	"PBID" VARCHAR2(10 BYTE) NOT NULL ENABLE
   ) PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT)
  TABLESPACE "PREBILL_CDR_DATA" ;




CREATE INDEX IDX_USAGE_LOST_01 ON USAGE_LOST
(CALL_END_TIME)
LOGGING
TABLESPACE PREBILL_CDR_DATA
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       2147483645
            PCTINCREASE      0
            FREELISTS        1
            FREELIST GROUPS  1
            BUFFER_POOL      DEFAULT
           )
NOPARALLEL;


[linux][Jstat으로 JVM heap memory 모니터링하기]




1. jstat 수행 방법




- 우선 모니터링 하고자 하는 프로세스의 ID 를 확인합니다.

  확인하는 방법은 ps -ef | grep java 로 확인을 해도 되고, 

  프롬프트 상태에서 jps 라고 입력한 뒤 엔터를 치면 해당 JVM에서 수행된 프로세스의 ID를 보여줍니다.

  (jps 사용시에는 PATH에 해당 JDK가 설정되어 있어야 합니다.







- 두번째로 jstat 명령을 수행 합니다.

jstat -gcutil -h20 -t 7251 3000 3000

 -> gcutil : gcutil 에 대해서 수행

 -> -h20 : 20라인마다 header 찍음

 -> -t : time stamp 프린트(JVM 이 스타트 된 이후의 시간)

 -> 7251 : 프로세스 id

 -> 3000 : interval (ms 단위)

 -> 3000 : count







2. 각각의 항목 설명

- S0 : Survivor 영역 0 의 사용율 (현재의 용량에 대한 퍼센티지)

- S1 : Survivor 영역 1 의 사용율 (현재의 용량에 대한 퍼센티지)

- E : Eden 영역의 사용율 (현재의 용량에 대한 퍼센티지)

- O : Old 영역의 사용율 (현재의 용량에 대한 퍼센티지)

- P : Permanent 영역의 사용율 (현재의 용량에 대한 퍼센티지)

- YGC : Young 세대의 GC 이벤트수

- YGCT : Young 세대의 가베지 콜렉션 시간

- FGC : 풀 GC 이벤트수

- FGCT : 풀 가베지 콜렉션 시간

- GCT : 가베지 콜렉션총시간

 

3. 샘플

>jstat -gcutil 21891 250 7

   S0     S1     E      O      P     YGC    YGCT    FGC    FGCT   GCT

  12.44   0.00  27.20   9.49  96.70    78    0.176     5    0.495    0.672

  12.44   0.00  62.16   9.49  96.70    78    0.176     5    0.495    0.672

  12.44   0.00  83.97   9.49  96.70    78    0.176     5    0.495    0.672

   0.00   7.74   0.00   9.51  96.70 79    0.177     5    0.495    0.673

   0.00   7.74  23.37   9.51  96.70    79    0.177     5    0.495    0.673

   0.00   7.74  43.82   9.51  96.70    79    0.177     5    0.495    0.673

   0.00   7.74  58.11   9.51  96.71    79    0.177     5    0.495    0.673

 

이 예의 출력은, Young 세대의 콜렉션이 3 번째와 4 번째의 샘플간에 행해진 것을 나타내고 있습니다.

콜렉션에는 0.001 초 걸리고 있어 오브젝트가 Eden 영역 (E)으로부터 Old 영역 (O)에 승격했기 때문에,

Old 영역의 사용율은 9.49% 에서 9.51% 에 증가하고 있습니다.

Survivor 영역은, 콜렉션전은 12.44% 가 사용되고 있었습니다만, 콜렉션 후는 7.74% 밖에 사용되고 있지 않습니다.




실시간으로 메모리 사용을 좀 확인해야 하는 상황에서는 위와 같이 jstat 로 간단하게 모니터링을 수행하면

현재의 JVM 메모리 사용 상황을 확인이 가능할 것 같습니다.

 

가장 정확한 건 GC 로그를 별도의 파일로 출력하게 해서 분석하는 것이지만, 이럴 경우에는 실시간으로 확인이 힘들기 때문에

위와 같이 사용하는 것도 괜찮은 방법 중의 하나일 것 같습니다.

물론 JVM 에 계속 request 를 보내기 때문에 부하가 있을 듯 하지만, 지금 생각으로는 크게 영향은 미치지 않을 듯 하네요..

영향이 고려되면 interval을 좀 조정하든지 하면 될 듯 합니다.







<참고>

http://blog.naver.com/PostView.nhn?blogId=solvage&logNo=10038025715



jstat -gcutil -h20 -t 4989 3000 3000












Re:Java Web Service 호출  

다음은 제 책에 있는 Web Service 호출 예제입니다. 각각 minus, plus 메서드를 호출하고 있습니다. 여기에서는 단순하게 하기 위해서 operand를 하나로 제한했습니다.

 

package com.javawide.book.blackbook.ch04;

import java.rmi.RemoteException;

import javax.xml.rpc.ParameterMode;
import javax.xml.rpc.ServiceException;

import org.apache.axis.client.Call;
import org.apache.axis.client.Service;
import org.apache.axis.encoding.XMLType;

public class ServiceClient {
 private String endpoint = "http://localhost:8080/HelloXML/services/GreetService";
 private String method = "add";
 private int operand;
 private Service service;
 private Call call;
 public String getMethod() {
  return method;
 }
 public void setMethod(String method) {
  this.method = method;
 }
 public Service getService() {
  return service;
 }
 public void setService(Service service) {
  this.service = service;
 }
 
 private void createCall() {
  this.service = new Service();
  try {
   this.call = (Call)service.createCall();
  } catch (ServiceException e) {
   e.printStackTrace();
  }
 }
 public void call() {
  createCall();
  call.setTargetEndpointAddress(endpoint);
  call.setOperationName(method);
  call.addParameter("operand", XMLType.XSD_INT, ParameterMode.IN);
  call.setReturnType(XMLType.XSD_INT);
  try {
   System.out.println(call.invoke(new Object[] { operand }));
  } catch (RemoteException e) {
   e.printStackTrace();
  }
 }
 public int getOperand() {
  return operand;
 }
 public void setOperand(int operand) {
  this.operand = operand;
 }
 
 public static void main(String[] args) {
  ServiceClient client = new ServiceClient();
  client.setOperand(100);
  client.setMethod("minus");
  client.call();
  client.setMethod("add");
  client.call();
  
  GreetServiceService serviceProxy = new GreetServiceServiceLocator();
  try {
   GreetService service = serviceProxy.getGreetService();
   System.out.println(service.minus(client.getOperand()));
   System.out.println(service.add(client.getOperand()));
  } catch (ServiceException e) {
   e.printStackTrace();
  } catch (RemoteException e) {
   e.printStackTrace();
  }
 }

}



 
soap client 예제
http://hsouhy.egloos.com/viewer/461247
http://www.mimul.com/pebble/default/2008/09/03/1220448180000.html

soap xml
http://hsouhy.egloos.com/viewer/461247
http://blog.daum.net/tomayoon/7091859
http://littletrue.egloos.com/viewer/4750849
http://yally93.egloos.com/viewer/2990968


2013-12-24

SkyProxy 통신사용페이지


수정페이지

classes

common.sockutil2(완)
	 SocketCommAbs.class
	 SocketCommTable.class
signalconfig(완)	
	SignalConfigAction.class	
(완)(다이얼070) interfaceconfig/InterfaceConfigAction.class

mediaconfig(완)
	MediaConfigAction.class
medialiist(완)
	MediaListAction.class
ntp(완)
	NTPAction.class
iptable(완)
	IPTableAction.class
ipexcepblock(완)
	IPExcepBlickAction.class
user(완)
	UserAction.class
callcenter_user(완)
	CallCenterUserAction.class
dialplan(완)
	DialPlanAction.class
groupadmn(완)
	GroupAdmnAction.class
acdGroup(완)
	ACDGroupActon.class
	ACDGroupMgr.class
trunklst(완)
	TrunkListActon.class
trunk_inbound(완)
	Trunk_InboundActon.class
serverstatus(완)
	ServerStatusAction.class
	ServerStatusMgr.class
saxevent(완)
	ServerStatusEvent.class
serverinfo(완)
	ServerInfoMgr.class
register
	RegisterAction.class




Confinguration
  - Equipment > signal : TYPE=RELOAD, TABLE=T_SIGNAL_CONFIG
<?xml version="1.0" standalone="no"?><PACKET><FUNCTION TYPE="HEARTBEAT" COMMAND="REQUEST"></FUNCTION></PACKET>
<PACKET><FUNCTION TYPE=\"RELOAD\" COMMAND=\"REQUEST\" TABLE=\"T_SIGNAL_CONFIG\"><VALUE><KEY>0</KEY></VALUE></FUNCTION></PACKET>
<?xml version="1.0" standalone="no"?>
<PACKET><FUNCTION TYPE="RELOAD" COMMAND="RESPONSE" TABLE="T_SIGNAL_CONFIG" RESULT="SUCCESS"><MESSAGE>Success</MESSAGE></FUNCTION></PACKET>

  - Equipment > media  : TYPE=CONFIG, TABLE= 
  - Media List  : TYPE=ADD TABLE=T_MEDIA_LIST
    , TYPE=UPDATE TABLE=T_MEDIA_LIST,
    TYPE=DELETE TABLE=T_MEDIA_LIST
  - NTP  : 
	첫 페이지 조회시 TYPE=GETTIME 
	,update 시 <PACKET><FUNCTION TYPE="NTPSTART" COMMAND="REQUEST"><VALUE><SERVERNAME>time.bora.net</SERVERNAME><SERVERNAME>ntp.ewha.net</SERVERNAME></VALUE></FUNCTION></PACKET>
	,삭제시 테이블에(t_ntp) 데이터 삭제후 NTPSTART 요청
	,NTPSTOP 시 <PACKET><FUNCTION TYPE="NTPSTOP" COMMAND="REQUEST"></FUNCTION></PACKET>
	,NTPRESTART 시 NTPSTART 요청
  - Firewall : update, delete 시 : type : SKYFIREWALL TABLE=t_ip_table
  - IP Excep Block : update 시 <PACKET><FUNCTION TYPE="UPDATE" COMMAND="REQUEST" TABLE="T_EXCEPT_BLOCK_LIST"><VALUE><KEY>1</KEY></VALUE></FUNCTION></PACKET>
  , add시 <PACKET><FUNCTION TYPE="ADD" COMMAND="REQUEST" TABLE="T_EXCEPT_BLOCK_LIST"><VALUE><KEY>4</KEY></VALUE></FUNCTION></PACKET>
  , delete 시 <PACKET><FUNCTION TYPE="DELETE" COMMAND="REQUEST" TABLE="T_EXCEPT_BLOCK_LIST"><VALUE><KEY>4</KEY></VALUE></FUNCTION></PACKET>
Policy
  - User : update 시 <PACKET><FUNCTION TYPE="UPDATE" COMMAND="REQUEST" TABLE="T_USER"><VALUE><KEY>246</KEY></VALUE></FUNCTION></PACKET>
   , add : TYPE=ADD
   , delete : TYPE=DELETE
  - Call Center User : update 시 <PACKET><FUNCTION TYPE="UPDATE" COMMAND="REQUEST" TABLE="T_CALLCENTER_USER"><VALUE><KEY>4</KEY></VALUE></FUNCTION></PACKET>
   , add : TYPE=ADD
   , delete : TYPE=DELETE
  - Numberingplan : update 시 <PACKET><FUNCTION TYPE="UPDATE" COMMAND="REQUEST" TABLE="T_NUMBERINGPLAN"><VALUE><KEY>26</KEY></VALUE></FUNCTION></PACKET>
   , add : TYPE=ADD
   , delete : TYPE=DELETE
  - Policy Group > Realm : update 시 <PACKET><FUNCTION TYPE="UPDATE" COMMAND="REQUEST" TABLE="T_REALM"><VALUE><KEY>0</KEY></VALUE></FUNCTION></PACKET>
   , add : TYPE=ADD
   , delete : TYPE=DELETE
  - Policy Group > Policy Group : update 시  <PACKET><FUNCTION TYPE="UPDATE" COMMAND="REQUEST" TABLE="T_POLICY"><VALUE><KEY>0</KEY></VALUE></FUNCTION></PACKET>
   , add : TYPE=ADD
   , delete : TYPE=DELETE
  - ACD Group : acd update시 <PACKET><FUNCTION TYPE="UPDATE" COMMAND="REQUEST" TABLE="T_ACD_GROUP"><VALUE><KEY>0</KEY></VALUE></FUNCTION></PACKET>
   , add : TYPE=ADD
   , delete : TYPE=DELETE

   agent update시 <PACKET><FUNCTION TYPE="UPDATE" COMMAND="REQUEST" TABLE="T_ACD_GROUP"><VALUE><KEY>0</KEY></VALUE></FUNCTION></PACKET>

Trunk
  - Trunk List > Signal : update 시 <PACKET><FUNCTION TYPE="UPDATE" COMMAND="REQUEST" TABLE="T_TRUNK_LIST"><VALUE><KEY>21</KEY></VALUE></FUNCTION></PACKET>
   , add : TYPE=ADD
   , delete : TYPE=DELETE
  - Inbound : update 시 <PACKET><FUNCTION TYPE="UPDATE" COMMAND="REQUEST" TABLE="T_TRUNK_INBOUND_POLICY"><VALUE><KEY>15</KEY></VALUE></FUNCTION></PACKET>
   , add : TYPE=ADD
   , delete : TYPE=DELETE
Monitoring
  - Process : 첫 페이지 조회시 <PACKET><FUNCTION TYPE=\"LIST\" COMMAND=\"REQUEST\"><REPORT>OFF</REPORT></FUNCTION></PACKET>
  , active change : <PACKET><FUNCTION TYPE="HA_CHANGE" COMMAND="REQUEST"></FUNCTION></PACKET>
  , restart : <PACKET><FUNCTION TYPE=\"Restart\" COMMAND=\"REQUEST\"><PROCESS><NAME>skylog</NAME><PID>4088</PID></PROCESS></FUNCTION></PACKET>
  , stop : <PACKET><FUNCTION TYPE=\"Stop\" COMMAND=\"REQUEST\"><PROCESS><NAME>skylog</NAME><PID>30086</PID></PROCESS></FUNCTION></PACKET>
  , start : <PACKET><FUNCTION TYPE=\"Start\" COMMAND=\"REQUEST\"><PROCESS><NAME>skylog</NAME><PID>30086</PID></PROCESS></FUNCTION></PACKET>







http://localhost:8080/CCARetrieveCardPwd.action?strMemId=10002199&strPwd=1111 
> 

http://localhost:8080/CardNumCheck.action?CardNumber=0021100002399478&CardType=10
> 

http://localhost:8080/CCACardInsertCredit.action?strJumin=8801171113714&strNum=0021100007978722&strPwd=1111
> 
http://localhost:8080/CCAChangeCardPwd.action?Jumin=0021100007978722&OldPwd=10&NewPwd=10

http://localhost:8080/CCAMemberCardInsertNoSecu.action?strJumin=0021100007978722&strNum=10&strPwd=10

http://localhost:8080/CCAMEMBERCheck.action?Membercode=MC0GCCqGSIb3DQIJAyEA6cervsqethvpBiSynGzcV2n9wyj5csNRzdhSqmVa39g=

http://localhost:8080/CCAMEMBERCheck.action?Membercode=MC0GCCqGSIb3DQIJAyEA3Q1v9ijdFml6y8qyE/BPBlqhVFbPkmiEOlZ7ji+TfVg=

java url
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
<soap:Body><doServiceResponse xmlns="http://E1WS_CCA.e1.co.kr/"><doServiceResult><?xml version="1.0" encoding="UTF-8"?><?Siebel-Property-Set EscapeNames="true"?>
<PropertySet Result="S" ErrMsg=""></PropertySet></doServiceResult></doServiceResponse></soap:Body></soap:Envelope>


http://localhost:8080/CCAMemberChkReturnInfo.action?strJumin=0021100007978722
> MemSeq - return
http://localhost:8080/CCAMemberCode.action?strJumin=0021100007978722
http://localhost:8080/CCAMemberCode.action?strJumin=12891
> MemCode - return
http://localhost:8080/CCARecInterface.action?strJumin=0021100007978722&strANI=11&strSCD=11&strCNU=11&strCARDNO=11&strCARDPASSWD=11&strInteractionId=11




http://192.168.0.210:38080/SkyE1/CCARecInterface.action?strJumin=0021100007978722&strANI=11&strSCD=11&strCNU=11&strCARDNO=11&strCARDPASSWD=11&strInteractionId=11
http://192.168.0.210:38080/CCAMemberCode.action?strJumin=0021100007978722

http://192.168.0.210:38080/CardNumCheck.action?CardNumber=0021100007978722&CardType=10
http://210.121.190.210:38080/CardNumCheck.action?CardNumber=0021100007978722&CardType=10
http://210.121.190.210:8000/SkyE1/CardNumCheck.action?CardNumber=0021100007978722&CardType=10

http://localhost:8080/CTI_Point_Search_TTS.action?Membercode=10002203
http://localhost:8080/CTIMemberGrade.action?Membercode=12891
http://localhost:8080/CTISMSReject.action?CALL_ID=123456&TEL_NUMBER=01051851589

import java.net.URI;
import org.apache.http.HttpResponse;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.entity.StringEntity;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.impl.client.RequestWrapper;
import org.apache.http.protocol.HTTP;

public class HTTPRequest
{
    @SuppressWarnings("unused")
    public HTTPRequest()
    {
        try {
            HttpClient httpclient = new DefaultHttpClient();
            String body="DataDataData";
            String bodyLength=new Integer(body.length()).toString();
            System.out.println(bodyLength);
//          StringEntity stringEntity=new StringEntity(body);

            URI uri=new URI("SOMEURL?Param1=1234&Param2=abcd");
            HttpPost httpPost = new HttpPost(uri);
            httpPost.addHeader("Test", "Test_Value");

//          httpPost.setEntity(stringEntity);

            StringEntity entity = new StringEntity(body, "text/xml",HTTP.DEFAULT_CONTENT_CHARSET);
            httpPost.setEntity(entity);

            RequestWrapper requestWrapper=new RequestWrapper(httpPost);
            requestWrapper.setMethod("POST");
            requestWrapper.setHeader("LuckyNumber", "77");
            requestWrapper.removeHeaders("Host");
            requestWrapper.setHeader("Host", "GOD_IS_A_DJ");
//          requestWrapper.setHeader("Content-Length",bodyLength);          
            HttpResponse response = httpclient.execute(requestWrapper);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}




import org.apache.http.HttpEntity;
   import org.apache.http.HttpResponse;
   import org.apache.http.client.HttpClient;
   import org.apache.http.client.methods.HttpPost; 
   import org.apache.http.entity.StringEntity;
   import org.apache.http.impl.client.DefaultHttpClient;
   import org.apache.http.util.EntityUtils;

    public void callWebService(String soapaction,String soapenvbody) {
    String body ="<?xml version=\"1.0\" encoding=\"UTF-8\"?><SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:ns1=\"http://example.com/v1.0/Records\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:SOAP-ENC=\"http://schemas.xmlsoap.org/soap/encoding/\" SOAP-ENV:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"><SOAP-ENV:Body>"+soapenvbody+"</SOAP-ENV:Body></SOAP-ENV:Envelope>";


            HttpPost httppost = new HttpPost("http://example.com?soapservice");

            // Request parameters and other properties.
            StringEntity stringentity=new StringEntity(body,"UTF-8");
            stringentity.setChunked(true);
            httppost.setEntity(stringentity);
            httppost.addHeader("Accept" , "text/xml");
            httppost.addHeader("SOAPAction",soapaction);
            
	    //Execute and get the response.
            HttpResponse response = httpclient.execute(httppost);
            HttpEntity entity = response.getEntity();

            String strresponse = null;
            if(entity!=null) {
                strresponse = EntityUtils.toString(entity);
            }
     }



그것을 예방하기 위해서는 톰캣폴더 하위에 있는 bin 폴더 밑에 catalina.sh 최상단에 아래 문구를 추가해주면 된다. 



# /usr/local/tomcat/bin
# vi ./catalina.sh



 

2013-12-30


JAVA_OPTS="-Djava.awt.headless=true -server -Xms512m -Xmx1024m -XX:NewSize=256m -XX:MaxNewSize=256m -XX:PermSize=256m -XX:MaxPermSize=256m -XX:+DisableExplicitGC"

추가적으로메모리 누수 방지를 위해서 /var/lib/tomcat6/conf/web.xml 파일에서 servlet 설정 사이에 다음을 추가하였다. 일단 문제는 해결한 상태에서 추가적으로 설정한 부분이라 이 설정이 유효한지는 잘 모르겠다.

<init-param>  
    <param-name>enablePooling</param-name>  
    <param-value>false</param-value>  
</init-param> 

GC_PATH="/usr/local/tomcat"
JAVA_OPTS="-Djava.awt.headless=true -server -Xms512m -Xmx1024m -XX:NewSize=256m -XX:MaxNewSize=256m -XX:PermSize=256m -XX:MaxPermSize=256m -XX:+DisableExplicitGC"
export JAVA_OPTS="$JAVA_OPTS  -verbosegc -Xloggc:${GC_PATH}/gclog.log -XX:-PrintGC -XX:+PrintGCTimeStamps -XX:+PrintGCDetails  -XX:-TraceClassUnloading -XX:-TraceClassLoading -XX:+PrintHeapAtGC -XX:+HeapDumpOnOutOfMemoryError"

echo "$JAVA_OPTS"

CATALINA_OPTS="$CATALINA_OPTS $JPDA_OPTS" -server -XX:PermSize=256m -XX:MaxPermSize=768m -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+PrintHeapAtGC -XX:+UseParallelGC
HeapDumpOnOutOfMemoryError : 




CATALINA_OPTS="-server -Xverify:none -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+PrintHeapAtGC 
-Xms1536m -Xmx1536m 
-XX:PermSize=256m -XX:MaxPermSize=256m -XX:NewSize=800m -XX:MaxNewSize=800m -XX:SurvivorRatio=4 -Xloggc:/tmp/gc.log"

-XX:+UseParallelGC
-XX:+UseConcMarkSweepGC => 옵션 없음

-XX:NewSize=500m -XX:MaxNewSize=500m -XX:MaxPermSize=128m -XX:SurvivorRatio=5

jvm option
-Xms=<size> : java Heap 의 최초크기(start size)를 지정. java heap는 
	-Xms=<size> 옵션으로 지정한 크기로 시작 , 최대 -Xmx 옵션으로 지정한 크기만큼 커진다. Sun Hotspt jvm 
	계열에서는 최초와 최고 크기를 동일하게 부여를 권장
-xx:PermSize=<size>,-xx:MaxPermSize=<size> : PermanentGeneration 의 최초 크기를 지정한다 PermanentGeneration 의 최대크기는 옵션에 의해 지정
					많은 수의 class 롤 로딩하는 어플은 큰그기의 PermanentGeneration 필요로 하며 PermanentGeneration 작아서 class 로딩못하면 
					아웃오브메모리 발생
-xx:NewSize=<value> : youngGeneration 시작크기를 지정
-xx:MaxNewSize=<value> : youngGeneration 마지막 크기를 지정


http://darkmirr.egloos.com/1363147
http://wiki.ex-em.com/index.php/JVM_Options


GC_PATH="/usr/local/tomcat/logs"
NOW=`date +"%m%d"`
JAVA_OPTS="-Djava.awt.headless=true -server -Xms512m -Xmx1024m -XX:NewSize=256m -XX:MaxNewSize=256m -XX:PermSize=256m -XX:MaxPermSize=256m -XX:+DisableExplicitGC"
export JAVA_OPTS="$JAVA_OPTS  -verbosegc -Xloggc:${GC_PATH}/gclog.log-${NOW} -XX:-PrintGC -XX:+PrintGCTimeStamps -XX:+PrintGCDetails  -XX:-TraceClassUnloading -XX:-TraceClassLoading -XX:+PrintHeapAtGC -XX:+HeapDumpOnOutOfMemoryError"




java.sql.SQLException: java.lang.OutOfMemoryError: Java heap space
: java heap 이나 힙의 특정 영역의 객체를 할당 할 수 있는 공간이 충분하지 않을때 발생

thread
http://javaservice.net/~java/bbs/read.cgi?m=appserver&b=engine&c=r_p_p&n=1135142439
heap 메모리 설명
http://blog.naver.com/PostView.nhn?blogId=sjpotato&logNo=40121751647

뭐… 예전엔 신경도 쓰지 않고 있었던 부분이지만…

최근에 들어서 계발과 관련하여 쓰레드(thread) 에 관련된 커널 파라미터를 찾게 되었다.

/proc/sys/kernel/threads-max 또는 kernel.threads-max  에 해당 된다. 

예로 들면 현재 max thread 값은

[root@xen ]# cat /proc/sys/kernel/threads-max
204799

위 처럼 되어 있으며

이는 사용자 또 특정 프로세스에 한정된게 아닌 해당 시스템 전체의 max 값 으로 

1 thread = 1 stack size 에 해당 된다. 

해당 stack size 의 확인은 아래의 커맨드로 확인 가능하며 

[root@wds1 ~]# ulimit -a
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 102399
max locked memory       (kbytes, -l) 32
max memory size         (kbytes, -m) unlimited
open files                      (-n) 1024
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) 10240
cpu time               (seconds, -t) unlimited
max user processes              (-u) 102399
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited
[root@wds1 ~]#

시스템 전체의 max thread 값이 높다고 하여도 메모리의 한계로(out of memory) 더이상 thread 생성이 어려울 수 있다. 

참고 URL : http://stackoverflow.com/questions/344203/maximum-number-of-threads-per-process-in-linux
참고 URL : http://kldp.org/node/106266

해당 시스템의 최대로 생성 가능한 스레드 를 확인 하기 위해서 사용하는 소스코드다.

Test Code Site : http://akomaenablog.blogspot.com/2008/03/c-thread-example.html

tomcat thread 설정
http://junp.tistory.com/224

heap 메모리 영역 구조
http://blog.naver.com/PostView.nhn?blogId=miniwikibook&logNo=60181484855


jmeter 

http://darkit.egloos.com/viewer/206273


#CATALINA_OPTS="$CATALINA_OPTS -Dcom.sun.management.jmxremote"
     90 #CATALINA_OPTS="$CATALINA_OPTS -Dcom.sun.management.jmxremote.port=8889"
     91 #CATALINA_OPTS="$CATALINA_OPTS -Dcom.sun.management.jmxremote.ssl=false"
     92 #CATALINA_OPTS="$CATALINA_OPTS -Dcom.sun.management.jmxremote.authenticate=false"
     93 #CATALINA_OPTS="$CATALINA_OPTS -Djava.rmi.server.hostname=192.168.0.214"
     94 #CATALINA_OPTS="$CATALINA_OPTS -XX:HeapDumpPath=/home/weblog/tomcat2/dump.dmp"
     95 #CATALINA_OPTS="$CATALINA_OPTS -XX:+HeapDumpOnOutOfMemoryError"





| /usr/local/sbin/cronolog /home/weblog/tomcat/catalina.out.%Y%m%d &

java util svn http://mypojo.googlecode.com/svn/trunk/
java util
http://code.google.com/p/mypojo/source/browse/javaUtil/?r=98#javaUtil%2F2.0%2Futil%2Ferwins%2Futil%2Flib

/*
	 * NOTE: 위 메소드는 넘어오는 모든 데이타를 ByteArrayInputStream에 임시로 담아둔 후
		이를 다시 응용어플리케이션에 넘겨주는 구조이기 때문에, 대량데이타를 전송하고자
		할 때는 사용하시면 안됩니다. 위 예제에서 언급하고자 했던 것은 단지 여러번에 나뉘어
		날아올 수 있으므로, 필요한 데이타가 모두 올 때까지 끝까지 받으라는 것을 강조하고자
		했으며, 하나의 샘플을 제공한 것에 지나지 않습니다.
		예를 들어 1MB의 데이타를 위와 같은 메소드를 이용해 동시에 같이 여러 Thread가 
		받는다고 가정하면, 메모리가 남아 나지 않겠지요.
		
		NOTE: 또한, 위 메소드는 방화벽을 사이에 두고 통신할 경우, 경우에 따라 영원히
		blocking 될 가능성이 있습니다. while loop 내에서 retry 할 횟수의 제한을 두는 것도
		한가지 방법일 듯 합니다.

*/
	
	/* InputStream으로 부터 EOF를 만날 때까지 모든 데이타를 읽어들임 */
	  private static byte[] read_data(InputStream in) throws Exception {
	    java.io.ByteArrayOutputStream bout = new java.io.ByteArrayOutputStream();
	    int bcount = 0;
	    byte[] buf = new byte[2048];
	    while( true ) {
	      int n = in.read(buf);
	      if (n == -1) break;
	      //System.out.println(n);
	      bcount += n;
	      bout.write(buf,0,n);
	    }
	    bout.flush();
	    //return bout.toString();
	    return bout.toByteArray();
	  }
	  /* 주어진 길이만큼만 읽어들임 */
	  private static byte[] read_data(InputStream in, int len) throws Exception {
	    java.io.ByteArrayOutputStream bout = new java.io.ByteArrayOutputStream();
	    int bcount = 0;
	    byte[] buf = new byte[2048];
	    while( bcount < len ) {
	      int n = in.read(buf,0, len-bcount < 2048 ? len-bcount : 2048 );
	      if (n == -1) break;
	      //System.out.println(n);
	      bcount += n;
	      bout.write(buf,0,n);
	    }
	    bout.flush();
	    //return bout.toString();
	    return bout.toByteArray();
	  }


/**
 * @(#) SocketUtil.java
 * Copyright 1999-2002 by  Java Service Network Community, KOREA.
 * All rights reserved.  http://www.javaservice.net
 * 
 * NOTICE !      You can copy or redistribute this code freely, 
 * but you should not remove the information about the copyright notice 
 * and the author.
 * 
 * @author  WonYoung Lee, javaservice@hanmail.net
 */
import java.io.IOException;
import java.io.ByteArrayOutputStream;
public class SocketUtil {

    public static final int INTPUTSTREAM_READ_RETRY_COUNT = 10;

    private SocketUtil() {}


    /** 
     * The <code>read_data</code> method of <code>SocketUtil</code> reads the
     * specified length of bytes from the given input stream.
     *
     * @param      in   an inputstream
     * @param      len  the number of bytes read.
     * @return     The specified number of bytes read until the end of
     *             the stream is reached.
     * @exception  IOException  if an I/O error or unexpected EOF occurs
     */
    private static final byte[] read_data(InputStream in, int len) throws IOException {
        ByteArrayOutputStream bout = new ByteArrayOutputStream();
        int bcount = 0;
        byte[] buf = new byte[2048];
        int read_retry_count = 0;
        while( bcount < len ) {
            int n = in.read(buf,0, len-bcount < 2048 ? len-bcount : 2048 );
            if ( n > 0 ) { bcount += n; bout.write(buf,0,n); }
            // What would like to do if you've got an unexpected EOF before
            // reading all data ?
            //else if (n == -1) break;
            else if ( n == -1 ) throw 
                 new IOException("inputstream has returned an unexpected EOF");
            else  { // n == 0
                if (++read_retry_count >= INTPUTSTREAM_READ_RETRY_COUNT)
                    throw new IOException("inputstream-read-retry-count( " +
                        INTPUTSTREAM_READ_RETRY_COUNT + ") exceed !");
            }
        }
        bout.flush();
        return bout.toByteArray();
    }

    /** 
     * The <code>read_data</code> method of <code>SocketUtil</code> reads all
     * the bytes from the given inputstream until the given input stream 
     * has not returned an EOF(end-of-stream) indicator.
     *
     * @param      in   an inputstream
     * @return     all bytes read if the end of the stream is reached.
     * @exception  IOException  if an I/O error occurs
     */
    private static final byte[] read_data(InputStream in) throws IOException {
        ByteArrayOutputStream bout = new ByteArrayOutputStream();
        int bcount = 0;
        byte[] buf = new byte[2048];
        int read_retry_count = 0;
        while( true ) {
            int n = in.read(buf);
            if ( n > 0 ) { bcount += n; bout.write(buf,0,n); }
            else if (n == -1) break;
            else  { // n == 0
                if (++read_retry_count >= INTPUTSTREAM_READ_RETRY_COUNT)
                    throw new IOException("inputstream-read-retry-count( " +
                        INTPUTSTREAM_READ_RETRY_COUNT + ") exceed !");
            }
        }
        bout.flush();
        return bout.toByteArray();
    }
  
    /**
     * Read a line of text.  A line is considered to be terminated by a line
     * feed ('\n') or a carriage return followed immediately by a linefeed.
     *
     * @return     A String containing the contents of the line, not including
     *             any line-termination characters, or null if the end of the
     *             stream has been reached
     *
     * @exception  IOException  If an I/O error occurs
     */
    private static final String read_line(InputStream in) throws IOException {
        ByteArrayOutputStream bout = new ByteArrayOutputStream();
        boolean eof = false;
        while( true ) {
            int b = in.read();
            if (b == -1) { eof = true; break;}
            if ( b != '\r' && b != '\n' ) bout.write((byte)b);
            if (b == '\n') break;
        }
        bout.flush();
        if ( eof && bout.size() == 0 ) return null; 
        //Or return ""; ? what's fit for you?
        return bout.toString();
    }        
}






package erwins.util.lib;
 

 
/**
 
 * 임시 저장 유틸 
 
 * 어디선가 불펌. 영원히 쓸일 없을듯. 
 
 */
 
public class ByteUtil {
 

 
    //public static Byte DEFAULT_BYTE = new Byte((byte) 0);
 

 
    /**
 
     * <p>문자열을 바이트로 변환한다.</p>
 
     * 
 
     * <pre> ByteUtils.toByte("1", *) = 0x01 ByteUtils.toByte("-1", *) = 0xff
 
     * ByteUtils.toByte("a", 0x00) = 0x00 </pre>
 
     * 
 
     * @param value
 
     *            10진수 문자열 값
 
     * @param defaultValue
 
     * @return
 
     */
 
    public static byte toByte(String value, byte defaultValue) {
 
        try {
 
            return Byte.parseByte(value);
 
        }
 
        catch (Exception e) {
 
            return defaultValue;
 
        }
 
    }
 

 
    /**
 
     * <p>문자열을 바이트로 변환한다.</p>
 
     * 
 
     * <pre> ByteUtils.toByteObject("1", *) = 0x01 ByteUtils.toByteObject("-1",
 
     * *) = 0xff ByteUtils.toByteObject("a", 0x00) = 0x00 </pre>
 
     * 
 
     * @param value
 
     *            10진수 문자열 값
 
     * @param defaultValue
 
     * @return
 
     */
 
    public static Byte toByteObject(String value, Byte defaultValue) {
 
        try {
 
            return new Byte(value);
 
        }
 
        catch (Exception e) {
 
            return defaultValue;
 
        }
 
    }
 

 
    /**
 
     * <p>singed byte를 unsinged byte로 변환한다.</p> <p>Java에는 unsinged 타입이 없기때문에,
 
     * int로 반환한다.(b & 0xff)</p>
 
     * 
 
     * @param b
 
     *            singed byte
 
     * @return unsinged byte
 
     */
 
    public static int unsignedByte(byte b) {
 
        return b & 0xFF;
 
    }
 

 
    /**
 
     * <p>입력한 바이트 배열(4바이트)을 int 형으로 변환한다.</p>
 
     * 
 
     * @param src
 
     * @param srcPos
 
     * @return
 
     */
 
    public static int toInt(byte[] src, int srcPos) {
 
        int dword = 0;
 
        for (int i = 0; i < 4; i++) {
 
            dword = (dword << 8) + (src[i + srcPos] & 0xFF);
 
        }
 
        return dword;
 
    }
 

 
    /**
 
     * <p>입력한 바이트 배열(4바이트)을 int 형으로 변환한다.</p>
 
     * 
 
     * @param src
 
     * @return
 
     */
 
    public static int toInt(byte[] src) {
 
        return toInt(src, 0);
 
    }
 

 
    /**
 
     * <p>입력한 바이트 배열(8바이트)을 long 형으로 변환한다.</p>
 
     * 
 
     * @param src
 
     * @param srcPos
 
     * @return
 
     */
 
    public static long toLong(byte[] src, int srcPos) {
 
        long qword = 0;
 
        for (int i = 0; i < 8; i++) {
 
            qword = (qword << 8) + (src[i + srcPos] & 0xFF);
 
        }
 
        return qword;
 
    }
 

 
    /**
 
     * <p>입력한 바이트 배열(8바이트)을 long 형으로 변환한다.</p>
 
     * 
 
     * @param src
 
     * @return
 
     */
 
    public static long toLong(byte[] src) {
 
        return toLong(src, 0);
 
    }
 

 
    /**
 
     * <p>int 형의 값을 바이트 배열(4바이트)로 변환한다.</p>
 
     * 
 
     * @param value
 
     * @param dest
 
     * @param destPos
 
     */
 
    public static void toBytes(int value, byte[] dest, int destPos) {
 
        for (int i = 0; i < 4; i++) {
 
            dest[i + destPos] = (byte) (value >> ((7 - i) * 8));
 
        }
 
    }
 

 
    /**
 
     * <p>int 형의 값을 바이트 배열(4바이트)로 변환한다.</p>
 
     * 
 
     * @param value
 
     * @return
 
     */
 
    public static byte[] toBytes(int value) {
 
        byte[] dest = new byte[4];
 
        toBytes(value, dest, 0);
 
        return dest;
 
    }
 

 
    /**
 
     * <p>long 형의 값을 바이트 배열(8바이트)로 변환한다.</p>
 
     * 
 
     * @param value
 
     * @param dest
 
     * @param destPos
 
     */
 
    public static void toBytes(long value, byte[] dest, int destPos) {
 
        for (int i = 0; i < 8; i++) {
 
            dest[i + destPos] = (byte) (value >> ((7 - i) * 8));
 
        }
 
    }
 

 
    /**
 
     * <p>long 형의 값을 바이트 배열(8바이트)로 변환한다.</p>
 
     * 
 
     * @param value
 
     * @return
 
     */
 
    public static byte[] toBytes(long value) {
 
        byte[] dest = new byte[8];
 
        toBytes(value, dest, 0);
 
        return dest;
 
    }
 

 
    /**
 
     * <p>8, 10, 16진수 문자열을 바이트 배열로 변환한다.</p> <p>8, 10진수인 경우는 문자열의 3자리가, 16진수인
 
     * 경우는 2자리가, 하나의 byte로 바뀐다.</p>
 
     * 
 
     * <pre> ByteUtils.toBytes(null) = null ByteUtils.toBytes("0E1F4E", 16) =
 
     * [0x0e, 0xf4, 0x4e] ByteUtils.toBytes("48414e", 16) = [0x48, 0x41, 0x4e]
 
     * </pre>
 
     * 
 
     * @param digits
 
     *            문자열
 
     * @param radix
 
     *            진수(8, 10, 16만 가능)
 
     * @return
 
     * @throws NumberFormatException
 
     */
 
    public static byte[] toBytes(String digits, int radix) throws IllegalArgumentException, NumberFormatException {
 
        if (digits == null) { return null; }
 
        if (radix != 16 && radix != 10 && radix != 8) { throw new IllegalArgumentException("For input radix: \"" + radix + "\""); }
 
        int divLen = (radix == 16) ? 2 : 3;
 
        int length = digits.length();
 
        if (length % divLen == 1) { throw new IllegalArgumentException("For input string: \"" + digits + "\""); }
 
        length = length / divLen;
 
        byte[] bytes = new byte[length];
 
        for (int i = 0; i < length; i++) {
 
            int index = i * divLen;
 
            bytes[i] = (byte) (Short.parseShort(digits.substring(index, index + divLen), radix));
 
        }
 
        return bytes;
 
    }
 

 
    /**
 
     * <p>16진수 문자열을 바이트 배열로 변환한다.</p> <p>문자열의 2자리가 하나의 byte로 바뀐다.</p>
 
     * 
 
     * <pre> ByteUtils.hexStringToBytes(null) = null
 
     * ByteUtils.hexStringToBytes("0E1F4E") = [0x0e, 0xf4, 0x4e]
 
     * ByteUtils.hexStringToBytes("48414e") = [0x48, 0x41, 0x4e] </pre>
 
     * 
 
     * @param digits
 
     *            16진수 문자열
 
     * @return
 
     * @throws NumberFormatException
 
     * @see HexUtils.toBytes(String)
 
     */
 
    public static byte[] hexStringToBytes(String digits) throws IllegalArgumentException, NumberFormatException {
 
        if (digits == null) { return null; }
 
        int length = digits.length();
 
        if (length % 2 == 1) { throw new IllegalArgumentException("For input string: \"" + digits + "\""); }
 
        length = length / 2;
 
        byte[] bytes = new byte[length];
 
        for (int i = 0; i < length; i++) {
 
            int index = i * 2;
 
            bytes[i] = (byte) (Short.parseShort(digits.substring(index, index + 2), 16));
 
        }
 
        return bytes;
 
    }
 

 
    /**
 
     * <p>unsigned byte(바이트)를 16진수 문자열로 바꾼다.</p>
 
     * 
 
     * ByteUtils.toHexString((byte)1) = "01" ByteUtils.toHexString((byte)255) =
 
     * "ff"
 
     * 
 
     * @param b
 
     *            unsigned byte
 
     * @return
 
     * @see HexUtils.toString(byte)
 
     */
 
    public static String toHexString(byte b) {
 
        StringBuffer result = new StringBuffer(3);
 
        result.append(Integer.toString((b & 0xF0) >> 4, 16));
 
        result.append(Integer.toString(b & 0x0F, 16));
 
        return result.toString();
 
    }
 

 
    /**
 
     * <p>unsigned byte(바이트) 배열을 16진수 문자열로 바꾼다.</p>
 
     * 
 
     * <pre> ByteUtils.toHexString(null) = null ByteUtils.toHexString([(byte)1,
 
     * (byte)255]) = "01ff" </pre>
 
     * 
 
     * @param bytes
 
     *            unsigned byte's array
 
     * @return
 
     * @see HexUtils.toString(byte[])
 
     */
 
    public static String toHexString(byte[] bytes) {
 
        if (bytes == null) { return null; }
 

 
        StringBuffer result = new StringBuffer();
 
        for (byte b : bytes) {
 
            result.append(Integer.toString((b & 0xF0) >> 4, 16));
 
            result.append(Integer.toString(b & 0x0F, 16));
 
        }
 
        return result.toString();
 
    }
 

 
    /**
 
     * <p>두 배열의 값이 동일한지 비교한다.</p>
 
     * 
 
     * <pre> ArrayUtils.equals(null, null) = true ArrayUtils.equals(["one",
 
     * "two"], ["one", "two"]) = true ArrayUtils.equals(["one", "two"],
 
     * ["three", "four"]) = false </pre>
 
     * 
 
     * @param array1
 
     * @param array2
 
     * @return 동일하면 <code>true</code>, 아니면 <code>false</code>
 
     */
 
    public static boolean equals(byte[] array1, byte[] array2) {
 
        if (array1 == array2) { return true; }
 

 
        if (array1 == null || array2 == null) { return false; }
 

 
        if (array1.length != array2.length) { return false; }
 

 
        for (int i = 0; i < array1.length; i++) {
 
            if (array1[i] != array2[i]) { return false; }
 
        }
 

 
        return true;
 
    }
 
} 


<init-param>
	<param-name>enablePooling</param-name>
	<param-value>false</param-value>
</init-param>

CustomLog 
"|/usr/local/sbin/cronolog /home/weblog/apache/%Y%m/access_log.%Y%m%d"
combined


select * from table where binary(name) like '%Bc%' 
이렇게 하면 대소문자를 구분하여 검색이 안되고, 

select * from table where binary(name) like '%bc%' 
이렇게 해야만 검색이 되더라구요. 


Ip:192.168.254.110 ->130
Pass:p@ssw0rd



보고서
 내선별 - 







mount -t nfs 192.168.0.173:/usr/local/skycom/var/record/SpxFiles /usr/local/nfs_mount_list/mount/record_mount
mount -t nfs 192.168.0.167:/usr/local/skycom/bin/ment /usr/local/nfs_mount_list/mount/rbt_mount
mount -t nfs 192.168.0.167:/usr/local/skycom/bin/step_ment /usr/local/nfs_mount_list/mount/ivr_ext_mount
mount -t nfs 192.168.0.167:/usr/local/skycom/bin/ment /usr/local/nfs_mount_list/mount/ivr_ment_mount
mount -t nfs 192.168.0.167:/usr/local/skycom/var/ivr/ment/common /usr/local/nfs_mount_list/mount/rbt_mount












 SELECT LINENO,                                                                                    
    SUBSTRING(START_TIME FROM 1 FOR 4) || '-' ||                                                   
    SUBSTRING(START_TIME FROM 6 FOR 2) || '-' ||                                                 
    SUBSTRING(START_TIME FROM 9 FOR 2)AS CALLDATE,                                                 
    COUNT (*) AS TOTAL_CALL,                                                                       
    (SUM(DATEDIFF(SECOND, START_TIME, CONN_TIME)) / COUNT(*) ) AS AVG_WAIT_TIME,
    (SUM(DATEDIFF(SECOND, CONN_TIME, DISCONN_TIME)) / COUNT(*) ) AS AVG_CALL_TIME
 FROM (SELECT
        CASE WHEN CALLER_TYPE = 'T' AND CALLED_TYPE = 'E' THEN 'I'                           
            WHEN CALLER_TYPE = 'T' AND CALLED_TYPE = 'T' AND CALLED_NO = '8903399' THEN 'I' --체크  <<--  D:\Program_Test\SkyBill_2.0\CallerIPData.Dat [ip]ㅗ 가있으면 이부분을 넣음
            WHEN CALLER_TYPE = 'T' AND CALLED_TYPE = 'T' THEN 'T'                            
            WHEN CALLER_TYPE = 'E' AND CALLED_TYPE = 'E' THEN 'S'                            
            ELSE 'O'                                                                             
        END CALL_TYPE,                                                                             
        CASE WHEN CALLER_TYPE = 'T' AND CALLED_TYPE = 'E' THEN CALLED_NO                       
            WHEN CALLER_TYPE = 'T' AND CALLED_TYPE = 'T' THEN CALLED_NO                        
            ELSE CALLER_ORGNO                                                                      
        END AS LINENO,                                                                             
        CASE WHEN CALLER_TYPE = 'T' AND CALLED_TYPE = 'E' THEN CALLER_ORGNO                    
            WHEN CALLER_TYPE = 'T' AND CALLED_TYPE = 'T' THEN CALLER_ORGNO                     
            ELSE CALLED_NO                                                                         
        END AS DIALNO,                                                                             
        CAST(SUBSTRING (START_TIME FROM 1 FOR 4) || '-' ||                                       
            SUBSTRING (START_TIME FROM 5 FOR 2) || '-' ||                                        
            SUBSTRING (START_TIME FROM 7 FOR 2) || ' ' ||                                        
            SUBSTRING (START_TIME FROM 9 FOR 2) || ':' ||                                        
            SUBSTRING (START_TIME FROM 11 FOR 2) || ':' ||                                       
            SUBSTRING (START_TIME FROM 13 FOR 2) || '.' ||                                       
            SUBSTRING (START_TIME FROM 15 FOR 3) AS TIMESTAMP) AS START_TIME,                      
        CAST(SUBSTRING (CONN_TIME FROM 1 FOR 4) || '-' ||                                        
            SUBSTRING (CONN_TIME FROM 5 FOR 2) || '-' ||                                         
            SUBSTRING (CONN_TIME FROM 7 FOR 2) || ' ' ||                                         
            SUBSTRING (CONN_TIME FROM 9 FOR 2) || ':' ||                                         
            SUBSTRING (CONN_TIME FROM 11 FOR 2) || ':' ||                                        
            SUBSTRING (CONN_TIME FROM 13 FOR 2) || '.' ||                                        
            SUBSTRING (CONN_TIME FROM 15 FOR 3) AS TIMESTAMP) AS CONN_TIME,                        
        CAST(SUBSTRING (DISCONN_TIME FROM 1 FOR 4) || '-' ||                                     
            SUBSTRING (DISCONN_TIME FROM 5 FOR 2) || '-' ||                                      
            SUBSTRING (DISCONN_TIME FROM 7 FOR 2) || ' ' ||                                      
            SUBSTRING (DISCONN_TIME FROM 9 FOR 2) || ':' ||                                      
            SUBSTRING (DISCONN_TIME FROM 11 FOR 2) || ':' ||                                     
            SUBSTRING (DISCONN_TIME FROM 13 FOR 2) || '.' ||                                     
            SUBSTRING (DISCONN_TIME FROM 15 FOR 3) AS TIMESTAMP) AS DISCONN_TIME,                  
        REASON_CODE                                                                                
        FROM T_CALL_HISTORY                                                                        
        WHERE DIRECTION = 'O') B                                                                 
--  where call_type = 'I' 착신    WHERE CALL_TYPE <> 'S'  AND CALL_TYPE <> 'I'  삭제                                                                          
 WHERE CALL_TYPE <> 'S'                                                                          
 AND CALL_TYPE <> 'I'                                                                            
 AND REASON_CODE = '0'                                                                           
 GROUP BY LINENO, CALLDATE                                                                         
 ORDER BY LINENO, CALLDATE 

                                                                        


jqplot
http://www.nextree.co.kr/jqplot/



SELECT e164      FROM t_user    WHERE policy_group=?    AND enable_record != ?    AND use_yn = 1   


Long limit_size = Long.parseLong(getText("path.limit_size"));
				
				long mb_size = limit_size*1024*1024;
				
				if(upload[0].length()>mb_size){
					returnMessage = "Too long size (Limit size is "+getText("path.limit_size")+"MB)";
				}


>
>양xxx 글쓴날: 2001년 11월 16일 10:23:25 금(오전)
>
>Timeout: The number of seconds before receives and sends time out.
>
>Timeout 300
>
>
>아파치 설정시에 위의 문장처럼 Timeout 이란 옵션이 있는데..
>이것이 의미하는 것은 클라이언트가 서버의 임의의 페이지를 열때 그 페
>이지가 5분동안에 다 열리지 않는다면 종료하라는 의미인가요 ?
>혹은 HTTP(특정웹문서의 링크)를 통해서 특정파일을 다운받을 때 다운로
>드 시간이 경과되었다는 메세지는 Timeout 이란 옵션과 관계가 있는 건
>가요.. ?
>만약 Timeout과 관계가 없다면 어떠한 것과 관계가 있는 건가요.. ?
>질문내용이 좀...
>-----------Happy Good Linguxing -----------------------

## 2001.11.16
## "산이" <san2(at)linuxchannel.net>

조금 비중(?)있는 내용인 관계로 FAQ로 작성해 봅니다.

[아파치] Timeout의 시간이란?

아파치 제공문서(설정파일 포함)에 의하면,

Timeout 300

-The number of seconds before receives and sends time out.
-The TimeOut directive currently defines the amount of time Apache will wait for three things:
   1.The total amount of time it takes to receive a GET request.
   2.The amount of time between receipt of TCP packets on a POST or PUT request.
   3.The amount of time between ACKs on transmissions of TCP packets in responses.

인데 번역(?)하자면,

- 받고/보내는 time out의 초단위 시간
- 아파치가 다음의 3가지 사항을 기다리는 시간으로 정의됨
  1. (아파치가 클라이언트로 부터) GET 요청(GET 방식의 URL요청)을 받는데 걸리는 시간. - (요청)
  2. (아파치가 클라이언트로 부터) POST나 PUT 방식의 요청에 대한 TCP 패킷을 받는데 걸리는 시간. - (요청)
  3. (아파치가 클라이언트에게) TCP 패킷을 전송할때 ACKs 세그먼트를 보내는데 걸리는 시간 - (응답)

위의 내용을 쉽게 이해할것 같지만,
TCP/IP 네트워크에서 "TCP 3 way handshaking"라는 TCP의 제어기능을 이해해야만
Timeout의 개념을 알 수 있습니다.

질문의 내용은 3번의 응답에 관한 내용인데, 파일을 다운로드할때는 3번의 응답 과정이 모두 끝나고
실제로 Data 패킷을 전송하는 단계이므로 Timeout과 관계가 없습니다.
그렇게 때문에 아주 덩치 큰 파일(100M 이상)을 HTTP 프로토콜을 이용해서 다운로드할때
5분 이상이 걸려도 Time out이 되지 않는 이유가 여기에 있습니다.

질문에 대한 결론은
Timeout 지시자는 실제로 파일을 다운로드하는 Data 패킷 전송과 관계가 없으며,
앞에서 설명한 1,2번의 요청에 걸리는 시간과 3번의 응답에 걸리는 시간과 관계가 있습니다.

1, 2번의 요청에 관한 내용은 따로 설명하지 않아도 이해할 수 있는 부분이므로 생략하고,
좀더 개념적으로 확실히(?) 알기 위해서 "TCP 3 way handshaking"이라는 녀석에 대해서
조금 알아보죠..

예를들어,
TCP/IP 네트워크에서는 A호스트에서 B호스트로 접속하여 Data 패킷을 전송할때
단 한번의 접속으로 Data 패킷을 보내는 것이 아니라 모두 3번에 걸쳐서 이루어집니다.

1단계 : A ----- 접속시도(SYN, SYNchronize sequene number 보냄) -----> B
2단계 : A <---- 확인단계(SYN, ACK(ACKnowledgment 보냄) ----------- B
3단계 : A ----- 전송시작(ACK, Data 전송시작) --------------------> B

이와 같이 TCP 네트워크는 패킷을 순서대로 맞게 전달하기 위해서
이런 제어기능을 하게됩니다.

3번에 걸쳐서 마치 악수하듯이 이루어진다해서 "3 way handshaking"이라는 말이
나온것 같군요.

헷갈리지 않아야할 점은 앞에서 Data 전송이라고해서 요청에 대한 응답에 만 해당되는것이
요청도 이와 같이 3단계를 걸쳐서 이루어 집니다.

좀더 정확하고 많은 정보를 원한다면 TCP/IP 네트워크에 대한 전문서적을 읽어보시길
바랍니다(필자는 이정도 수준이라서...^.9).

질문의 내용과 연결해서,
1, 2번의 요청, 즉 "xxx 받는데 걸리는 시간"은 위의 3단계 모두에 해당되는 시간이고,
3번의 응답, 즉 "xxx ACKs 세그먼트를 보내는데 걸리는 시간"은 2단계에 해당되는
시간을 의미합니다.

따라서
이미 질문에 대한 답이 나와 있듯이 "파일을 다운로드하는 경우"는 이미 2단계가 모두
끝나고 3단계를 의미하므로 아파치의 Timeout 과 관련이 없습니다.

Timeout 300

의 의미는

- URL GET 요청이나 POST, PUT 요청을 할때 네트워크 환경이 지나치게 너무
  느린 환경(아주 멀리 떨어져 있는 아주 느린 환경)에서 접속을 할때 걸리는 시간이
  300초가 넘어가면 Timeout이 됩니다.
- 또한 다운로드가 아닌 ACKs 세그먼트 메시지를 보낼때도 마찬가지로 너무 느린 환경이나
  네트워크 장애로 인해서 시간이 300초를 초과할 경우에 Timeout이 됩니다.

간혹 멀리 떨어진 외국의 싸이트를 접속하다보면 갑작스런 네트워크 장애로
Timeout 이라는 Error 메시지를 본 경험이 있는데 이와 같은 이유로 Timeout이
되기도 합니다.

이와 관련된 HTTP 1.1 status codes(RFC 2068)

"408"   ; Request Time-out
"413"   ; Request Entity Too Large
"414"   ; Request-URI Too Large
"502"   ; Bad Gateway
"504"   ; Gateway Time-out

408 Request Timeout

   The client did not produce a request within the time that the server
   was prepared to wait. The client MAY repeat the request without
   modifications at any later time.

413 Request Entity Too Large

   The server is refusing to process a request because the request
   entity is larger than the server is willing or able to process. The
   server may close the connection to prevent the client from continuing
   the request.

   If the condition is temporary, the server SHOULD include a Retry-
   After header field to indicate that it is temporary and after what
   time the client may try again.

414 Request-URI Too Long

   The server is refusing to service the request because the Request-URI
   is longer than the server is willing to interpret. This rare
   condition is only likely to occur when a client has improperly
   converted a POST request to a GET request with long query
   information, when the client has descended into a URL "black hole" of
   redirection (e.g., a redirected URL prefix that points to a suffix of
   itself), or when the server is under attack by a client attempting to
   exploit security holes present in some servers using fixed-length
   buffers for reading or manipulating the Request-URI.

502 Bad Gateway

   The server, while acting as a gateway or proxy, received an invalid
   response from the upstream server it accessed in attempting to
   fulfill the request.

504 Gateway Timeout

   The server, while acting as a gateway or proxy, did not receive a
   timely response from the upstream server it accessed in attempting to
   complete the request.

--END------------------



2014-02-03T13:38:10.
2014:13:55:07



eb Send Message call-id[FJl-pGHzTH1dc4], Msg[POST //GetIvrCheck.action HTTP/1.1\r\nHost: 211.38.95.168:80\r\nContent-Type: application/x-w
ww-form-urlencoded\r\nContent-Length: 124\r\n\r\ntype=01&work_type=01&forward_type=1&from_server=4&e164=07076663865&fno=01093583438&hashdata=4b24bd5fb54d4473d75491c3275ab6ab]"
"2014-02-03T12:15:30.513882":13555652:OS:INFO:ivr.localdomain:pid-29302:02622B90:SKYALARM_CALL00:"Web Recv Message call-id[FJl-pGHzTH1dc4], Msg[HTTP/1.1 200 OK\r\nDate: Mon, 03 Feb 2014 03:15:29 GMT\r\nServer: Apache/2.2.19 (Unix) mod_jk
/1.2.32\r\nSet-Cookie: JSESSIONID=9AC1026A39AA717B905E907D51B0BAE6.standby2; Path=/\r\nContent-Length: 2\r\nContent-Type: text/html;charset=UTF-8\r\n\r\nOK]"
[오후 3:03:45] 광효 남: 이런거말씀하시는거아님??
[오후 3:04:00] 정우 박: ㅇㅇ
[오후 3:04:04] 정우 박: 시간좀볼라고
[오후 3:04:56] 광효 남: "2014-02-03T13:30:37.158841
[오후 3:04:57] 광효 남: 이거실패
[오후 3:05:04] 광효 남: POST //GetIvrCheck.action HTTP/1.1\r\nHost: 211.38.95.168:80\r\nContent-Type: application/x-w
ww-form-urlencoded\r\nContent-Length: 108\r\n\r\ntype=01&work_type=02&forward_type=0&from_server=4&e164=07076663593&hashdata=4ca1fc3e9dc80500ae77fc115bdeef8c 이래던짐
[오후 3:05:20] 광효 남: 2014-02-03T13:30:40.158080":13698658:OS:ERR 이때실패
[오후 3:05:26] 광효 남: 보내자말자 실패찍었네요
[오후 3:05:29] 광효 남: 왜실팬지 보시면될듯
[오후 3:05:32] 정우 박: ㅇㅋ
[오후 3:07:02] 광효 남:  251574 "2014-02-03T13:56:51.142473":11148:OS:INFO:ivr.localdomain:pid-23737:02FFAB90:SKYALARM_CALL00:"Web Send Message call-id[Y9Wopqolfec72c], Msg[POST //GetIvrCheck.action HTTP/1.1\r\nHost: 211.38.95.168:80\r\nContent-Type: applicatio
        n/x-www-form-urlencoded\r\nContent-Length: 108\r\n\r\ntype=01&work_type=02&forward_type=0&from_server=4&e164=07076663595&hashdata=f0b3c0337a4a30c74ab85926abac8f24]"


//////////////////////////////////////////////////
"2014-02-03T13:56:54.142432":11355:OS:ERR:ivr.localdomain:pid-23737:02FFAB90:SKYALARM_CALL00:"Web Server Receive Fail call-id[Y9Wopqolfec72c] !!!"
[오후 3:07:08] 광효 남: 이건 3초 있다가 실패


"2014-02-03T13:56:51.142473":11148:OS:INFO:ivr.localdomain:pid-23737:02FFAB90:SKYALARM_CALL00:"Web Send Message call-id[Y9Wopqolfec72c], Msg[POST //GetIvrCheck.action HTTP/1.1\r\nHost: 211.38.95.168:80\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 108\r\n\r\ntype=01&work_type=02&forward_type=0&from_server=4&e164=07076663595&hashdata=f0b3c0337a4a30c74ab85926abac8f24]"
"2014-02-03T13:56:51.708672":11169:SIP:INFO:ivr.localdomain:pid-23737:06D99B90:SKYALARM_CALL00:"Announce Type... CallID[0B7VXaXzNec737], reason_header[404], reason_text[\"Not Found\"], extension_header[0]..."


리눅스 네트워크 안될시

cat /etc/sysconfig/network-scripts/ifcfg-eth0

확인

ifup eth0 랜카드0번 시작

08:00:27:ee:81:09
